diff --git a/CONTRIBUTORS b/CONTRIBUTORS
index e8cf42774..49cf4f0dd 100644
--- a/CONTRIBUTORS
+++ b/CONTRIBUTORS
@@ -1,358 +1,359 @@
 Amongst other, the following people contributed to ant:
 
 Adam Blinkinsop
 Adam Bryzak
 Adam Sotona
 Aleksandr Ishutin
 Alex Rosen
 Alexei Yudichev
 Alexey Panchenko
 Alexey Solofnenko
 Alison Winters
 Andreas Ames
 Andreas Mross
 Andrew Everitt
 Andrew Stevens
 Andrey Urazov
 Andy Wood
 Anil K. Vijendran
 Anli Shundi
 Anthony Goubard
 Anthony Green
 Antoine Baudoux
 Antoine Levy-Lambert
 Anton Mazkovoi
 Arnaud Vandyck
 Arnout J. Kuiper
 Aslak Hellesôy
 Atsuhiko Yamanaka
 Avik Sengupta
 Balazs Fejes 2
 Bart Vanhaute
 Benjamin Burgess
 Ben Galbraith
 Benoit Moussaud
 Bernd Dutkowski
 Brad Clark
 Brant Langer Gurganus
 Brian Curnow
 Brian Deitte
 Brian Felder
+Brian Repko
 Bruce Atherton
 Cedomir Igaly
 Charles Hudak
 Charlie Hubbard
 Chris Povirk
 Christian Knorr
 Christoph Wilhelms
 Christophe Labouisse
 Christopher A. Longo
 Christopher Charlier
 Clark Archer
 Clemens Hammacher
 Clement OUDOT
 Conor MacNeill
 Craeg Strong
 Craig Cottingham
 Craig R. McClanahan
 Craig Richardson
 Craig Ryan
 Craig Sandvik
 Curt Arnold
 Curtis White
 Cyrille Morvan
 D'Arcy Smith
 Dale Anson
 Dale Sherwood
 Dan Armbrust
 Daniel Henrique
 Daniel Ribagnac
 Daniel Spilker
 Danno Ferrin
 Dante Briones
 Davanum Srinivas
 Dave Brondsema
 Dave Brosius
 David A. Herman
 David Crossley
 David Gärtner
 David S. Johnson
 David Kavanagh
 David LeRoy
 David Leal
 David M. Lloyd
 David Maclean
 David Rees
 Denis Hennessy
 Derek Slager
 Diane Holt
 dIon Gillard
 Dominique Devienne
 Donal Quinlan
 Don Brown
 Don Ferguson
 Don Jeffery
 Drew Sudell
 Eduard Wirch
 Edwin Woudt
 Eli Tucker
 Emmanuel Bourg
 Eric Olsen
 Eric Pugh
 Erik Hatcher
 Erik Langenbach
 Erik Meade
 Ernst de Haan
 Frank Harnack
 Frank Somers
 Frank Zeyda
 Frederic Bothamy
 Frederic Lavigne
 Gary S. Weaver
 Gautam Guliani
 Gene-Sung Chung
 Georges-Etienne Legendre
 Gero Vermaas
 Gerrit Riessen
 Gilbert Rebhan
 Gilles Scokart
 Glenn McAllister
 Glenn Twiggs
 Greg Nelson
 Greg Roodt
 Greg Schueler
 Günther Kögel
 Harish Prabandham
 Haroon Rafique
 Hiroaki Nakamura
 Holger Engels
 Holger Joest
 Ignacio Coloma
 Ingenonsya France
 Ingmar Stein
 Irene Rusman
 Ivan Ivanov
 J Bleijenbergh
 Jack J. Woehr
 James Duncan Davidson
 Jan Cumps
 Jan Matèrne
 Jan Mynarik
 Jason Hunter
 Jason Pettiss
 Jason Salter
 Jason Yip
 Jay Dickon Glanville
 Jay Peck
 Jay van der Meer
 JC Mann
 J D Glanville
 Jean-Francois Brousseau
 Jeff Gettle
 Jeff Martin
 Jeff Tulley
 Jeff Turner
 Jene Jasper
 Jeremy Mawson
 Jerome Lacoste
 Jesse Glick
 Jesse Stockall
 Jim Allers
 Joerg Wassmer
 Joey Richey
 Johann Herunter
 John Sisson
 Jon Dickinson
 Jon S. Stevens
 Jon Skeet
 Jose Alberto Fernandez
 Joseph Walton
 Josh Lucas
 Juerg Wanner
 Julian Simpson
 Justin Vallon
 Keiron Liddle
 Keith Visco
 Kevin Greiner
 Kevin Jackson
 Kevin Ross
 Kevin Z Grey
 Kim Hansen
 Kirk Wylie
 Kyle Adams
 Larry Shatzer
 Larry Streepy
 Les Hughes
 Levi Cook
 lucas
 Ludovic Claude
 Maarten Coene
 Magesh Umasankar
 Maneesh Sahu
 Marcel Schutte
 Marcus B&ouml;rger
 Mario Frasca 
 Mariusz Nowostawski
 Mark Hecker
 Mark Salter
 Mark R. Diggory
 Mark A. Ziesemer
 Martijn Kruithof
 Martin Landers
 Martin Poeschl
 Martin van den Bemt
 Martin von Gagern
 Mathieu Champlon
 Mathieu Peltier
 Matt Albrecht
 Matt Benson
 Matt Bishop
 Matt Foemmel
 Matt Grosso
 Matt Humphrey
 Matt Small
 Matthew Hawthorne
 Matthew Inger
 Matthew Kuperus Heun
 Matthew Watson
 Michael Bayne
 Michael Davey
 Michael J. Sikorsky
 Michael McCallum
 Michael Montuori
 Michael Newcomb
 Micheal Nygard
 Michael Saunders
 Miha
 Mike Davis
 Mike Roberts
 mnowostawski
 Nathan Beyer
 Nick Chalko
 Nick Fortescue
 Nick Crossley
 Nick Pellow
 Nicola Ken Barozzi
 Nico Seessle
 Nigel Magnay
 Oliver Merkel
 Oliver Rossmueller
 Omer Shapira
 Oystein Gisnas
 Patrick C. Beard
 Patrick Chanezon
 Patrick G. Heck (Gus Heck)
 Patrick Martin
 Paul Austin
 Paul Christmann
 Paul Galbraith
 Paul King
 Paulo Gaspar
 Pavan Bayyapu
 Pavel Jisl
 Pawel Zuzelski
 Peter B. West
 Peter Donald
 Peter Doornbosch
 Peter Hulst
 Peter Janes
 Peter Reilly
 Phil Hanna
 Philip Hourihane
 Phillip Wells
 Pierre Delisle
 Pierre Dittgen
 R Handerson
 Rami Ojares
 Randy Watler
 Raphael Pierquin
 Ray Waldin
 Remie Bolte
 Richard Evans
 Rick Beton
 Robert Anderson
 Robert Clark
 Robert Flaherty
 Robert Shaw
 Robert Streich
 Robert Watkins
 Roberto Scaramuzzi
 Robin Green
 Robin Verduijn
 Rob Oxspring
 Rob van Oostrum
 Rodrigo Schmidt
 Roger Vaughn
 Roman Ivashin
 Ronen Mashal
 Russell Gold
 Sam Ruby
 Sandra Metz
 Scott Carlson
 Scott Ellsworth
 Scott Johnson
 Scott M. Stirling
 Sean Egan
 Sean P. Kane
 Sebastien Arod
 Shiraz Kanga
 Sebastian Kantha
 Simon Law
 Simone Bordet
 Stefan Bodewig
 Stefan Heimann
 Stefano Mazzocchi
 Stephan Strittmatter
 Stephane Bailliez
 stephan
 Stephan Michels
 Stephen Chin
 Stephen Goetze
 Steve Cohen
 Steve Langley
 Steve Loughran
 Steve Morin
 Steve Wadsworth
 Steven E. Newton
 Takashi Okamoto
 TAMURA Kent
 Taoufik Romdhane
 Tariq Master
 Thomas Aglassinger
 Thomas Butz
 Thomas Christen
 Thomas Christensen
 Thomas Haas
 Thomas Quas
 Tim Drury
 Tim Fennell
 Tim Stephenson
 Timothy Gerard Endres
 Tom Ball
 Tom Brus
 Tom Cunningham
 Tom Dimock
 Tom Eugelink
 Tom May
 Tomasz Bech
 Trejkaz Xaoza
 Ulrich Schmidt
 Valentino Miazzo
 Victor Toni
 Vincent Legoll
 Waldek Herka
 Will Wang
 William Ferguson
 William Webber
 Wolf Siberski
 Wolfgang Baer
 Wolfgang Frech
 Wolfgang Glas
 Wolfgang Werner
 Xavier Hanin
 Xavier Witdouck
 Yohann Roussel
 Yuji Yamano
 Yves Martin
 Zach Garner
 Zdenek Wagner
diff --git a/contributors.xml b/contributors.xml
index f16c3fdba..3ac7e9fd6 100644
--- a/contributors.xml
+++ b/contributors.xml
@@ -1,1180 +1,1184 @@
 <?xml version="1.0" encoding="utf-8"?>
 <!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at
 
        http://www.apache.org/licenses/LICENSE-2.0
 
    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
 -->
 <!DOCTYPE contributors
 [
 <!ELEMENT name (first?, middle?, last)>
 <!ELEMENT contributors (introduction, name+)>
 <!ELEMENT first (#PCDATA)>
 <!ELEMENT introduction (#PCDATA)>
 <!ELEMENT middle (#PCDATA)>
 <!ELEMENT last (#PCDATA)>
 ]
 >
 
 <contributors>
   <introduction>
   These are some of the many people who have helped Ant become so successful.
   </introduction>
   <name>
     <first>Adam</first>
     <last>Blinkinsop</last>
   </name>
   <name>
     <first>Adam</first>
     <last>Bryzak</last>
   </name>
   <name>
     <first>Adam</first>
     <last>Sotona</last>
   </name>
   <name>
     <first>Aleksandr</first>
     <last>Ishutin</last>
   </name>
   <name>
     <first>Alex</first>
     <last>Rosen</last>
   </name>
   <name>
     <first>Alexei</first>
     <last>Yudichev</last>
   </name>
   <name>
     <first>Alexey</first>
     <last>Panchenko</last>
   </name>
   <name>
     <first>Alexey</first>
     <last>Solofnenko</last>
   </name>
   <name>
     <first>Alison</first>
     <last>Winters</last>
   </name>
   <name>
     <first>Andreas</first>
     <last>Ames</last>
   </name>
   <name>
     <first>Andrew</first>
     <last>Everitt</last>
   </name>
   <name>
     <first>Andrew</first>
     <last>Stevens</last>
   </name>
   <name>
     <first>Andrey</first>
     <last>Urazov</last>
   </name>
   <name>
     <first>Andy</first>
     <last>Wood</last>
   </name>
   <name>
     <first>Anil</first>
     <middle>K.</middle>
     <last>Vijendran</last>
   </name>
   <name>
     <first>Anli</first>
     <last>Shundi</last>
   </name>
   <name>
     <first>Anthony</first>
     <last>Green</last>
   </name>
   <name>
     <first>Antoine</first>
     <last>Baudoux</last>
   </name>
   <name>
     <first>Antoine</first>
     <last>Levy-Lambert</last>
   </name>
   <name>
     <first>Anton</first>
     <last>Mazkovoi</last>
   </name>
   <name>
     <first>Arnaud</first>
     <last>Vandyck</last>
   </name>
   <name>
     <first>Arnout</first>
     <middle>J.</middle>
     <last>Kuiper</last>
   </name>
   <name>
     <first>Aslak</first>
     <last>Helles&#244;y</last>
   </name>
   <name>
     <first>Atsuhiko</first>
     <last>Yamanaka</last>
   </name>
   <name>
     <first>Avik</first>
     <last>Sengupta</last>
   </name>
   <name>
     <first>Balazs</first>
     <last>Fejes 2</last>
   </name>
   <name>
     <first>Bart</first>
     <last>Vanhaute</last>
   </name>
   <name>
     <first>Benjamin</first>
     <last>Burgess</last>
   </name>
   <name>
     <first>Ben</first>
     <last>Galbraith</last>
   </name>
   <name>
     <first>Benoit</first>
     <last>Moussaud</last>
   </name>
   <name>
     <first>Bernd</first>
     <last>Dutkowski</last>
   </name>
   <name>
     <first>Brad</first>
     <last>Clark</last>
   </name>
   <name>
     <first>Brant</first>
     <middle>Langer</middle>
     <last>Gurganus</last>
   </name>
   <name>
     <first>Brian</first>
     <last>Curnow</last>
   </name>
   <name>
     <first>Brian</first>
     <last>Deitte</last>
   </name>
   <name>
     <first>Brian</first>
     <last>Felder</last>
   </name>
   <name>
+    <first>Brian</first>
+    <last>Repko</last>
+  </name>
+  <name>
     <first>Bruce</first>
     <last>Atherton</last>
   </name>
   <name>
     <first>Charles</first>
     <last>Hudak</last>
   </name>
   <name>
     <first>Charlie</first>
     <last>Hubbard</last>
   </name>
   <name>
     <first>Chris</first>
     <last>Povirk</last>
   </name>
   <name>
     <first>Christian</first>
     <last>Knorr</last>
   </name>
   <name>
     <first>Christoph</first>
     <last>Wilhelms</last>
   </name>
   <name>
     <first>Christophe</first>
     <last>Labouisse</last>
   </name>
   <name>
     <first>Christopher</first>
     <middle>A.</middle>
     <last>Longo</last>
   </name>
   <name>
     <first>Christopher</first>
     <last>Charlier</last>
   </name>
   <name>
     <first>Clark</first>
     <last>Archer</last>
   </name>
   <name>
     <first>Clemens</first>
     <last>Hammacher</last>
   </name>
   <name>
     <first>Clement</first>
     <last>OUDOT</last>
   </name>
   <name>
     <first>Conor</first>
     <last>MacNeill</last>
   </name>
   <name>
     <first>Craeg</first>
     <last>Strong</last>
   </name>
   <name>
     <first>Craig</first>
     <last>Cottingham</last>
   </name>
   <name>
     <first>Craig</first>
     <middle>R.</middle>
     <last>McClanahan</last>
   </name>
   <name>
     <first>Craig</first>
     <last>Ryan</last>
   </name>
   <name>
     <first>Craig</first>
     <last>Richardson</last>
   </name>
   <name>
     <first>Craig</first>
     <last>Sandvik</last>
   </name>
   <name>
     <first>Curt</first>
     <last>Arnold</last>
   </name>
   <name>
     <first>Curtis</first>
     <last>White</last>
   </name>
   <name>
     <first>Cyrille</first>
     <last>Morvan</last>
   </name>
   <name>
     <first>D'Arcy</first>
     <last>Smith</last>
   </name>
   <name>
     <first>Dale</first>
     <last>Anson</last>
   </name>
   <name>
     <first>Dale</first>
     <last>Sherwood</last>
   </name>
   <name>
     <first>Dan</first>
     <last>Armbrust</last>
   </name>
   <name>
     <first>Daniel</first>
     <last>Henrique</last>
   </name>
   <name>
     <first>Daniel</first>
     <last>Ribagnac</last>
   </name>
   <name>
     <first>Daniel</first>
     <last>Spilker</last>
   </name>
   <name>
     <first>Danno</first>
     <last>Ferrin</last>
   </name>
   <name>
     <first>Dante</first>
     <last>Briones</last>
   </name>
   <name>
     <first>Davanum</first>
     <last>Srinivas</last>
   </name>
   <name>
     <first>Dave</first>
     <last>Brondsema</last>
   </name>
   <name>
     <first>Dave</first>
     <last>Brosius</last>
   </name>
   <name>
     <first>David</first>
     <last>A.</last>
   </name>
   <name>
     <first>David</first>
     <last>Crossley</last>
   </name>
   <name>
     <first>David</first>
     <last>G&#228;rtner</last>
   </name>
   <name>
     <first>David</first>
     <middle>S.</middle>
     <last>Johnson</last>
   </name>
   <name>
     <first>David</first>
     <last>Kavanagh</last>
   </name>
   <name>
     <first>David</first>
     <last>LeRoy</last>
   </name>
   <name>
     <first>David</first>
     <last>Leal</last>
   </name>
   <name>
     <first>David</first>
     <middle>M.</middle>
     <last>Lloyd</last>
   </name>
   <name>
     <first>David</first>
     <last>Maclean</last>
   </name>
   <name>
     <first>David</first>
     <last>Rees</last>
   </name>
   <name>
     <first>Denis</first>
     <last>Hennessy</last>
   </name>
   <name>
     <first>Derek</first>
     <last>Slager</last>
   </name>
   <name>
     <first>Diane</first>
     <last>Holt</last>
   </name>
   <name>
     <first>dIon</first>
     <last>Gillard</last>
   </name>
   <name>
     <first>Dominique</first>
     <last>Devienne</last>
   </name>
   <name>
     <first>Donal</first>
     <last>Quinlan</last>
   </name>
   <name>
     <first>Don</first>
     <last>Bnamen</last>
   </name>
   <name>
     <first>Don</first>
     <last>Ferguson</last>
   </name>
   <name>
     <first>Don</first>
     <last>Jeffery</last>
   </name>
   <name>
     <first>Drew</first>
     <last>Sudell</last>
   </name>
   <name>
     <first>Eduard</first>
     <last>Wirch</last>
   </name>
   <name>
     <first>Edwin</first>
     <last>Woudt</last>
   </name>
   <name>
     <first>Eli</first>
     <last>Tucker</last>
   </name>
   <name>
     <first>Emmanuel</first>
     <last>Bourg</last>
   </name>
   <name>
     <first>Eric</first>
     <last>Olsen</last>
   </name>
   <name>
     <first>Eric</first>
     <last>Pugh</last>
   </name>
   <name>
     <first>Erik</first>
     <last>Hatcher</last>
   </name>
   <name>
     <first>Erik</first>
     <last>Langenbach</last>
   </name>
   <name>
     <first>Erik</first>
     <last>Meade</last>
   </name>
   <name>
     <first>Ernst</first>
     <last>de Haan</last>
   </name>
   <name>
     <first>Frank</first>
     <last>Harnack</last>
   </name>
   <name>
     <first>Frank</first>
     <last>Somers</last>
   </name>
   <name>
     <first>Frank</first>
     <last>Zeyda</last>
   </name>
   <name>
     <first>Frédéric</first>
     <last>Bothamy</last>
   </name>
   <name>
     <first>Frederic</first>
     <last>Lavigne</last>
   </name>
   <name>
     <first>Gary</first>
     <middle>S.</middle>
     <last>Weaver</last>
   </name>
   <name>
     <first>Gautam</first>
     <last>Guliani</last>
   </name>
   <name>
     <first>Gene-Sung</first>
     <last>Chung</last>
   </name>
   <name>
     <first>Georges-Etienne</first>
     <last>Legendre</last>
   </name>
   <name>
     <first>Gero</first>
     <last>Vermaas</last>
   </name>
   <name>
     <first>Gerrit</first>
     <last>Riessen</last>
   </name>
   <name>
     <first>Gilbert</first>
     <last>Rebhan</last>
   </name>
   <name>
     <first>Gilles</first>
     <last>Scokart</last>
   </name>
   <name>
     <first>Glenn</first>
     <last>McAllister</last>
   </name>
   <name>
     <first>Glenn</first>
     <last>Twiggs</last>
   </name>
   <name>
     <first>Greg</first>
     <last>Nelson</last>
   </name>
   <name>
     <first>Greg</first>
     <last>Roodt</last>
   </name>
   <name>
     <first>Greg</first>
     <last>Schueler</last>
   </name>
   <name>
     <first>Günther</first>
     <last>Kögel</last>
   </name>
   <name>
     <first>Harish</first>
     <last>Prabandham</last>
   </name>
   <name>
     <first>Haroon</first>
     <last>Rafique</last>
   </name>
   <name>
     <first>Hiroaki</first>
     <last>Nakamura</last>
   </name>
   <name>
     <first>Holger</first>
     <last>Engels</last>
   </name>
   <name>
     <first>Holger</first>
     <last>Joest</last>
   </name>
   <name>
     <first>Ignacio</first>
     <last>Coloma</last>
   </name>
   <name>
     <first>Ingenonsya</first>
     <last>France</last>
   </name>
   <name>
     <first>Ingmar</first>
     <last>Stein</last>
   </name>
   <name>
     <first>Irene</first>
     <last>Rusman</last>
   </name>
   <name>
     <first>Ivan</first>
     <last>Ivanov</last>
   </name>
   <name>
     <first>J</first>
     <last>Bleijenbergh</last>
   </name>
   <name>
     <first>Jack</first>
     <middle>J.</middle>
     <last>Woehr</last>
   </name>
   <name>
     <first>James</first>
     <middle>Duncan</middle>
     <last>Davidson</last>
   </name>
   <name>
     <first>Jan</first>
     <last>Mat&#232;rne</last>
   </name>
     <name>
       <first>Jan</first>
       <last>Cumps</last>
     </name>
   <name>
     <first>Jan</first>
     <last>Mynarik</last>
   </name>
   <name>
     <first>Jason</first>
     <last>Hunter</last>
   </name>
   <name>
     <first>Jason</first>
     <last>Pettiss</last>
   </name>
   <name>
     <first>Jason</first>
     <last>Salter</last>
   </name>
   <name>
     <first>Jason</first>
     <last>Yip</last>
   </name>
   <name>
     <first>Jay</first>
     <middle>Dickon</middle>
     <last>Glanville</last>
   </name>
   <name>
     <first>Jay</first>
     <last>Peck</last>
   </name>
   <name>
     <first>Jay</first>
     <last>van der Meer</last>
   </name>
   <name>
     <first>JC</first>
     <last>Mann</last>
   </name>
   <name>
     <first>J</first>
     <last>D</last>
   </name>
   <name>
     <first>Jean-Francois</first>
     <last>Brousseau</last>
   </name>
   <name>
     <first>Jeff</first>
     <last>Gettle</last>
   </name>
   <name>
     <first>Jeff</first>
     <last>Martin</last>
   </name>
   <name>
     <first>Jeff</first>
     <last>Tulley</last>
   </name>
   <name>
     <first>Jeff</first>
     <last>Turner</last>
   </name>
   <name>
     <first>Jene</first>
     <last>Jasper</last>
   </name>
   <name>
     <first>Jeremy</first>
     <last>Mawson</last>
   </name>
   <name>
     <first>Jerome</first>
     <last>Lacoste</last>
   </name>
   <name>
     <first>Jesse</first>
     <last>Glick</last>
   </name>
   <name>
     <first>Jesse</first>
     <last>Stockall</last>
   </name>
   <name>
     <first>Jim</first>
     <last>Allers</last>
   </name>
   <name>
     <first>Joerg</first>
     <last>Wassmer</last>
   </name>
   <name>
     <first>Joey</first>
     <last>Richey</last>
   </name>
   <name>
     <first>Johann</first>
     <last>Herunter</last>
   </name>
   <name>
     <first>John</first>
     <last>Sisson</last>
   </name>
   <name>
     <first>Jon</first>
     <last>Dickinson</last>
   </name>
   <name>
     <first>Jon</first>
     <last>Skeet</last>
   </name>
   <name>
     <first>Jon</first>
     <middle>S.</middle>
     <last>Stevens</last>
   </name>
   <name>
     <first>Jose</first>
     <middle>Alberto</middle>
     <last>Fernandez</last>
   </name>
   <name>
     <first>Josh</first>
     <last>Lucas</last>
   </name>
   <name>
     <first>Joseph</first>
     <last>Walton</last>
   </name>
   <name>
     <first>Juerg</first>
     <last>Wanner</last>
   </name>
   <name>
     <first>Julian</first>
     <last>Simpson</last>
   </name>
   <name>
     <first>Justin</first>
     <last>Vallon</last>
   </name>
   <name>
     <first>Keiron</first>
     <last>Liddle</last>
   </name>
   <name>
     <first>Keith</first>
     <last>Visco</last>
   </name>
   <name>
     <first>Kevin</first>
     <last>Greiner</last>
   </name>
   <name>
     <first>Kevin</first>
     <last>Jackson</last>
   </name>
   <name>
     <first>Kevin</first>
     <last>Ross</last>
   </name>
   <name>
     <first>Kevin</first>
     <middle>Z</middle>
     <last>Grey</last>
   </name>
   <name>
     <first>Kim</first>
     <last>Hansen</last>
   </name>
   <name>
     <first>Kirk</first>
     <last>Wylie</last>
   </name>
   <name>
     <first>Kyle</first>
     <last>Adams</last>
   </name>
   <name>
     <first>Larry</first>
     <last>Shatzer</last>
   </name>
   <name>
     <first>Larry</first>
     <last>Streepy</last>
   </name>
   <name>
     <first>Les</first>
     <last>Hughes</last>
   </name>
   <name>
     <first>Levi</first>
     <last>Cook</last>
   </name>
   <name>
     <last>lucas</last>
   </name>
   <name>
     <first>Ludovic</first>
     <last>Claude</last>
   </name>
   <name>
     <first>Magesh</first>
     <last>Umasankar</last>
   </name>
   <name>
     <first>Maneesh</first>
     <last>Sahu</last>
   </name>
   <name>
     <first>Marcel</first>
     <last>Schutte</last>
   </name>
   <name>
     <first>Marcus</first>
     <last>Börger</last>
   </name>
   <name>
     <first>Mario</first>
     <last>Frasca</last>
   </name>
   <name>
     <first>Mariusz</first>
     <last>Nowostawski</last>
   </name>
   <name>
     <first>Mark</first>
     <last>Hecker</last>
   </name>
   <name>
     <first>Mark</first>
     <last>Salter</last>
   </name>
   <name>
     <first>Mark</first>
     <middle>R.</middle>
     <last>Diggory</last>
   </name>
   <name>
     <first>Mark</first>
     <middle>A.</middle>
     <last>Ziesemer</last>
   </name>
   <name>
     <first>Martijn</first>
     <last>Kruithof</last>
   </name>
   <name>
     <first>Martin</first>
     <last>Landers</last>
   </name>
   <name>
     <first>Martin</first>
     <last>Poeschl</last>
   </name>
   <name>
     <first>Martin</first>
     <last>van den Bemt</last>
   </name>
   <name>
     <first>Martin</first>
     <last>von Gagern</last>
   </name>
   <name>
     <first>Mathieu</first>
     <last>Champlon</last>
   </name>
   <name>
     <first>Mathieu</first>
     <last>Peltier</last>
   </name>
   <name>
     <first>Matt</first>
     <last>Albrecht</last>
   </name>
   <name>
     <first>Matt</first>
     <last>Benson</last>
   </name>
   <name>
     <first>Matt</first>
     <last>Bishop</last>
   </name>
   <name>
     <first>Matt</first>
     <last>Foemmel</last>
   </name>
   <name>
     <first>Matt</first>
     <last>Grosso</last>
   </name>
   <name>
     <first>Matt</first>
     <last>Humphrey</last>
   </name>
   <name>
     <first>Matt</first>
     <last>Small</last>
   </name>
   <name>
     <first>Matthew</first>
     <last>Hawthorne</last>
   </name>
   <name>
     <first>Matthew</first>
     <last>Inger</last>
   </name>
   <name>
     <first>Matthew</first>
     <middle>Kuperus</middle>
     <last>Heun</last>
   </name>
   <name>
     <first>Matthew</first>
     <last>Watson</last>
   </name>
   <name>
     <first>Michael</first>
     <last>Bayne</last>
   </name>
   <name>
     <first>Michael</first>
     <last>Davey</last>
   </name>
   <name>
     <first>Michael</first>
     <middle>J.</middle>
     <last>Sikorsky</last>
   </name>
   <name>
     <first>Michael</first>
     <last>McCallum</last>
   </name>
   <name>
     <first>Michael</first>
     <last>Newcomb</last>
   </name>
   <name>
     <first>Michael</first>
     <last>Nygard</last>
   </name>
   <name>
     <first>Michael</first>
     <last>Saunders</last>
   </name>
   <name>
     <last>Miha</last>
   </name>
   <name>
     <first>Mike</first>
     <last>Davis</last>
   </name>
   <name>
     <first>Mike</first>
     <last>Roberts</last>
   </name>
   <name>
     <last>mnowostawski</last>
   </name>
   <name>
     <first>Nathan</first>
     <last>Beyer</last>
   </name>
   <name>
     <first>Nick</first>
     <last>Chalko</last>
   </name>
   <name>
     <first>Nick</first>
     <last>Crossley</last>
   </name>
   <name>
     <first>Nick</first>
     <last>Fortescue</last>
   </name>
   <name>
     <first>Nick</first>
     <last>Pellow</last>
   </name>
   <name>
     <first>Nicola</first>
     <last>Ken</last>
   </name>
   <name>
     <first>Nico</first>
     <last>Seessle</last>
   </name>
   <name>
     <first>Nigel</first>
     <last>Magnay</last>
   </name>
   <name>
     <first>Oliver</first>
     <last>Merkel</last>
   </name>
   <name>
     <first>Oliver</first>
     <last>Rossmueller</last>
   </name>
   <name>
     <first>Omer</first>
     <last>Shapira</last>
   </name>
   <name>
     <first>&#216;ystein</first>
     <last>Gisn&#229;s</last>
   </name>
   <name>
     <first>Patrick</first>
     <last>C.</last>
   </name>
   <name>
     <first>Patrick</first>
     <last>Chanezon</last>
   </name>
   <name>
     <first>Patrick</first>
     <last>Gus</last>
   </name>
   <name>
     <first>Paul</first>
     <last>Austin</last>
   </name>
   <name>
     <first>Paul</first>
     <last>Christmann</last>
   </name>
   <name>
     <first>Paul</first>
     <last>Galbraith</last>
   </name>
   <name>
     <first>Paul</first>
     <last>King</last>
   </name>
   <name>
     <first>Paulo</first>
     <last>Gaspar</last>
   </name>
   <name>
     <first>Pavan</first>
     <last>Bayyapu</last>
   </name>
   <name>
     <first>Pavel</first>
     <last>Jisl</last>
   </name>
   <name>
     <first>Paweł</first>
     <last>Zuzelski</last>
   </name>
   <name>
     <first>Peter</first>
     <middle>B.</middle>
     <last>West</last>
   </name>
   <name>
     <first>Peter</first>
     <last>Donald</last>
   </name>
   <name>
     <first>Peter</first>
     <last>Doornbosch</last>
   </name>
   <name>
     <first>Peter</first>
     <last>Hulst</last>
   </name>
   <name>
     <first>Peter</first>
     <last>Janes</last>
   </name>
   <name>
     <first>Peter</first>
     <last>Reilly</last>
   </name>
   <name>
     <first>Phil</first>
     <last>Hanna</last>
   </name>
   <name>
     <first>Philip</first>
     <last>Hourihane</last>
   </name>
   <name>
     <first>Phillip</first>
     <last>Wells</last>
   </name>
   <name>
     <first>Pierre</first>
     <last>Delisle</last>
   </name>
   <name>
     <first>Pierre</first>
     <last>Dittgen</last>
   </name>
   <name>
     <first>R</first>
     <last>Handerson</last>
   </name>
   <name>
     <first>Rami</first>
     <last>Ojares</last>
   </name>
   <name>
     <first>Randy</first>
     <last>Watler</last>
   </name>
   <name>
     <first>Raphael</first>
     <last>Pierquin</last>
   </name>
   <name>
     <first>Ray</first>
     <last>Waldin</last>
   </name>
   <name>
     <first>Remie</first>
     <last>Bolte</last>
   </name>
   <name>
     <first>Richard</first>
     <last>Evans</last>
   </name>
   <name>
     <first>Rick</first>
     <last>Beton</last>
   </name>
   <name>
     <first>Robert</first>
     <last>Anderson</last>
   </name>
   <name>
     <first>Robert</first>
     <last>Clark</last>
   </name>
   <name>
     <first>Robert</first>
     <last>Flaherty</last>
   </name>
   <name>
     <first>Robert</first>
     <last>Shaw</last>
   </name>
   <name>
     <first>Robert</first>
     <last>Streich</last>
   </name>
   <name>
     <first>Robert</first>
     <last>Watkins</last>
   </name>
   <name>
     <first>Roberto</first>
     <last>Scaramuzzi</last>
   </name>
   <name>
     <first>Robin</first>
     <last>Green</last>
   </name>
   <name>
     <first>Robin</first>
     <last>Verduijn</last>
   </name>
   <name>
     <first>Rob</first>
     <last>Oxspring</last>
   </name>
   <name>
     <first>Rob</first>
     <last>van Oostrum</last>
   </name>
   <name>
     <first>Rodrigo</first>
     <last>Schmidt</last>
   </name>
   <name>
     <first>Roger</first>
     <last>Vaughn</last>
   </name>
   <name>
     <first>Roman</first>
     <last>Ivashin</last>
   </name>
   <name>
     <first>Ronen</first>
     <last>Mashal</last>
   </name>
   <name>
     <first>Russell</first>
     <last>Gold</last>
   </name>
   <name>
     <first>Sam</first>
     <last>Ruby</last>
   </name>
   <name>
     <first>Sandra</first>
     <last>Metz</last>
   </name>
   <name>
     <first>Scott</first>
     <last>Carlson</last>
   </name>
diff --git a/docs/faq.html b/docs/faq.html
index 4e18fcd65..b242ff29c 100644
--- a/docs/faq.html
+++ b/docs/faq.html
@@ -1,2212 +1,2260 @@
 
 
 <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
 <!--
    Licensed to the Apache Software Foundation (ASF) under one or more
    contributor license agreements.  See the NOTICE file distributed with
    this work for additional information regarding copyright ownership.
    The ASF licenses this file to You under the Apache License, Version 2.0
    (the "License"); you may not use this file except in compliance with
    the License.  You may obtain a copy of the License at
 
        http://www.apache.org/licenses/LICENSE-2.0
 
    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
 -->
         <html lang="en">
     <!-- GENERATED FILE, DO NOT EDIT, EDIT THE XML FILE IN xdocs INSTEAD! -->
     <head>
       <META http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
         <title>Apache Ant - Frequently Asked Questions</title>
         <link type="text/css" href="./page.css" rel="stylesheet">
           <meta name="author" content="Stefan Bodewig">
   <meta name="email" content="bodewig@apache.org">
       </head>
 
     <body>
       <p class="navpath">
         <script src="./breadcrumbs.js" language="JavaScript" type="text/javascript"></script>
       </p>
 
       <div class="logobar">
         <table width="100%" border="0" cellspacing="0" cellpadding="0">
           <tr>
             <td align="left"><img border="0" alt="Apache Ant site" src="./images/group-logo.gif"></td>
             <td align="center" width="100%"><img alt="Apache Ant logo" border="0" src="./images/project-logo.gif"></td>
             <td align="right">
               <form target="_blank" onsubmit="q.value = query.value + ' site:ant.apache.org'" action="http://www.google.com/search" method="get">
                 <table summary="search" border="0" cellspacing="0" cellpadding="0" bgcolor="#4C6C8F">
                   <tr>
                     <td colspan="3"><img height="10" width="1" alt="" src="./images/spacer.gif"></td>
                   </tr>
                   <tr>
                     <td><img height="1" width="1" alt="" src="./images/spacer.gif"></td>
                     <td nowrap="nowrap" class="searchcaption">
                       <input name="q" type="hidden">
                       <input size="15" id="query" type="text">
                       <img height="1" width="5" alt="" src="./images/spacer.gif">
                       <input name="Search" value="Search" type="submit">
                       <br>
                       the Apache Ant site
                     </td>
                     <td><img height="1" width="1" alt="" src="./images/spacer.gif"></td>
                   </tr>
                   <tr>
                     <td><img alt="" border="0" height="10" width="9" src="./images/search-left.gif"></td>
                     <td><img height="1" width="1" alt="" src="./images/spacer.gif"></td>
                     <td><img alt="" border="0" height="10" width="9" src="./images/search-right.gif"></td>
                   </tr>
                 </table>
               </form>
             </td>
           </tr>
         </table>
       </div>
 
                   <div class="tab">
               <table summary="tab bar" border="0" cellpadding="0" cellspacing="0">
                 <tr>
                                   <td width="8"><img alt="" height="5" width="8" src="./images/spacer.gif"></td><td valign="bottom">
                       <table summary="selected tab" style="height: 1.5em" border="0" cellpadding="0" cellspacing="0">
                         <tr>
                         <td valign="top" width="5" bgcolor="#4C6C8F"><img height="5" width="5" alt="" src="./images/tabSel-left.gif"></td><td valign="middle" bgcolor="#4C6C8F"><font color="#ffffff" size="2" face="Arial, Helvetica, Sans-serif"><b>Home</b></font></td><td valign="top" width="5" bgcolor="#4C6C8F"><img height="5" width="5" alt="" src="./images/tabSel-right.gif"></td>
                         </tr>
                       </table>
                     </td>
                                     <td width="5"><img alt="" height="8" width="8" src="./images/spacer.gif"></td><td valign="bottom">
                       <table summary="non selected tab" style="height: 1.4em" border="0" cellpadding="0" cellspacing="0">
                         <tr>
                           <td valign="top" width="5" bgcolor="#B2C4E0"><img height="5" width="5" alt="" src="./images/tab-left.gif"></td><td valign="middle" bgcolor="#B2C4E0"><a href="./projects/index.html"><font size="2" face="Arial, Helvetica, Sans-serif">Projects</font></a></td><td valign="top" width="5" bgcolor="#B2C4E0"><img height="5" width="5" alt="" src="./images/tab-right.gif"></td>
                         </tr>
                       </table>
                     </td>
                             </tr>
               </table>
             </div>
 
       <div class="bluebar"></div>
                     
   <div class="menucontainer">
     <div class="menu">
       <ul>
               <li class="menuheader">Apache Ant
           <ul>
                             <li>
                                     <a href="./index.html">Welcome</a>
                                 </li>
                             <li>
                                     <a href="./license.html">License</a>
                                 </li>
                             <li>
                                     <a href="./antnews.html">News</a>
                                 </li>
                       </ul>
         </li>
               <li class="menuheader">Documentation
           <ul>
                             <li>
                                     <a href="./manual/index.html">Manual</a>
                                 </li>
                             <li>
                                     <a href="./projects.html">Related Projects</a>
                                 </li>
                             <li>
                                     <a href="./external.html">External Tools and Tasks</a>
                                 </li>
                             <li>
                                     <a href="./resources.html">Resources</a>
                                 </li>
                             <li>
                               <span class="sel">Frequently Asked Questions</span>
                               </li>
                             <li>
                                     <a href="http://wiki.apache.org/ant/FrontPage">Wiki</a>
                                 </li>
                             <li>
                                     <a href="./problems.html">Having Problems?</a>
                                 </li>
                       </ul>
         </li>
               <li class="menuheader">Download
           <ul>
                             <li>
                                     <a href="http://ant.apache.org/bindownload.cgi">Binary Distributions</a>
                                 </li>
                             <li>
                                     <a href="http://ant.apache.org/srcdownload.cgi">Source Distributions</a>
                                 </li>
                       </ul>
         </li>
               <li class="menuheader">Contributing
           <ul>
                             <li>
                                     <a href="./mail.html">Mailing Lists</a>
                                 </li>
                             <li>
                                     <a href="./svn.html">Subversion Repositories</a>
                                 </li>
                             <li>
                                     <a href="./nightlies.html">Nightly+Continuous Builds</a>
                                 </li>
                             <li>
                                     <a href="./bugs.html">Bug Database</a>
                                 </li>
                       </ul>
         </li>
               <li class="menuheader">Sponsorship
           <ul>
                             <li>
                                     <a href="http://www.apache.org/foundation/thanks.html">Thanks</a>
                                 </li>
                             <li>
                                     <a href="http://www.apache.org/foundation/sponsorship.html">Sponsorship</a>
                                 </li>
                             <li>
                                     <a href="http://www.apache.org/foundation/contributing.html">Donations</a>
                                 </li>
                       </ul>
         </li>
               <li class="menuheader">Project Management
           <ul>
                             <li>
                                     <a href="./contributors.html">Contributors</a>
                                 </li>
                             <li>
                                     <a href="./mission.html">Apache Ant Mission</a>
                                 </li>
                             <li>
                                     <a href="./bylaws.html">Project Bylaws</a>
                                 </li>
                             <li>
                                     <a href="./legal.html">Legal</a>
                                 </li>
                       </ul>
         </li>
             </ul>
     </div>
     <center>
     <a href="http://www.apache.org/events/current-event.html"><img border="0" title="ApacheCon" alt="ApacheCon - logo" src="http://www.apache.org/events/current-event-125x125.png" style="width: 125px;height: 125px;"></a>
     </center>
     <img style="float: left" height="10" width="10" border="0" alt="" src="./images/menu-left.gif">
     <img style="float: right" height="10" width="10" border="0" alt="" src="./images/menu-right.gif">
   </div>
       <div class="lightbluebar">&nbsp;</div>
   <div class="main">
   <div class="content">
     <h1 class="title">Frequently Asked Questions</h1>
     
         <h3 class="section">Questions</h3>
                 <h4 class="toc">About this FAQ</h4>
         <ul>
                 <li><a href="#latest-version">
   Where do I find the latest version of this
         document?
       </a></li>
                 <li><a href="#adding-faqs">
   How can I contribute to this FAQ?
       </a></li>
                 <li><a href="#creating-faq">
   How do you create the HTML version of this
         FAQ?
       </a></li>
             </ul>
                 <h4 class="toc">General</h4>
         <ul>
                 <li><a href="#what-is-ant">
   What is Apache Ant?
       </a></li>
                 <li><a href="#ant-name">
   Why do you call it Ant?
       </a></li>
                 <li><a href="#history">
   Tell us a little bit about Ant's history.
       </a></li>
             </ul>
                 <h4 class="toc">Installation</h4>
         <ul>
                 <li><a href="#java-version">
   Which version of Java is required to run
         Ant?
       </a></li>
                 <li><a href="#no-gnu-tar">
   I get checksum errors when I try to extract the
       <code>tar.gz</code> distribution file. Why?
       </a></li>
                 <li><a href="#RedHat_ES_3">
   How do you get ant-1.6.x (or any version later than
       1.5.2) to work on on RedHat ES 3?
       </a></li>
             </ul>
                 <h4 class="toc">How do I ...</h4>
         <ul>
                 <li><a href="#precompile-jsps">
   How to I precompile Java Server Pages (JSPs)?
       </a></li>
                 <li><a href="#implement-os-specific-configuration">
   How do I realize os--specific configurations?
       </a></li>
                 <li><a href="#adding-external-tasks">
   How do I add an external task that I've written to the
       page "External Tools and Tasks"?
       </a></li>
                 <li><a href="#create-extensions">
   How do I create new tasks?
       </a></li>
                 <li><a href="#passing-cli-args">
   How do I pass parameters from the command line to my
         build file?
       </a></li>
                 <li><a href="#jikes-switches">
   How can I use Jikes-specific command-line
         switches?
       </a></li>
                 <li><a href="#shell-redirect-1">
   How do I include a &lt; character in my command-line arguments?
       </a></li>
                 <li><a href="#shell-redirect-2">
   How do I redirect standard input or standard output
         in the <code>&lt;exec&gt;</code> task?
       </a></li>
                 <li><a href="#batch-shell-execute">
   How do I execute a batch file or shell script from Ant?
       </a></li>
                 <li><a href="#multi-conditions">
   I want to execute a particular target only if
         multiple conditions are true.
       </a></li>
                 <li><a href="#encoding">
   How can I include national characters like German
         umlauts in my build file?
       </a></li>
                 <li><a href="#use-zip-instead-of-jar">
   How do I use <code>jar</code>'s <code>M</code> switch?
       I don't want a MANIFEST.
       </a></li>
                 <li><a href="#propertyvalue-as-name-for-property">
   How can I do something like <code>&lt;property name="prop"
       value="${${anotherprop}}"/&gt;</code> (double expanding the property)?
       </a></li>
                 <li><a href="#delete-directory-children-only">
   How can I delete everything beneath a particular directory,
     preserving the directory itself?
       </a></li>
                 <li><a href="#delete-directory-only-if-empty">
   How can I delete a particular directory,
         if and only if it is empty?
       </a></li>
             </ul>
                 <h4 class="toc">It doesn't work (as expected)</h4>
         <ul>
                 <li><a href="#general-advice">
   General Advice
       </a></li>
                 <li><a href="#always-recompiles">
   Why does Ant always recompile all my Java files?
       </a></li>
                 <li><a href="#defaultexcludes">
   I've used a <code>&lt;delete&gt;</code> task to
       delete unwanted SourceSafe control files (CVS files, editor
       backup files, etc.), but it doesn't seem to work; the files
       never get deleted. What's wrong?
       </a></li>
                 <li><a href="#stop-dependency">
   I have a target I want to skip if a property is set,
       so I have <code>unless="property"</code> as an attribute
       of the target, but all the targets this target
       depends on are still executed. Why?
       </a></li>
                 <li><a href="#include-order">
   In my <code>&lt;fileset&gt;</code>, I've put in an
       <code>&lt;exclude&gt;</code> of all files followed by an
       <code>&lt;include&gt;</code> of just the files I want, but it
       isn't giving me any files at all. What's wrong?
       
       </a></li>
                 <li><a href="#properties-not-trimmed">
   <code>ant</code> failed to build my program via javac
       even when I put the needed jars in an external
       <code>build.properties</code> file and reference them by
       <code>pathelement</code> or <code>classpath refid</code>.
       </a></li>
                 <li><a href="#winzip-lies">
   Ant creates WAR files with a lower-case
         <code>web-inf</code> or JAR files with a lower-case
         <code>meta-inf</code> directory.
       </a></li>
                 <li><a href="#NoClassDefFoundError">
   I installed Ant 1.6.x and now get
         <code>Exception in thread "main" java.lang.NoClassDefFoundError:
         </code>
       
       </a></li>
                 <li><a href="#InstantiationException">
   I installed Ant 1.6.x and now get
         <code>java.lang.InstantiationException: org.apache.tools.ant.Main</code>
       
       </a></li>
                 <li><a href="#mangled-manifest">
   
         Whenever I use the Ant jar or manifest related tasks, long lines in
         my manifest are wrapped at 70 characters and the resulting jar does
         not work in my application server. Why does Ant do this?
       
       </a></li>
                 <li><a href="#CreateProcess_error_2">
   <code>&lt;exec&gt;</code> fails with <code>"Cannot run
           program "...":CreateProcess error=2"</code> on
         Windows.
       </a></li>
             </ul>
                 <h4 class="toc">Ant and IDEs/Editors</h4>
         <ul>
                 <li><a href="#integration">
   Is Ant supported by my IDE/Editor?
       </a></li>
                 <li><a href="#emacs-mode">
   Why doesn't (X)Emacs/vi/MacOS X's project builder
       correctly parse the error messages generated by Ant?
       </a></li>
             </ul>
                 <h4 class="toc">Advanced Issues</h4>
         <ul>
                 <li><a href="#dtd">
   Is there a DTD that I can use to validate my build
       files?
       </a></li>
                 <li><a href="#xml-entity-include">
   How do I include an XML snippet in my build file?
       </a></li>
                 <li><a href="#mail-logger">
   How do I send an email with the result of my build
         process?
       </a></li>
                 <li><a href="#listener-properties">
   How do I get at the properties that Ant was running
       with from inside BuildListener?
       </a></li>
             </ul>
                 <h4 class="toc">Known Problems</h4>
         <ul>
                 <li><a href="#input-makes-exec-hang">
   <code>&lt;exec&gt;</code> causes other tasks to hang
         or leads to strange behaviour of <code>&lt;input&gt;</code>
         tasks.
       </a></li>
                 <li><a href="#javac-stackoverflow">
   <code>&lt;javac&gt;</code> causes a
         StackOverflowError
       </a></li>
                 <li><a href="#170-requires-junit">
   Ant 1.7.0 doesn't build from sources without
         JUnit
       </a></li>
                 <li><a href="#remove-cr">
   &lt;chmod&gt; or &lt;exec&gt; doesn't work in Ant
         1.3 on Unix
       </a></li>
                 <li><a href="#delegating-classloader">
   &lt;style&gt; or &lt;junit&gt; ignores my
       &lt;classpath&gt;
       </a></li>
                 <li><a href="#delegating-classloader-1.5">
   &lt;style&gt; or &lt;junit&gt; ignores my
       &lt;classpath&gt; - Ant 1.5.x version
       </a></li>
                 <li><a href="#delegating-classloader-1.6">
   &lt;style&gt; or &lt;junit&gt; ignores my
       &lt;classpath&gt; - Ant 1.6.x version
       </a></li>
                 <li><a href="#unknownelement.taskcontainer">
   
         Why do my custom task containers see Unknown Elements in Ant 1.6
         - they worked in Ant 1.5?
       
       </a></li>
                 <li><a href="#oom-on-mac">
   
         Ant runs into an infinite loop/throws an OutOfMemoryError
         when I compile my project under Mac OS X.
       
       </a></li>
+                <li><a href="#extension-point-and-import">
+  <code>extension-point</code> doesn't work
+        with <code>import</code> like the documentation
+        states.
+      </a></li>
             </ul>
     
       <h3 class="section">Answers</h3>
                     <p class="faq">
       <a name="latest-version"></a>
       Where do I find the latest version of this
         document?
     </p>
                   <p>The latest version can always be found at Ant's homepage
           <a href="http://ant.apache.org/faq.html">http://ant.apache.org/faq.html</a>.</p>
                     <p class="faq">
       <a name="adding-faqs"></a>
       How can I contribute to this FAQ?
     </p>
                   <p>The page you are looking it is generated from
           <a href="http://svn.apache.org/repos/asf/ant/core/trunk/xdocs/faq.xml">this</a>
           document.  If you want to add a new question, please submit
           a patch against this document to one of Ant's mailing lists;
           hopefully, the structure is self-explanatory.</p>
                         <p>If you don't know how to create a patch, see the patches
           section of <a href="http://jakarta.apache.org/site/source.html">this
           page</a>.</p>
                     <p class="faq">
       <a name="creating-faq"></a>
       How do you create the HTML version of this
         FAQ?
     </p>
                   <p>We use
         <a href="http://jakarta.apache.org/velocity/anakia.html">Anakia</a>
         to render the HTML version from the original XML file.</p>
                         <p>The Velocity stylesheets used to process the XML files can
         be found in the <code>xdocs/stylesheets</code> subdirectory of
         Ant's SVN repository - the build file
         <code>docs.xml</code> at the top level of the ant SVN
         module (trunk) is used to drive Anakia.</p>
                         <p>To transform the xml into html, one needs velocity 1.4.
         The command to run is :</p>
                         <p>
         <code>ant -Dvelocity.dir=[installation path of velocity] -f docs.xml</code>
         </p>
                                 <p class="faq">
       <a name="what-is-ant"></a>
       What is Apache Ant?
     </p>
                   <p> Ant is a Java-based build tool. In theory, it is kind of
         like Make, without Make's wrinkles and with the full
         portability of pure Java code.</p>
                     <p class="faq">
       <a name="ant-name"></a>
       Why do you call it Ant?
     </p>
                   <p>According to Ant's original author, James Duncan
         Davidson, the name is an acronym for "Another Neat
         Tool".</p>
                         <p>Later explanations go along the lines of "ants
         do an extremely good job at building things", or
         "ants are very small and can carry a weight dozens of times
         their own" - describing what Ant is intended to
         be.</p>
                     <p class="faq">
       <a name="history"></a>
       Tell us a little bit about Ant's history.
     </p>
                   <p>Initially, Ant was part of the Tomcat code base, when it was
         donated to the Apache Software Foundation. It was
         created by James Duncan Davidson, who is also the original
         author of Tomcat. Ant was there to build Tomcat, nothing
         else.</p>
                         <p>Soon thereafter, several open source Java projects realized
         that Ant could solve the problems they had with Makefiles.
         Starting with the projects hosted at Jakarta and the old Java
         Apache project, Ant spread like a virus and is now the build
         tool of choice for a lot of projects.</p>
                         <p>In January 2000, Ant was moved to a separate CVS module and
         was promoted to a project of its own, independent of
         Tomcat, and became Apache Ant.</p>
                         <p>The first version of Ant that was exposed to a larger audience
         was the one that shipped with Tomcat's 3.1 release on 19 April
         2000.  This version has later been referred to as Ant
         0.3.1.</p>
                         <p>The first official release of Ant as a stand-alone product was
         Ant 1.1, released on 19 July 2000.  The complete release
         history:</p>
                               <table class="ForrestTable" cellspacing="1" cellpadding="4">
               <tr>
                       <th colspan="1" rowspan="1"
       valign="top" align="left">
           Ant Version
       </th>
                           <th colspan="1" rowspan="1"
       valign="top" align="left">
           Release Date
       </th>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.1
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           19 July 2000
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.2
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           24 October 2000
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.3
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           3 March 2001
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.4
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           3 September 2001
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.4.1
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           11 October 2001
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.5
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           10 July 2002
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.5.1
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           3 October 2002
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.5.2
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           3 March 2003
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.5.3
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           9 April 2003
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.5.4
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           12 August 2003
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.6.0
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           18 December 2003
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.6.1
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           12 February 2004
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.6.2
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           16 July 2004
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.6.3
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           28 April 2005
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.6.4
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           19 May 2005
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.6.5
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           2 June 2005
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.7.0
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           19 December 2006
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.7.1
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           27 June 2008
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.8.0
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           8 February 2010
       </td>
       </tr>
           </table>
                                 <p class="faq">
       <a name="java-version"></a>
       Which version of Java is required to run
         Ant?
     </p>
                   <p>You will need Java installed on your system, version 1.4 or
           later required, 1.5 or later strongly recommended. The later
           the version of Java, the more Ant tasks you get.</p>
                         <p>If only the JRE is present but not a full JDK then many
           tasks will not work.</p>
                         <p>The following table lists the minimum Java versions
           required to compile and run Ant.  Note that most committers
           work with more recent versions of the JDK and that Ant doesn't
           get tested much for older versions.</p>
                               <table class="ForrestTable" cellspacing="1" cellpadding="4">
               <tr>
                       <th colspan="1" rowspan="1"
       valign="top" align="left">
           Ant Version
       </th>
                           <th colspan="1" rowspan="1"
       valign="top" align="left">
           Minimum Java Version
       </th>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.1 up to 1.5.4
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.1
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.6.0 up to 1.6.5
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.2
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.7.0 up to 1.7.1
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.3
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.8.0 up to current svn trunk
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           1.4
       </td>
       </tr>
           </table>
                     <p class="faq">
       <a name="no-gnu-tar"></a>
       I get checksum errors when I try to extract the
       <code>tar.gz</code> distribution file. Why?
     </p>
                   <p>Ant's distribution contains file names that are longer
         than 100 characters, which is not supported by the standard
         tar file format. Several different implementations of tar use
         different and incompatible ways to work around this
         restriction.</p>
                         <p>Ant's &lt;tar&gt; task can create tar archives that use
         the GNU tar extension, and this has been used when putting
         together the distribution. If you are using a different
         version of tar (for example, the one shipping with Solaris),
         you cannot use it to extract the archive.</p>
                         <p>The solution is to either install GNU tar, which can be
         found <a href="http://www.gnu.org/software/tar/tar.html">here</a>,
         or use the zip archive instead (you can extract it using
         <code>jar xf</code>).</p>
                     <p class="faq">
       <a name="RedHat_ES_3"></a>
       How do you get ant-1.6.x (or any version later than
       1.5.2) to work on on RedHat ES 3?
     </p>
                   <p>Redhat ES 3.0 comes installed with ant 1.5.2. Even if you
         have your PATH and ANT_HOME variables set correctly to a later
         version of ant, you will always be forced to use the
         preinstalled version.</p>
                         <p>To use a later version of ant on this OS you could do the
         following:</p>
                         <pre class="code">
 $ ant -version
 Apache Ant version 1.5.2-23 compiled on November 12 2003
 $ su -
 # rpm -e ant ant-libs
 # exit
 $ hash -r
 $ ant -version
 Apache Ant version 1.6.2 compiled on July 16 2004
 </pre>
                                 <p class="faq">
       <a name="precompile-jsps"></a>
       How to I precompile Java Server Pages (JSPs)?
     </p>
                   <p>Ant has a built in optional task <a href="/manual/OptionalTasks/jspc.html">&lt;jspc&gt;</a>
         which was intended for that. <b>But this task is deprecated.</b>
         Here the alternative suggested by the manual:</p>
                         <p><i>Instead of relying on container specific JSP-compilers we suggest deploying
         the raw files (*.jsp) and use the container build-in functions: after deploying
         run a test suite (e.g. with
         <a href="http://jakarta.apache.org/cactus/">Cactus</a> or
         <a href="http://httpunit.sourceforge.net/">HttpUnit</a>) against the deployed web
         application. So you'll get then test result and the compiled JSPs.</i></p>
                     <p class="faq">
       <a name="implement-os-specific-configuration"></a>
       How do I realize os--specific configurations?
     </p>
                   <p>The core idea is using property files which name accords to the
         os-name. Then simply use the build-in property <tt>os.name</tt>.</p>
                         <p>For better use you should also provide a file with default values.
         But be careful with the correct os-names. For test simply &lt;echo&gt;
         the ${os.name} on all machines and you can be sure to use the right
         file names.</p>
                         <pre class="code">
           &lt;property file=&quot;${os.name}.properties&quot;/&gt;
           &lt;property file=&quot;default.properties&quot;/&gt;
 </pre>
                     <p class="faq">
       <a name="adding-external-tasks"></a>
       How do I add an external task that I've written to the
       page "External Tools and Tasks"?
     </p>
                   <p>Join and post a message to the dev or user mailing
         list (one list is enough), including the following
         information:</p>
                         <ul>
           <li>the name of the task/tool</li>
           <li>a short description of the task/tool</li>
           <li>a Compatibility: entry stating with which version(s) of
           Ant the tool/task is compatible to</li>
           <li>a URL: entry linking to the main page of the tool/task</li>
           <li>a Contact: entry containing the email address or the URL
           of a webpage for the person or list to contact for issues
           related to the tool/task.  <strong>Note that we'll add a
           link on the page, so any email address added there is not
           obfuscated and can (and probably will) be abused by robots
           harvesting websites for addresses to spam.</strong></li>
           <li>a License: entry containing the type of license for the
           tool/task</li>
         </ul>
                         <p>The preferred format for this information is a patch to <a href="http://svn.apache.org/repos/asf/ant/core/trunk/xdocs/external.xml">this</a>
         document.</p>
                         <p>If you have written something bigger than a 'simple plugin' to Ant it
         may be better to add the link to <a href="projects.html">projects.html</a>.
         The procedure to add it is the same. The file to patch is <a href="http://svn.apache.org/repos/asf/ant/core/trunk/xdocs/projects.xml">this</a>
         document. The syntax of that file is the same.</p>
                     <p class="faq">
       <a name="create-extensions"></a>
       How do I create new tasks?
     </p>
                   <p>Apart from a lot of information on using Ant, the
         <a href="manual/index.html">Manual</a> also contains information
         on how to extend Ant with new tasks. This information
         can be found under "Developing with Ant".</p>
                         <p>Chances are that someone else already created the task you
         want to create, it may be wise to see
         <a href="external.html">External Tools and Tasks</a> and
         <a href="projects.html">Related Projects</a> first.</p>
                     <p class="faq">
       <a name="passing-cli-args"></a>
       How do I pass parameters from the command line to my
         build file?
     </p>
                   <p>Use properties. Using <code>ant
         -D<em>name</em>=<em>value</em></code> lets you define values for
         properties on the Ant command line. These properties can then be
         used within your build file as
         any normal property: <code>${<em>name</em>}</code> will put in
         <code><em>value</em></code>.</p>
                     <p class="faq">
       <a name="jikes-switches"></a>
       How can I use Jikes-specific command-line
         switches?
     </p>
                   <p>A couple of switches are supported via "magic"
           properties:</p>
                               <table class="ForrestTable" cellspacing="1" cellpadding="4">
               <tr>
                       <th colspan="1" rowspan="1"
       valign="top" align="left">
           switch
       </th>
                           <th colspan="1" rowspan="1"
       valign="top" align="left">
           property
       </th>
                           <th colspan="1" rowspan="1"
       valign="top" align="left">
           default
       </th>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           +E
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           build.compiler.emacs
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           false == not set
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           +P
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           build.compiler.pedantic
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           false == not set
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           +F
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           build.compiler.fulldepend
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           false == not set
       </td>
       </tr>
                   <tr>
                       <td colspan="1" rowspan="1"
       valign="top" align="left">
           <strong>(Only for Ant &lt; 1.4; replaced by the
                 <code><strong>nowarn</strong></code>
                 attribute of the <code><strong>&lt;javac&gt;</strong></code>
                 task after that.)</strong><br />-nowarn
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           build.compiler.warnings
       </td>
                           <td colspan="1" rowspan="1"
       valign="top" align="left">
           true == not set
       </td>
       </tr>
           </table>
                         <p>With Ant &gt;= 1.5, you can also use nested
           <code>&lt;compilerarg&gt;</code> elements with the
           <code>&lt;javac&gt;</code> task.</p>
                     <p class="faq">
       <a name="shell-redirect-1"></a>
       How do I include a &lt; character in my command-line arguments?
     </p>
                   <p>The short answer is "Use: <code>&amp;lt;</code>".</p>
                         <p>The long answer is that this probably won't do what you
         want anyway (see <a href="#shell-redirect-2">the next
         section</a>).</p>
                     <p class="faq">
       <a name="shell-redirect-2"></a>
       How do I redirect standard input or standard output
         in the <code>&lt;exec&gt;</code> task?
     </p>
                   <p>Say you want to redirect the standard output stream of the
         <code>m4</code> command to write to a file, something
         like:</p>
                         <pre class="code">
 shell-prompt&gt; m4 foo.m4 &gt; foo
 </pre>
                         <p>and try to translate it into</p>
                         <pre class="code">
 &lt;exec executable=&quot;m4&quot;&gt;
   &lt;arg value=&quot;foo.m4&quot;/&gt;
   &lt;arg value=&quot;&amp;gt;&quot;/&gt;
   &lt;arg value=&quot;foo&quot;/&gt;
 &lt;/exec&gt;
 </pre>
                         <p>This will not do what you expect.  The output redirection is
         performed by your shell, not the command itself, so this
         should read:</p>
                         <pre class="code">
 &lt;exec executable=&quot;/bin/sh&quot;&gt;
   &lt;arg value=&quot;-c&quot; /&gt;
   &lt;arg value=&quot;m4 foo.m4 &amp;gt; foo&quot; /&gt;
 &lt;/exec&gt;
 </pre>
                         <p>Note that you must use the <code>value</code> attribute of
         <code>&lt;arg&gt;</code> in the last element, in order to have
         the command passed as a single, quoted argument. Alternatively,
         you can use:</p>
                         <pre class="code">
 &lt;exec executable=&quot;/bin/sh&quot;&gt;
   &lt;arg line='-c &quot;m4 foo.m4 &amp;gt; foo&quot;'/&gt;
 &lt;/exec&gt;
 </pre>
                         <p>Note the double-quotes nested inside the single-quotes.</p>
                     <p class="faq">
       <a name="batch-shell-execute"></a>
       How do I execute a batch file or shell script from Ant?
     </p>
                   <p>On native Unix systems, you should be able to run shell scripts
            directly. On systems running a Unix-type shell (for example, Cygwin
            on Windows) execute the (command) shell instead - <code>cmd</code>
            for batch files, <code>sh</code> for shell scripts - then pass the
            batch file or shell script (plus any arguments to the script)
            as a single command, using the <code>/c</code> or
            <code>-c</code> switch, respectively. See
            <a href="#shell-redirect-2">the above section</a>
            for example <code>&lt;exec&gt;</code> tasks
            executing <code>sh</code>. For batch files, use something like:</p>
                         <pre class="code">
 &lt;exec dir=&quot;.&quot; executable=&quot;cmd&quot; os=&quot;Windows NT&quot;&gt;
   &lt;arg line=&quot;/c test.bat&quot;/&gt;
 &lt;/exec&gt;
 </pre>
                     <p class="faq">
       <a name="multi-conditions"></a>
       I want to execute a particular target only if
         multiple conditions are true.
     </p>
                   <p>There are actually several answers to this question.</p>
                         <p>If you have only one set and one unset property to test,
         you can specify both an <code>if</code> and an <code>unless</code>
         attribute for the target, and they will act as if they
         are "anded" together.</p>
                         <p>If you are using a version of Ant 1.3 or earlier, the
         way to work with all other cases is to chain targets together
         to determine the specific state you want to test for.</p>
                         <p>To see how this works, assume you have three properties:
         <code>prop1</code>, <code>prop2</code>, and <code>prop3</code>.
         You want to test that <code>prop1</code> and <code>prop2</code>
         are set, and that <code>prop3</code> is not. If the condition
         holds true you want to echo "yes".</p>
                         <p>Here is the implementation in Ant 1.3 and earlier:</p>
                         <pre class="code">
 &lt;target name=&quot;cond&quot; depends=&quot;cond-if&quot;/&gt;
 
 &lt;target name=&quot;cond-if&quot; if=&quot;prop1&quot;&gt;
   &lt;antcall target=&quot;cond-if-2&quot;/&gt;
 &lt;/target&gt;
 
 &lt;target name=&quot;cond-if-2&quot; if=&quot;prop2&quot;&gt;
   &lt;antcall target=&quot;cond-if-3&quot;/&gt;
 &lt;/target&gt;
 
 &lt;target name=&quot;cond-if-3&quot; unless=&quot;prop3&quot;&gt;
   &lt;echo message=&quot;yes&quot;/&gt;
 &lt;/target&gt;
 </pre>
                         <p>Note: <code>&lt;antcall&gt;</code> tasks do <em>not</em> pass
         property changes back up to the environment they were called
         from, so you wouldn't be able to, for example, set a
         <code>result</code> property in the <code>cond-if-3</code> target,
         then do
         <code>&lt;echo message="result is ${result}"/&gt;</code>
         in the <code>cond</code> target.</p>
                         <p>Starting with Ant 1.4, you can use the
         <code>&lt;condition&gt;</code> task.</p>
                         <pre class="code">
 &lt;target name=&quot;cond&quot; depends=&quot;cond-if,cond-else&quot;/&gt;
 
 &lt;target name=&quot;check-cond&quot;&gt;
   &lt;condition property=&quot;cond-is-true&quot;&gt;
     &lt;and&gt;
       &lt;not&gt;
         &lt;equals arg1=&quot;${prop1}&quot; arg2=&quot;$${prop1}&quot; /&gt;
       &lt;/not&gt;
       &lt;not&gt;
         &lt;equals arg1=&quot;${prop2}&quot; arg2=&quot;$${prop2}&quot; /&gt;
       &lt;/not&gt;
       &lt;equals arg1=&quot;${prop3}&quot; arg2=&quot;$${prop3}&quot; /&gt;
     &lt;/and&gt;
   &lt;/condition&gt;
 &lt;/target&gt;
 
 &lt;target name=&quot;cond-if&quot; depends=&quot;check-cond&quot; if=&quot;cond-is-true&quot;&gt;
   &lt;echo message=&quot;yes&quot;/&gt;
 &lt;/target&gt;
 
 &lt;target name=&quot;cond-else&quot; depends=&quot;check-cond&quot; unless=&quot;cond-is-true&quot;&gt;
   &lt;echo message=&quot;no&quot;/&gt;
 &lt;/target&gt;
 </pre>
                         <p>This version takes advantage of two things:</p>
                         <ul>
           <li>If a property <code>a</code> has not been set,
           <code>${a}</code> will evaluate to <code>${a}</code>.</li>
 
           <li>To get a literal <code>$</code> in Ant, you have to
           escape it with another <code>$</code> - this will also break
           the special treatment of the <code>${</code> sequence.</li>
         </ul>
                         <p>Because testing for a literal <code>${property}</code> string
         isn't all that readable or easy to understand,
         post-1.4.1 Ant introduces the <code>&lt;isset&gt;</code> element
         to the <code>&lt;condition&gt;</code> task.</p>
                         <p>Here is the previous example done using
         <code>&lt;isset&gt;</code>:</p>
                         <pre class="code">
 &lt;target name=&quot;check-cond&quot;&gt;
   &lt;condition property=&quot;cond-is-true&quot;&gt;
     &lt;and&gt;
       &lt;isset property=&quot;prop1&quot;/&gt;
       &lt;isset property=&quot;prop2&quot;/&gt;
       &lt;not&gt;
         &lt;isset property=&quot;prop3&quot;/&gt;
       &lt;/not&gt;
     &lt;/and&gt;
   &lt;/condition&gt;
 &lt;/target&gt;
 </pre>
                         <p>The last option is to use a scripting language to set the
         properties. This can be particularly handy when you need much
         finer control than the simple conditions shown here but, of
         course, comes with the overhead of adding JAR files to support
         the language, to say nothing of the added maintenance in requiring
         two languages to implement a single system. See the
         <a href="manual/OptionalTasks/script.html">
         <code>&lt;script&gt;</code> task documentation</a> for more
         details.</p>
                     <p class="faq">
       <a name="encoding"></a>
       How can I include national characters like German
         umlauts in my build file?
     </p>
                   <p>You need to tell the XML parser which character encoding
         your build file uses, this is done inside the <a href="http://www.w3.org/TR/2000/REC-xml-20001006#sec-prolog-dtd">XML
         declaration</a>.</p>
                         <p>By default the parser assumes you are using the UTF-8
         encoding instead of your platform's default.  For most Western
         European countries you should set the encoding to
         <code>ISO-8859-1</code>.  To do so, make the very first line
         of you build file read like</p>
                         <pre class="code">
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot; ?&gt;
 </pre>
                     <p class="faq">
       <a name="use-zip-instead-of-jar"></a>
       How do I use <code>jar</code>'s <code>M</code> switch?
       I don't want a MANIFEST.
     </p>
                   <p>A JAR archive is a ZIP file, so if you don't want a
         MANIFEST you can simply use <code>&lt;zip&gt;</code>.</p>
                         <p>If your file names contain national characters you should
         know that Sun's <code>jar</code> utility like Ant's
         <code>&lt;jar&gt;</code> uses UTF-8 to encode their names while
         <code>&lt;zip&gt;</code> uses your platforms default encoding.
         Use the encoding attribute of <code>&lt;zip&gt;</code> if
         necessary.</p>
                     <p class="faq">
       <a name="propertyvalue-as-name-for-property"></a>
       How can I do something like <code>&lt;property name="prop"
       value="${${anotherprop}}"/&gt;</code> (double expanding the property)?
     </p>
                   <p>Without any external help you can not.</p>
                         <p>With &lt;script/&gt;, which needs external libraries, you can do</p>
                         <pre class="code">
 &lt;script language=&quot;javascript&quot;&gt;
     propname = project.getProperty(&quot;anotherprop&quot;);
     project.setNewProperty(&quot;prop&quot;, propname);
 &lt;/script&gt;
 </pre>
                         <p>With AntContrib (external task library) you can do <code>
          &lt;propertycopy name="prop" from="${anotherprop}"/&gt;</code>.</p>
                         <p>With Ant 1.6 you can simulate the AntContribs &lt;propertycopy&gt;
          and avoid the need of an external library:</p>
                         <pre class="code">
 &lt;macrodef name=&quot;propertycopy&quot;&gt;
   &lt;attribute name=&quot;name&quot;/&gt;
   &lt;attribute name=&quot;from&quot;/&gt;
   &lt;sequential&gt;
     &lt;property name=&quot;@{name}&quot; value=&quot;${@{from}}&quot;/&gt;
   &lt;/sequential&gt;
 &lt;/macrodef&gt;
 </pre>
                         <p>With the 'props' antlib (external, but also from Ant) you could
          do the dereferencing with <code>${${anotherprop}</code> - not just
          in the property task - instead everywhere in your buildfile (after
          registering the required property helper).</p>
                         <pre class="code">
 &lt;propertyhelper&gt;
   &lt;props:nested /&gt;
 &lt;/propertyhelper&gt;
 &lt;property name=&quot;foo&quot; value=&quot;foo.value&quot; /&gt;
 &lt;property name=&quot;var&quot; value=&quot;foo&quot; /&gt;
 &lt;echo&gt; ${${var}} = foo.value &lt;/echo&gt;</pre>
                     <p class="faq">
       <a name="delete-directory-children-only"></a>
       How can I delete everything beneath a particular directory,
     preserving the directory itself?
     </p>
                   <p>Most users who go down this path have no problem figuring out that
   <code>&lt;delete includeemptydirs="true" /&gt;</code> will help them.  The
   seemingly tricky part is preserving the base directory itself,
   which Ant includes in the directory scan. Fortunately the answer is simple:
 </p>
                         <pre class="code">
 &lt;delete includeemptydirs=&quot;true&quot;&gt;
   &lt;fileset dir=&quot;dirtokeep&quot; includes=&quot;**/*&quot; /&gt;
 &lt;/delete&gt;
 </pre>
                     <p class="faq">
       <a name="delete-directory-only-if-empty"></a>
       How can I delete a particular directory,
         if and only if it is empty?
     </p>
                   <p>Most users who go down this path have no problem figuring
           out that
           <code>&lt;delete includeemptydirs="true" /&gt;</code> will
           help them.  The seemingly tricky part is preserving the
           non-empty directories, which Ant includes in the directory
           scan. Fortunately the answer is simple:</p>
                         <pre class="code">
 &lt;delete includeemptydirs=&quot;true&quot;&gt;
   &lt;fileset dir=&quot;dirtokeepifnotempty&quot; excludes=&quot;**/*&quot; /&gt;
 &lt;/delete&gt;
 </pre>
                                 <p class="faq">
       <a name="general-advice"></a>
       General Advice
     </p>
                   <p>There are many reasons why Ant doesn't behave as
         expected, not all of them are due to Ant bugs.  See our <a href="problems.html">Having Problems?</a> page for hints that
         may help pinning down the reasons for your problem.</p>
                     <p class="faq">
       <a name="always-recompiles"></a>
       Why does Ant always recompile all my Java files?
     </p>
                   <p>In order to find out which files should be compiled, Ant
         compares the timestamps of the source files to those of the
         resulting <code>.class</code> files.  Opening all source files
         to find out which package they belong to would be very
         inefficient. Instead, Ant expects you to place your
         source files in a directory hierarchy that mirrors your
         package hierarchy and to point Ant to the root of this
         directory tree with the <code>srcdir</code> attribute.</p>
                         <p>Say you have <code>&lt;javac srcdir="src"
         destdir="dest"/&gt;</code>.  If Ant finds a file
         <code>src/a/b/C.java</code>, it expects it to be in package
         <code>a.b</code> so that the resulting <code>.class</code>
         file is going to be <code>dest/a/b/C.class</code>.</p>
                         <p>If your source-tree directory structure does not match your
         package structure, Ant's heuristic won't work, and
         it will recompile classes that are up-to-date.  Ant is not the
         only tool that expects a source-tree layout like this.</p>
                         <p>If you have Java source files that aren't declared to
         be part of any package, you can still use the <code>&lt;javac&gt;</code>
         task to compile these files correctly - just set the
         <code>srcdir</code> and <code>destdir</code> attributes to
         the actual directory the source
         files live in and the directory the class files should go into,
         respectively.</p>
                     <p class="faq">
       <a name="defaultexcludes"></a>
       I've used a <code>&lt;delete&gt;</code> task to
       delete unwanted SourceSafe control files (CVS files, editor
       backup files, etc.), but it doesn't seem to work; the files
       never get deleted. What's wrong?
     </p>
                   <p>This is probably happening because, by default, Ant excludes
         SourceSafe control files (<code>vssver.scc</code>) and certain other
         files from FileSets.</p>
                         <p>Here's what you probably did:</p>
                         <pre class="code">
 &lt;delete&gt;
   &lt;fileset dir=&quot;${build.src}&quot; includes=&quot;**/vssver.scc&quot;/&gt;
 &lt;/delete&gt;
 </pre>
                         <p>You need to switch off the default exclusions,
            and it will work:</p>
                         <pre class="code">
 &lt;delete&gt;
   &lt;fileset dir=&quot;${build.src}&quot; includes=&quot;**/vssver.scc&quot;
            defaultexcludes=&quot;no&quot;/&gt;
 &lt;/delete&gt;
 </pre>
                         <p>For a complete listing of the patterns that are excluded
         by default, see <a href="manual/dirtasks.html#defaultexcludes">the user
         manual</a>.</p>
                     <p class="faq">
       <a name="stop-dependency"></a>
       I have a target I want to skip if a property is set,
       so I have <code>unless="property"</code> as an attribute
       of the target, but all the targets this target
       depends on are still executed. Why?
     </p>
                   <p>The list of dependencies is generated by Ant before any of the
         targets are run. This allows dependent targets, such as an
         <code>init</code> target, to set properties that can control the
                execution of the targets higher in the dependency graph. This
               is a good thing.</p>
                         <p>However, when your dependencies break down the
         higher-level task
         into several smaller steps, this behaviour becomes
         counter-intuitive. There are a couple of solutions available:
         </p>
                         <ol>
           <li>Put the same condition on each of the dependent targets.</li>
 
           <li>Execute the steps using <code>&lt;antcall&gt;</code>,
           instead of specifying them inside the <code>depends</code>
           attribute.</li>
         </ol>
                     <p class="faq">
       <a name="include-order"></a>
       In my <code>&lt;fileset&gt;</code>, I've put in an
       <code>&lt;exclude&gt;</code> of all files followed by an
       <code>&lt;include&gt;</code> of just the files I want, but it
       isn't giving me any files at all. What's wrong?
       
     </p>
                   <p>The order of the <code>&lt;include&gt;</code> and
         <code>&lt;exclude&gt;</code> tags within a <code>&lt;fileset&gt;</code>
         is ignored when the FileSet is created. Instead, all of the
         <code>&lt;include&gt;</code> elements are processed together,
         followed by all of the <code>&lt;exclude&gt;</code>
         elements. This means that the <code>&lt;exclude&gt;</code>
         elements only apply to the file list produced by the
         <code>&lt;include&gt;</code> elements.</p>
                         <p>To get the files you want, focus on just the
         <code>&lt;include&gt;</code> patterns that would be necessary
         to get them. If you find you need to trim the list that the
         <code>&lt;include&gt;</code> elements produce, then use
         <code>&lt;exclude&gt;</code> elements.</p>
                     <p class="faq">
       <a name="properties-not-trimmed"></a>
       <code>ant</code> failed to build my program via javac
       even when I put the needed jars in an external
       <code>build.properties</code> file and reference them by
       <code>pathelement</code> or <code>classpath refid</code>.
     </p>
                   <p>When <code>ant</code> loads properties from an external
         file it doesn't touch the value of properties, trailing blanks
         will not be trimmed for example.</p>
                         <p>If the value represents a file path, like a jar needed to
         compile, the task which requires the value, javac for example
         would fail to compile since it can't find the file due to
         trailing spaces.</p>
                     <p class="faq">
       <a name="winzip-lies"></a>
       Ant creates WAR files with a lower-case
         <code>web-inf</code> or JAR files with a lower-case
         <code>meta-inf</code> directory.
     </p>
                   <p>No it doesn't.</p>
                         <p>You may have seen these lower-case directory names in
         WinZIP, but WinZIP is trying to be helpful (and fails).  If
         WinZIP encounters a filename that is all upper-case, it
         assumes it has come from an old DOS box and changes the case to
         all lower-case for you.</p>
                         <p>If you extract (or just check) the archive with jar, you
         will see that the names have the correct case.</p>
                         <p>With WinZIP (version 8.1 at least), this can be corrected in the
         configuration.  In the Options/Configuration menu, in the View tab, General
         section, check the "Allow all upper case files names" box.  The META-INF and
         WEB-INF will look correct.</p>
                     <p class="faq">
       <a name="NoClassDefFoundError"></a>
       I installed Ant 1.6.x and now get
         <code>Exception in thread "main" java.lang.NoClassDefFoundError:
         </code>
       
     </p>
                   <p>
           The cause of this is that there is an old version of ant somewhere in the
           class path or configuration.
         </p>
                         <p>
           A version of this problem happens with jars that are in the classpath
           that include an embedded copy of ant classes.
           An example of this is some copies of weblogic.jar.
         </p>
                         <p>
         One can check if this is the case by doing (on unix/sh):
         <code><pre>
         unset CLASSPATH
         ant -version
         </pre>
         </code>
         </p>
                     <p class="faq">
       <a name="InstantiationException"></a>
       I installed Ant 1.6.x and now get
         <code>java.lang.InstantiationException: org.apache.tools.ant.Main</code>
       
     </p>
                   <p>
           The cause of this is that there is an old version of ant somewhere in the
           class path or configuration.
         </p>
                         <p>
           A version of this problem may be seen on some linux systems.
           Some linux systems (Fedora Core 2 for example), comes with a version
           of ant pre-installed. There is a configuration file called
           <code>/etc/ant.conf</code> which if present, the ant shell
           script will 'dot' include. On Fedora Core 2, the /etc/ant.conf
           file resets the <code>ANT_HOME</code> environment variable to
           <code>/usr/share/ant</code>. This causes the problem that
           an old version of ant (1.5.x in this cause) will be used
           with a new version of the ant script file.
         </p>
                         <p>
           One can check if this is the case by doing
           <code>ant --noconfig -version</code>.
         </p>
                     <p class="faq">
       <a name="mangled-manifest"></a>
       
         Whenever I use the Ant jar or manifest related tasks, long lines in
         my manifest are wrapped at 70 characters and the resulting jar does
         not work in my application server. Why does Ant do this?
       
     </p>
                   <p>
           Ant implements the Java
           <a href="http://java.sun.com/j2se/1.4.2/docs/guide/jar/jar.html">Jar
           file specification</a>. Please refer to the notes section where it
           discusses the maximum allowable length of a line and the concept of
           continuation characters.
         </p>
                         <p>
           If a jar file produced by Ant does not work in your appserver, and
           that failure is due to the wrapped manifest, then you need
           to consult your appserver provider, as it is a bug in their
           appserver. Far more likely, however, is a problem in your
           specification of your classpath. It is not Ant's wrapping of your
           classpath that is the problem.
         </p>
                         <p>
           Do not raise a bug about this issue until you have checked to ensure
           that the problem is not due to your classpath specification.
         </p>
                     <p class="faq">
       <a name="CreateProcess_error_2"></a>
       <code>&lt;exec&gt;</code> fails with <code>"Cannot run
           program "...":CreateProcess error=2"</code> on
         Windows.
     </p>
                   <p>A common problem is not having the executable on the
           PATH. In case you get an error message <code>Cannot run
           program "...":CreateProcess error=2. The system cannot find
             the path specified.</code> have a look at your PATH
           variable.</p>
                         <p>Just type the command directly on the command line and if
           Windows finds it, Ant should do it too. (Otherwise ask on
           the user mailinglist for help.) If Windows can not execute
           the program add the directory of the programm to the PATH
           (<code>set PATH=%PATH%;dirOfProgram</code>) or specify the
           absolute path in the <code>executable</code> attribute in
           your buildfile.</p>
                                 <p class="faq">
       <a name="integration"></a>
       Is Ant supported by my IDE/Editor?
     </p>
                   <p>See the <a href="external.html#IDE and Editor Integration">section
         on IDE integration</a> on our External Tools and Tasks page.</p>
                     <p class="faq">
       <a name="emacs-mode"></a>
       Why doesn't (X)Emacs/vi/MacOS X's project builder
       correctly parse the error messages generated by Ant?
     </p>
                   <p>Ant adds a "banner" with the name of the current
         task in front of all logging messages - and there are no built-in
         regular expressions in your editor that would account for
         this.</p>
                         <p>You can disable this banner by invoking Ant with the
         <code>-emacs</code> switch.  To make Ant autodetect
         Emacs' compile mode, put this into your
         <code>.antrc</code> (contributed by Ville Skytt).</p>
                         <pre class="code">
 # Detect (X)Emacs compile mode
 if [ &quot;$EMACS&quot; = &quot;t&quot; ] ; then
   ANT_ARGS=&quot;$ANT_ARGS -emacs&quot;
   ANT_OPTS=&quot;$ANT_OPTS -Dbuild.compiler.emacs=true&quot;
 fi
 </pre>
                         <p>Alternatively, you can add the following snippet to your
         <code>.emacs</code> to make Emacs understand Ant's
         output.</p>
                         <pre class="code">
 (require 'compile)
 (setq compilation-error-regexp-alist
   (append (list
      ;; works for jikes
      '(&quot;^\\s-*\\[[^]]*\\]\\s-*\\(.+\\):\\([0-9]+\\):\\([0-9]+\\):[0-9]+:[0-9]+:&quot; 1 2 3)
      ;; works for javac
      '(&quot;^\\s-*\\[[^]]*\\]\\s-*\\(.+\\):\\([0-9]+\\):&quot; 1 2))
   compilation-error-regexp-alist))
 </pre>
                         <p>Yet another alternative that preserves most of Ant's
         formatting is to pipe Ant's output through the following Perl
         script by Dirk-Willem van Gulik:</p>
                         <pre class="code">
 #!/usr/bin/perl
 #
 # May 2001 dirkx@apache.org - remove any
 # [foo] lines from the output; keeping
 # spacing more or less there.
 #
 $|=1;
 while(&lt;STDIN&gt;) {
         if (s/^(\s+)\[(\w+)\]//) {
                 if ($2 ne $last) {
                         print &quot;$1\[$2\]&quot;;
                         $s = ' ' x length($2);
                 } else {
                         print &quot;$1 $s &quot;;
                 };
                 $last = $2;
         };
         print;
 };
 </pre>
                                 <p class="faq">
       <a name="dtd"></a>
       Is there a DTD that I can use to validate my build
       files?
     </p>
                   <p>An incomplete DTD can be created by the
           <code>&lt;antstructure&gt;</code> task - but this one
           has a few problems:</p>
                         <ul>
             <li>It doesn't know about required attributes.  Only
             manual tweaking of this file can help here.</li>
 
             <li>It is not complete - if you add new tasks via
             <code>&lt;taskdef&gt;</code> it won't know about it.  See
             <a href="http://www.sdv.fr/pages/casa/html/ant-dtd.en.html">this
             page</a> by Michel Casabianca for a solution to this
             problem.  Note that the DTD you can download at this page
             is based on Ant 0.3.1.</li>
 
             <li>It may even be an invalid DTD.  As Ant allows tasks
             writers to define arbitrary elements, name collisions will
             happen quite frequently - if your version of Ant contains
             the optional <code>&lt;test&gt;</code> and
             <code>&lt;junit&gt;</code> tasks, there are two XML
             elements named <code>test</code> (the task and the nested child
             element of <code>&lt;junit&gt;</code>) with different attribute
             lists.  This problem cannot be solved; DTDs don't give a
             syntax rich enough to support this.</li>
           </ul>
                     <p class="faq">
       <a name="xml-entity-include"></a>
       How do I include an XML snippet in my build file?
     </p>
                   <p>You can use XML's way of including external files and let
         the parser do the job for Ant:</p>
                         <pre class="code">
 &lt;?xml version=&quot;1.0&quot;?&gt;
 
 &lt;!DOCTYPE project [
        &lt;!ENTITY common SYSTEM &quot;common.xml&quot;&gt;
 ]&gt;
 
 &lt;project name=&quot;test&quot; default=&quot;test&quot; basedir=&quot;.&quot;&gt;
 
   &lt;target name=&quot;setup&quot;&gt;
     ...
   &lt;/target&gt;
 
   &amp;common;
 
   ...
 
 &lt;/project&gt;
 </pre>
                         <p>will literally include the contents of <code>common.xml</code> where
         you've placed the <code>&amp;common;</code> entity.</p>
                         <p>(The filename <code>common.xml</code> in this example is resolved
         relative to the containing XML file by the XML parser. You may also use
         an absolute <code>file:</code> protocol URI.)</p>
                         <p>In combination with a DTD, this would look like this:</p>
                         <pre class="code">
 &lt;!DOCTYPE project PUBLIC &quot;-//ANT//DTD project//EN&quot; &quot;ant.dtd&quot; [
    &lt;!ENTITY include SYSTEM &quot;header.xml&quot;&gt;
 ]&gt;
 </pre>
                         <p>Starting with Ant 1.6, there is a new
         <code>&lt;import&gt;</code> task that can (also) be used to
         include build file fragments.  Unlike the snippets used with
         entity includes, the referenced files have to be complete Ant
         build files, though.</p>
                         <p>The example above would become:</p>
                         <pre class="code">
 &lt;?xml version=&quot;1.0&quot;?&gt;
 &lt;project name=&quot;test&quot; default=&quot;test&quot; basedir=&quot;.&quot;&gt;
 
   &lt;target name=&quot;setup&quot;&gt;
     ...
   &lt;/target&gt;
 
   &lt;import file=&quot;./common.xml&quot;/&gt;
 
   ...
 
 &lt;/project&gt;
 </pre>
                         <p>Unlike entity includes, <code>&lt;import&gt;</code> will
         let you use Ant properties in the file name.</p>
                     <p class="faq">
       <a name="mail-logger"></a>
       How do I send an email with the result of my build
         process?
     </p>
                   <p>If you are using a nightly build of Ant 1.5 after
         2001-12-14, you can use the built-in MailLogger:</p>
                         <pre class="code">
          ant -logger org.apache.tools.ant.listener.MailLogger
 </pre>
                         <p>See the <a href="http://svn.apache.org/repos/asf/ant/core/trunk/docs/manual/listeners.html">Listeners
         &amp; Loggers</a> documentation for details on the properties
         required.</p>
                         <p>For older versions of Ant, you can use a custom
         BuildListener that sends out an email
         in the buildFinished() method.  Will Glozer
         &lt;will.glozer@jda.com&gt; has written such a listener based
         on <a href="http://java.sun.com/products/javamail/">JavaMail</a>.
         The source is:</p>
                         <pre class="code">
 import java.io.*;
 import java.util.*;
 import javax.mail.*;
 import javax.mail.internet.*;
 import org.apache.tools.ant.*;
 
 /**
  * A simple listener that waits for a build to finish and sends an email
  * of the results.  The settings are stored in &quot;monitor.properties&quot; and
  * are fairly self explanatory.
  *
  * @author      Will Glozer
  * @version     1.05a 09/06/2000
  */
 public class BuildMonitor implements BuildListener {
     protected Properties props;
 
     /**
      * Create a new BuildMonitor.
      */
     public BuildMonitor() throws Exception {
         props = new Properties();
         InputStream is = getClass().getResourceAsStream(&quot;monitor.properties&quot;);
         props.load(is);
         is.close();
     }
 
     public void buildStarted(BuildEvent e) {
     }
 
     /**
      * Determine the status of the build and the actions to follow, now that
      * the build has completed.
      *
      * @param       e       Event describing the build status.
      */
     public void buildFinished(BuildEvent e) {
         Throwable th = e.getException();
         String status = (th != null) ? &quot;failed&quot; : &quot;succeeded&quot;;
 
         try {
             String key = &quot;build.&quot; + status;
             if (props.getProperty(key + &quot;.notify&quot;).equalsIgnoreCase(&quot;false&quot;)) {
                     return;
             }
 
             Session session = Session.getDefaultInstance(props, null);
 
             MimeMessage message = new MimeMessage(session);
             message.addRecipients(Message.RecipientType.TO, parseAddresses(
                 props.getProperty(key + &quot;.email.to&quot;)));
             message.setSubject(props.getProperty(key + &quot;.email.subject&quot;));
 
             BufferedReader br = new BufferedReader(new FileReader(
                 props.getProperty(&quot;build.log&quot;)));
             StringWriter sw = new StringWriter();
 
             String line = br.readLine();
             while (line != null) {
                 sw.write(line);
                 sw.write(&quot;\n&quot;);
                 line = br.readLine();
             }
             br.close();
 
             message.setText(sw.toString(), &quot;UTF-8&quot;);
             sw.close();
 
             Transport transport = session.getTransport();
             transport.connect();
             transport.send(message);
             transport.close();
         } catch (Exception ex) {
             System.out.println(&quot;BuildMonitor failed to send email!&quot;);
             ex.printStackTrace();
         }
     }
 
     /**
      * Parse a comma separated list of internet email addresses.
      *
      * @param       s       The list of addresses.
      * @return      Array of Addresses.
      */
     protected Address[] parseAddresses(String s) throws Exception {
         StringTokenizer st = new StringTokenizer(s, &quot;,&quot;);
         Address[] addrs = new Address[st.countTokens()];
 
         for (int i = 0; i &lt; addrs.length; i++) {
             addrs[i] = new InternetAddress(st.nextToken());
         }
         return addrs;
     }
 
     public void messageLogged(BuildEvent e) {
     }
 
     public void targetStarted(BuildEvent e) {
     }
 
     public void targetFinished(BuildEvent e) {
     }
 
     public void taskStarted(BuildEvent e) {
     }
 
     public void taskFinished(BuildEvent e) {
     }
 }
 </pre>
                         <p>With a <code>monitor.properties</code> like this:</p>
                         <pre class="code">
 # configuration for build monitor
 
 mail.transport.protocol=smtp
 mail.smtp.host=&lt;host&gt;
 mail.from=Will Glozer &lt;will.glozer@jda.com&gt;
 
 build.log=build.log
 
 build.failed.notify=true
 build.failed.email.to=will.glozer@jda.com
 build.failed.email.subject=Nightly build failed!
 
 build.succeeded.notify=true
 build.succeeded.email.to=will.glozer@jda.com
 build.succeeded.email.subject=Nightly build succeeded!
 </pre>
                         <p><code>monitor.properties</code> should be placed right next
         to your compiled <code>BuildMonitor.class</code>.  To use it,
         invoke Ant like:</p>
                         <pre class="code">
 ant -listener BuildMonitor -logfile build.log
 </pre>
                         <p>Make sure that <code>mail.jar</code> from JavaMail and
         <code>activation.jar</code> from the
         <a href="http://java.sun.com/products/javabeans/glasgow/jaf.html">Java
         Beans Activation Framework</a> are in your <code>CLASSPATH</code>.</p>
                     <p class="faq">
       <a name="listener-properties"></a>
       How do I get at the properties that Ant was running
       with from inside BuildListener?
     </p>
                   <p>You can get at a hashtable with all the properties that Ant
         has been using through the BuildEvent parameter. For
         example:</p>
                         <pre class="code">
 public void buildFinished(BuildEvent e) {
     Hashtable table = e.getProject().getProperties();
     String buildpath = (String)table.get(&quot;build.path&quot;);
     ...
 }
 </pre>
                         <p>This is more accurate than just reading the same property
         files that your project does, since it will give the correct
         results for properties that were specified on the Ant command line.</p>
                                 <p class="faq">
       <a name="input-makes-exec-hang"></a>
       <code>&lt;exec&gt;</code> causes other tasks to hang
         or leads to strange behaviour of <code>&lt;input&gt;</code>
         tasks.
     </p>
                   <p>When Ant forks a new process for example by using the
           <code>&lt;exec&gt;</code>, <code>&lt;apply&gt;</code>
           or <code>&lt;java&gt;</code> tasks, it will also start a
           new thread reading from standard input and sending
           everything that it has read to that process.</p>
                         <p>Unfortunately Ant has no way to know whether the forked
           process is ever going to read any input, so it will start such
           a thread even if the process doesn't need one.</p>
                         <p>This behaviour leads to strange side effects like the Ant
           process
           being <a href="https://issues.apache.org/bugzilla/show_bug.cgi?id=34461">suspended
           when a build forking new process is run as a background
           process</a> on Unix-like systems or
           <code>&lt;input&gt;</code>
           tasks <a href="https://issues.apache.org/bugzilla/show_bug.cgi?id=41024">requiring
           additional inputs</a> if they come after
           an <code>&lt;exec&gt;</code> task.</p>
                         <p>Fortunately there is a workaround for this, always specify
           <code>inputstring=""</code> for
           any <code>&lt;exec&gt;</code> task (or one of its sibblings)
           if you know the forked process doesn't consume any
           input.</p>
                     <p class="faq">
       <a name="javac-stackoverflow"></a>
       <code>&lt;javac&gt;</code> causes a
         StackOverflowError
     </p>
                   <p>For some Java source files it is possible
           that <a href="https://issues.apache.org/bugzilla/show_bug.cgi?id=45370">causes
           a StackOverlowError</a> is thrown inside Sun's javac
           compiler.  As far as we can tell this is not triggered by a
           bug in Ant.</p>
                         <p>It is possible to work around this problem by setting 
           <code>&lt;javac&gt;</code>'s fork attribute to true.</p>
                     <p class="faq">
       <a name="170-requires-junit"></a>
       Ant 1.7.0 doesn't build from sources without
         JUnit
     </p>
                   <p>When building Ant 1.7.0 from the source release without
         junit.jar the build fails with the message "We cannot build
         the test jar unless JUnit is present".</p>
                         <p>With Ant 1.7.0 we've started to add ant-testutil.jar as
         part of the distribution and this causes a hard dependency on
         JUnit - at least in version 1.7.0.  Unfortunately the
         installation docs don't say so.</p>
                         <p>There are two workarounds:</p>
                         <ol>
 
           <li>Add junit.jar to your CLASSPATH when building Ant.</li>
 
           <li>Change Ant's buildfile and remove test-jar from the
           depends list of the dist-lite target.</li>
 
         </ol>
                     <p class="faq">
       <a name="remove-cr"></a>
       &lt;chmod&gt; or &lt;exec&gt; doesn't work in Ant
         1.3 on Unix
     </p>
                   <p>The <code>antRun</code> script in <code>ANT_HOME/bin</code>
         has DOS instead of Unix line endings; you must remove the
         carriage-return characters from this file.  This can be done by
         using Ant's <code>&lt;fixcrlf&gt;</code> task
         or something like:</p>
                         <pre class="code">
 tr -d '\r' &lt; $ANT_HOME/bin/antRun &gt; /tmp/foo
 mv /tmp/foo $ANT_HOME/bin/antRun
 </pre>
                     <p class="faq">
       <a name="delegating-classloader"></a>
       &lt;style&gt; or &lt;junit&gt; ignores my
       &lt;classpath&gt;
     </p>
                   <p>Starting with Ant 1.7.0, &lt;junit&gt; will honor your
         nested &lt;classpath&gt;.</p>
                         <p>These tasks don't ignore your classpath setting, you
         are facing a common problem with delegating classloaders.</p>
                         <p>This question collects a common type of problem: A task
         needs an external library and it has a nested classpath
         element so that you can point it to this external library, but
         that doesn't work unless you put the external library
         into the <code>CLASSPATH</code> or place it in
         <code>ANT_HOME/lib</code>.</p>
                         <p>Some background is necessary before we can discuss
         solutions for <a href="#delegating-classloader-1.5">Ant
         1.5.x</a> and <a href="#delegating-classloader-1.6">Ant
         1.6.x</a>.</p>
                         <p>When you specify a nested <code>&lt;classpath&gt;</code> in
         Ant, Ant creates a new class loader that uses the path you
         have specified.  It then tries to load additional classes from
         this classloader.</p>
                         <p>In most cases - for example using &lt;style&gt; or
         &lt;junit&gt; - Ant doesn't load the external library
         directly, it is the loaded class that does so.</p>
                         <p>In the case of <code>&lt;junit&gt;</code> it is the task
         implementation itself and in the case of
         <code>&lt;style&gt;</code> it is the implementation of the
         <code>org.apache.tools.ant.taskdefs.XSLTLiaison</code>
         class.</p>
                         <p><em>As of Ant 1.7</em> <code>&lt;junit&gt;</code> no longer
         requires you to have <code>junit.jar</code> in Ant's startup
         classpath even if <code>ant-junit.jar</code> is present there.</p>
                         <p>Ant's class loader implementation uses Java's
         delegation model, see <a href="http://java.sun.com/products/jdk/1.2/docs/api/java/lang/ClassLoader.html">http://java.sun.com/products/jdk/1.2/docs/api/java/lang/ClassLoader.html</a>
         the paragraph</p>
                         <blockquote>The <code>ClassLoader</code> class uses a
         delegation model to search for classes and resources. Each
         instance of <code>ClassLoader</code> has an associated parent
         class loader.  When called upon to find a class or resource, a
         <code>ClassLoader</code> instance will delegate the search for
         the class or resource to its parent class loader before
         attempting to find the class or resource itself. The virtual
         machine's built-in class loader, called the bootstrap
         class loader, does not itself have a parent but may serve as
         the parent of a <code>ClassLoader</code>
         instance.</blockquote>
                         <p>The possible solutions depend on the version of Ant you
         use, see the next sections.</p>
                     <p class="faq">
       <a name="delegating-classloader-1.5"></a>
       &lt;style&gt; or &lt;junit&gt; ignores my
       &lt;classpath&gt; - Ant 1.5.x version
     </p>
                   <p>Please read <a href="#delegating-classloader">the previous
         entry</a> before you go ahead.</p>
                         <p>First of all let's state that Ant's wrapper script
         (<code>ant</code> or <code>ant.bat</code>) adds all
         <code>.jar</code> files from <code>ANT_HOME/lib</code> to
         <code>CLASSPATH</code>, therefore "in
         <code>CLASSPATH</code>" shall mean "either in your
         <code>CLASSPATH</code> environment variable or
         <code>ANT_HOME/lib</code>" for the rest of this
         answer.</p>
                         <p>The root of the problem is that the class that needs the
         external library is on the <code>CLASSPATH</code>.</p>
                         <p>Let's see what happens when you load the &lt;junit&gt;
         task.  Ant's class loader will consult the
         bootstrap class loader first, which tries to load classes from
         <code>CLASSPATH</code>.  The bootstrap class loader
         doesn't know anything about Ant's class loader or
         even the path you have specified.</p>
                         <p>If the bootstrap class loader can load the class Ant has
         asked it to load (which it can if <code>optional.jar</code> is
         part of <code>CLASSPATH</code>), this class will try to load
         the external library from <code>CLASSPATH</code> as well - it
         doesn't know anything else - and will not find it unless
         the library is in <code>CLASSPATH</code> as well.</p>
                         <p>To solve this, you have two major options:</p>
                         <ol>
           <li>put all external libraries you need in
           <code>CLASSPATH</code> as well this is not what you want,
           otherwise you wouldn't have found this FAQ entry.</li>
 
           <li>remove the class that loads the external library from
           the <code>CLASSPATH</code>.</li>
         </ol>
                         <p>The easiest way to do this is to remove
         <code>optional.jar</code> from <code>ANT_HOME/lib</code>.  If
         you do so, you will have to <code>&lt;taskdef&gt;</code> all
         optional tasks and use nested <code>&lt;classpath&gt;</code>
         elements in the <code>&lt;taskdef&gt;</code> tasks that point
         to the new location of <code>optional.jar</code>.  Also,
         don't forget to add the new location of
         <code>optional.jar</code> to the
         <code>&lt;classpath&gt;</code> of your
         <code>&lt;style&gt;</code> or <code>&lt;junit&gt;</code>
         task.</p>
                         <p>If you want to avoid to <code>&lt;taskdef&gt;</code> all
         optional tasks you need, the only other option is to remove
         the classes that should not be loaded via the bootstrap class
         loader from <code>optional.jar</code> and put them into a
         separate archive. Add this separate archive to the
         <code>&lt;classpath&gt;</code> of your
         <code>&lt;style&gt;</code> or <code>&lt;junit&gt;</code> task
         - and make sure the separate archive is not in
         <code>CLASSPATH</code>.</p>
                         <p>In the case of <code>&lt;junit&gt;</code> you'd have
         to remove all classes that are in the
         <code>org/apache/tools/ant/taskdefs/optional/junit</code>
         directory, in the <code>&lt;style&gt;</code> case it is one of
         the <code>*Liaison</code> classes in
         <code>org/apache/tools/ant/taskdefs/optional</code>.</p>
                         <p>If you use the option to break up <code>optional.jar</code>
         for <code>&lt;junit&gt;</code> or remove
         <code>ant-junit.jar</code>, you still have to use a
         <code>&lt;taskdef&gt;</code> with a nested
         <code>&lt;classpath&gt;</code> to define the junit task.</p>
                     <p class="faq">
       <a name="delegating-classloader-1.6"></a>
       &lt;style&gt; or &lt;junit&gt; ignores my
       &lt;classpath&gt; - Ant 1.6.x version
     </p>
                   <p>Please read <a href="#delegating-classloader">the general
         entry</a> before you go ahead.</p>
                         <p>The wrapper script of Ant 1.6.x no longer adds the contents
         of <code>ANT_HOME/lib</code> to <code>CLASSPATH</code>,
         instead Ant will create a classloader on top of the bootstrap
         classloader - let's call it the coreloader for the rest of
         this answer - which holds the contents of
         <code>ANT_HOME/lib</code>.  Ant's core and its tasks will be
         loaded through this classloader and not the bootstrap
         classloader.</p>
                         <p>This causes some small but notable differences between Ant
         1.5.x and 1.6.x.  Most importantly, a third-party task that is
         part of <code>CLASSPATH</code> will no longer work in Ant
         1.6.x since the task now can't find Ant's classes.  In a sense
         this is the same problem this entry is about, only
         <code>ant.jar</code> has become the external library in
         question now.</p>
                         <p>This coreloader also holds the contents of
         <code>~/.ant/lib</code> and any file or directory that has
         been specified using Ant's <code>-lib</code> command line
         argument.</p>
                         <p>Let's see what happens when you load the &lt;junit&gt;
         task.  Ant's class loader will consult the bootstrap
         class loader first, which tries to load classes from
         <code>CLASSPATH</code>.  The bootstrap class loader
         doesn't know anything about Ant's class loader or
         even the path you have specified.  If it fails to find the
         class using the bootstrap classloader it will try the
         coreloader next.  Again, the coreloader doesn't know anything
         about your path.</p>
                         <p>If the coreloader can load the class Ant has asked it to
         load (which it can if <code>ant-junit.jar</code> is in
         <code>ANT_HOME/lib</code>), this class will try to load the
         external library from coreloader as well - it doesn't
         know anything else - and will not find it unless the library
         is in <code>CLASSPATH</code> or the coreloader as well.</p>
                         <p>To solve this, you have the following major options:</p>
                         <ol>
           <li>put all external libraries you need in
           <code>CLASSPATH</code> as well this is not what you want,
           otherwise you wouldn't have found this FAQ entry.</li>
 
           <li>put all external libraries you need in
           <code>ANT_HOME/lib</code> or <code>.ant/lib</code>.  This
           probably still isn't what you want, but you might reconsider
           the <code>.ant/lib</code> option.</li>
 
           <li>Always start Ant with the <code>-lib</code> command line
           switch and point to your external libraries (or the
           directories holding them).</li>
 
           <li>remove the class that loads the external library from
           the coreloader.</li>
         </ol>
                         <p>In Ant 1.6 <code>optional.jar</code> has been split into
         multiple jars, each one containing classes with the same
         dependencies on external libraries.  You can move the
         "offending" jar out of <code>ANT_HOME/lib</code>.  For the
         <code>&lt;junit&gt;</code> task it would be
         <code>ant-junit.jar</code>.</p>
                         <p>If you do so, you will have to <code>&lt;taskdef&gt;</code>
         all optional tasks that need the external library and use
         nested <code>&lt;classpath&gt;</code> elements in the
         <code>&lt;taskdef&gt;</code> tasks that point to the new
         location of <code>ant-*.jar</code>.  Also, don't forget
         to add the new location of <code>ant-*.jar</code> to the
         <code>&lt;classpath&gt;</code> of your
         <code>&lt;style&gt;</code> or <code>&lt;junit&gt;</code>
         task.</p>
                         <p>For example</p>
                         <pre class="code">
     &lt;taskdef name=&quot;junit&quot;
             class=&quot;org.apache.tools.ant.taskdefs.optional.junit.JUnitTask&quot;&gt;
       &lt;classpath&gt;
         &lt;pathelement location=&quot;HOME-OF/junit.jar&quot;/&gt;
         &lt;pathelement location=&quot;NEW-HOME-OF/ant-junit.jar&quot;/&gt;
       &lt;/classpath&gt;
     &lt;/taskdef&gt;
 </pre>
                     <p class="faq">
       <a name="unknownelement.taskcontainer"></a>
       
         Why do my custom task containers see Unknown Elements in Ant 1.6
         - they worked in Ant 1.5?
       
     </p>
                   <p>
           The objects added in TaskContainer.addTask(Task task)
           have changed from  Tasks to UnknownElements.
         </p>
                         <p>
           There was a number of valid reasons for this change. But the backward
           compatibility problems were not noticed until after Ant 1.6.0 was
           released.
         </p>
                         <p>
           Your container class will need to be modified to check if the Task
           is an UnknownElement and call perform on it to
           convert it to a Task and to execute it.
           (see apache.tools.ant.taskdefs.Sequential)
         </p>
                         <p>
           If you want to do more processing on the task,
           you need to use the techniques in apache.tools.ant.taskdefs.Antlib#execute()
           This does make use of one 1.6 method call (UE#getRealObject()),
           you need to use UE#getTask() instead - this will
           return null for non tasks (types like fileset id=x).
         </p>
                         <p>
           So.. iterate over the tasks, if they are UEs, convert them to
           tasks, using UE#maybeConfigure and UE#getTask()
         </p>
                         <pre class="code">
         for (Iterator i = tasks.iterator(); i.hasNext();) {
            Task t = (Task) i.next();
            if (t instanceof UnknownElement) {
               ((UnknownElement) t).maybeConfigure();
               t = ((UnknownElement) t).getTask();
               if (t == null) {
                   continue;
               }
            }
            // .... original Custom code
         }
         </pre>
                         <p>
           This approach should work for ant1.5 and ant1.6.
         </p>
                     <p class="faq">
       <a name="oom-on-mac"></a>
       
         Ant runs into an infinite loop/throws an OutOfMemoryError
         when I compile my project under Mac OS X.
       
     </p>
                   <p>Apple's Java VMs reside
         in <code>/System/Library/Frameworks/JavaVM.framework/Versions/X.Y.Z</code>
           and <code>JAVA_HOME</code> will usually be something
         like <code>/System/Library/Frameworks/JavaVM.framework/Versions/X.Y.Z/Home</code>.</p>
                         <p>Inside this home directory there is a symbolic link
         named <code>shared_bundle</code> that links three levels up,
         i.e. to <code>/System/Library/Frameworks/JavaVM.framework</code>.</p>
                         <p>If your build file contains a <code>fileset</code> like</p>
                         <pre class="code">
 &lt;fileset dir=&quot;${java.home}&quot; includes=&quot;**/*.jar&quot;/&gt;
 </pre>
                         <p>Ant is going to follow the <code>shared_bundle</code>
         symlink and ends up recursing into all your installed VMs.
         Even worse, it will
         enter <code>/System/Library/Frameworks/JavaVM.framework/Versions/X.Y.Z/Home</code>
           and will once again follow the same symlink.</p>
                         <p>Ant versions after Ant 1.7.1 will detect the infinite loop
         they are in, but the resulting fileset may still be too big to
         deal with, in particular if you have many different VM
         versions installed.  The problem is amplified by the fact that
         each installed version has a <code>shared_bundle</code>
         symlink in it.</p>
                         <p>One solution is to not allow the fileset to follow symbolic
           links at all, like in</p>
                         <pre class="code">
 &lt;fileset dir=&quot;${java.home}&quot; includes=&quot;**/*.jar&quot; followsymlinks=&quot;false&quot;/&gt;
 </pre>
                         <p>another one excludes the <code>shared_bundle</code>
         directories:</p>
                         <pre class="code">
 &lt;fileset dir=&quot;${java.home}&quot; includes=&quot;**/*.jar&quot; excludes=&quot;**/shared_bundle/**&quot;/&gt;
 </pre>
                         <p>For Ant 1.7.1 and earlier
         excluding <code>shared_bundle</code> may not be enough since
         there is another symlink <code>bundle</code> that points to
         the <code>Home</code> directory and will cause infite
         recursions as well.</p>
+                    <p class="faq">
+      <a name="extension-point-and-import"></a>
+      <code>extension-point</code> doesn't work
+        with <code>import</code> like the documentation
+        states.
+    </p>
+                  <p>Yes, there is
+          a <a href="https://issues.apache.org/bugzilla/show_bug.cgi?id=48804">bug
+          in Ant 1.8.0</a>.</p>
+                        <p>When using two build files like</p>
+                        <pre class="code">
+importing.xml:
+&lt;project&gt;
+   ...
+   &lt;import file=&quot;imported.xml&quot;/&gt;
+   &lt;target name=&quot;bar&quot; extensionOf=&quot;foo&quot;/&gt;
+&lt;/project&gt;
+imported.xml:
+&lt;project&gt;
+   &lt;extension-point name=&quot;foo&quot;/&gt;
+&lt;/project&gt;
+</pre>
+                        <p>Ant 1.8.0 will fail, claiming there was no extension point
+          named "foo".</p>
+                        <p>This bug has been fixed for Ant 1.8.1.  For Ant 1.8.0 there
+          is
+          a <a href="https://issues.apache.org/bugzilla/show_bug.cgi?id=48804#c9">work-around</a>:
+          add an additional layer of importing like in</p>
+                        <pre class="code">
+importing.xml:
+&lt;project&gt;
+   &lt;target name=&quot;bar&quot; extensionOf=&quot;foo&quot;/&gt;
+&lt;/project&gt;
+imported.xml:
+&lt;project&gt;
+   &lt;extension-point name=&quot;foo&quot;/&gt;
+&lt;/project&gt;
+build.xml:
+&lt;project&gt;
+   &lt;import file=&quot;imported.xml&quot;/&gt;
+   &lt;import file=&quot;importing.xml&quot;/&gt;
+&lt;/project&gt;
+</pre>
                     </div>
   </div>
 
         <p class="copyright">
         <script type="text/javascript" language="JavaScript"><!--
                 document.write(" - "+"Last Published: " + document.lastModified);
               //  -->
         </script>
       </p>
     </body>
   </html>
 
 
 
 
 
 
 
 
 
 
 
 
 
 
 
diff --git a/src/main/org/apache/tools/ant/ProjectHelper.java b/src/main/org/apache/tools/ant/ProjectHelper.java
index 93294a141..70aa56238 100644
--- a/src/main/org/apache/tools/ant/ProjectHelper.java
+++ b/src/main/org/apache/tools/ant/ProjectHelper.java
@@ -1,540 +1,555 @@
 /*
  *  Licensed to the Apache Software Foundation (ASF) under one or more
  *  contributor license agreements.  See the NOTICE file distributed with
  *  this work for additional information regarding copyright ownership.
  *  The ASF licenses this file to You under the Apache License, Version 2.0
  *  (the "License"); you may not use this file except in compliance with
  *  the License.  You may obtain a copy of the License at
  *
  *      http://www.apache.org/licenses/LICENSE-2.0
  *
  *  Unless required by applicable law or agreed to in writing, software
  *  distributed under the License is distributed on an "AS IS" BASIS,
  *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  *  See the License for the specific language governing permissions and
  *  limitations under the License.
  *
  */
 package org.apache.tools.ant;
 
 import java.io.File;
 import java.util.Hashtable;
+import java.util.LinkedList;
+import java.util.List;
 import java.util.Locale;
 import java.util.Vector;
 
 import org.apache.tools.ant.types.Resource;
 import org.apache.tools.ant.types.resources.FileResource;
 import org.apache.tools.ant.util.LoaderUtils;
 import org.xml.sax.AttributeList;
 
 /**
  * Configures a Project (complete with Targets and Tasks) based on
  * a build file. It'll rely on a plugin to do the actual processing
  * of the file.
  * <p>
  * This class also provide static wrappers for common introspection.
  */
 public class ProjectHelper {
     /** The URI for ant name space */
     public static final String ANT_CORE_URI    = "antlib:org.apache.tools.ant";
 
     /** The URI for antlib current definitions */
     public static final String ANT_CURRENT_URI      = "ant:current";
 
     /** The URI for defined types/tasks - the format is antlib:<package> */
     public static final String ANTLIB_URI     = "antlib:";
 
     /** Polymorphic attribute  */
     public static final String ANT_TYPE = "ant-type";
 
     /**
      * Name of JVM system property which provides the name of the
      * ProjectHelper class to use.
      */
     public static final String HELPER_PROPERTY = MagicNames.PROJECT_HELPER_CLASS;
 
     /**
      * The service identifier in jars which provide Project Helper
      * implementations.
      */
     public static final String SERVICE_ID = MagicNames.PROJECT_HELPER_SERVICE;
 
     /**
      * name of project helper reference that we add to a project
      */
     public static final String PROJECTHELPER_REFERENCE = MagicNames.REFID_PROJECT_HELPER;
 
     /**
      * Configures the project with the contents of the specified build file.
      *
      * @param project The project to configure. Must not be <code>null</code>.
      * @param buildFile A build file giving the project's configuration.
      *                  Must not be <code>null</code>.
      *
      * @exception BuildException if the configuration is invalid or cannot be read
      */
     public static void configureProject(Project project, File buildFile) throws BuildException {
         FileResource resource = new FileResource(buildFile);
         ProjectHelper helper = ProjectHelperRepository.getInstance().getProjectHelperForBuildFile(resource);
         project.addReference(PROJECTHELPER_REFERENCE, helper);
         helper.parse(project, buildFile);
     }
 
     /** Default constructor */
     public ProjectHelper() {
     }
 
     // -------------------- Common properties  --------------------
     // The following properties are required by import ( and other tasks
     // that read build files using ProjectHelper ).
 
     private Vector importStack = new Vector();
+    private List extensionStack = new LinkedList();
 
     /**
      *  Import stack.
      *  Used to keep track of imported files. Error reporting should
      *  display the import path.
      *
      * @return the stack of import source objects.
      */
     public Vector getImportStack() {
         return importStack;
     }
 
+    /**
+     * Extension stack.
+     * Used to keep track of targets that extend extension points.
+     *
+     * @return a list of two element string arrays where the first
+     * element is the name of the extensionpoint and the second the
+     * name of the target
+     */
+    public List getExtensionStack() {
+        return extensionStack;
+    }
+
     private final static ThreadLocal targetPrefix = new ThreadLocal() {
             protected Object initialValue() {
                 return (String) null;
             }
         };
 
     /**
      * The prefix to prepend to imported target names.
      *
      * <p>May be set by &lt;import&gt;'s as attribute.</p>
      *
      * @return the configured prefix or null
      *
      * @since Ant 1.8.0
      */
     public static String getCurrentTargetPrefix() {
         return (String) targetPrefix.get();
     }
 
     /**
      * Sets the prefix to prepend to imported target names.
      *
      * @since Ant 1.8.0
      */
     public static void setCurrentTargetPrefix(String prefix) {
         targetPrefix.set(prefix);
     }
 
     private final static ThreadLocal prefixSeparator = new ThreadLocal() {
             protected Object initialValue() {
                 return ".";
             }
         };
 
     /**
      * The separator between the prefix and the target name.
      *
      * <p>May be set by &lt;import&gt;'s prefixSeperator attribute.</p>
      *
      * @since Ant 1.8.0
      */
     public static String getCurrentPrefixSeparator() {
         return (String) prefixSeparator.get();
     }
 
     /**
      * Sets the separator between the prefix and the target name.
      *
      * @since Ant 1.8.0
      */
     public static void setCurrentPrefixSeparator(String sep) {
         prefixSeparator.set(sep);
     }
 
     private final static ThreadLocal inIncludeMode = new ThreadLocal() {
             protected Object initialValue() {
                 return Boolean.FALSE;
             }
         };
 
     /**
      * Whether the current file should be read in include as opposed
      * to import mode.
      *
      * <p>In include mode included targets are only known by their
      * prefixed names and their depends lists get rewritten so that
      * all dependencies get the prefix as well.</p>
      *
      * <p>In import mode imported targets are known by an adorned as
      * well as a prefixed name and the unadorned target may be
      * overwritten in the importing build file.  The depends list of
      * the imported targets is not modified at all.</p>
      *
      * @since Ant 1.8.0
      */
     public static boolean isInIncludeMode() {
         return inIncludeMode.get() == Boolean.TRUE;
     }
 
     /**
      * Sets whether the current file should be read in include as
      * opposed to import mode.
      *
      * @since Ant 1.8.0
      */
     public static void setInIncludeMode(boolean includeMode) {
         inIncludeMode.set(includeMode ? Boolean.TRUE : Boolean.FALSE);
     }
 
     // --------------------  Parse method  --------------------
     /**
      * Parses the project file, configuring the project as it goes.
      *
      * @param project The project for the resulting ProjectHelper to configure.
      *                Must not be <code>null</code>.
      * @param source The source for XML configuration. A helper must support
      *               at least File, for backward compatibility. Helpers may
      *               support URL, InputStream, etc or specialized types.
      *
      * @since Ant1.5
      * @exception BuildException if the configuration is invalid or cannot
      *                           be read
      */
     public void parse(Project project, Object source) throws BuildException {
         throw new BuildException("ProjectHelper.parse() must be implemented "
             + "in a helper plugin " + this.getClass().getName());
     }
 
     /**
      * Get the first project helper found in the classpath
      * 
      * @return an project helper, never <code>null</code>
      * @see org.apache.tools.ant.ProjectHelperRepository#getHelpers()
      */
     public static ProjectHelper getProjectHelper() {
         return (ProjectHelper) ProjectHelperRepository.getInstance().getHelpers().next();
     }
 
     /**
      * JDK1.1 compatible access to the context class loader. Cut & paste from JAXP.
      *
      * @deprecated since 1.6.x.
      *             Use LoaderUtils.getContextClassLoader()
      *
      * @return the current context class loader, or <code>null</code>
      * if the context class loader is unavailable.
      */
     public static ClassLoader getContextClassLoader() {
         return LoaderUtils.isContextLoaderAvailable() ? LoaderUtils.getContextClassLoader() : null;
     }
 
     // -------------------- Static utils, used by most helpers ----------------
 
     /**
      * Configures an object using an introspection handler.
      *
      * @param target The target object to be configured.
      *               Must not be <code>null</code>.
      * @param attrs  A list of attributes to configure within the target.
      *               Must not be <code>null</code>.
      * @param project The project containing the target.
      *                Must not be <code>null</code>.
      *
      * @deprecated since 1.6.x.
      *             Use IntrospectionHelper for each property.
      *
      * @exception BuildException if any of the attributes can't be handled by
      *                           the target
      */
     public static void configure(Object target, AttributeList attrs,
                                  Project project) throws BuildException {
         if (target instanceof TypeAdapter) {
             target = ((TypeAdapter) target).getProxy();
         }
         IntrospectionHelper ih = IntrospectionHelper.getHelper(project, target.getClass());
 
         for (int i = 0, length = attrs.getLength(); i < length; i++) {
             // reflect these into the target
             String value = replaceProperties(project, attrs.getValue(i), project.getProperties());
             try {
                 ih.setAttribute(project, target, attrs.getName(i).toLowerCase(Locale.ENGLISH), value);
             } catch (BuildException be) {
                 // id attribute must be set externally
                 if (!attrs.getName(i).equals("id")) {
                     throw be;
                 }
             }
         }
     }
 
     /**
      * Adds the content of #PCDATA sections to an element.
      *
      * @param project The project containing the target.
      *                Must not be <code>null</code>.
      * @param target  The target object to be configured.
      *                Must not be <code>null</code>.
      * @param buf A character array of the text within the element.
      *            Will not be <code>null</code>.
      * @param start The start element in the array.
      * @param count The number of characters to read from the array.
      *
      * @exception BuildException if the target object doesn't accept text
      */
     public static void addText(Project project, Object target, char[] buf,
         int start, int count) throws BuildException {
         addText(project, target, new String(buf, start, count));
     }
 
     /**
      * Adds the content of #PCDATA sections to an element.
      *
      * @param project The project containing the target.
      *                Must not be <code>null</code>.
      * @param target  The target object to be configured.
      *                Must not be <code>null</code>.
      * @param text    Text to add to the target.
      *                May be <code>null</code>, in which case this
      *                method call is a no-op.
      *
      * @exception BuildException if the target object doesn't accept text
      */
     public static void addText(Project project, Object target, String text)
         throws BuildException {
 
         if (text == null) {
             return;
         }
         if (target instanceof TypeAdapter) {
             target = ((TypeAdapter) target).getProxy();
         }
         IntrospectionHelper.getHelper(project, target.getClass()).addText(project, target, text);
     }
 
     /**
      * Stores a configured child element within its parent object.
      *
      * @param project Project containing the objects.
      *                May be <code>null</code>.
      * @param parent  Parent object to add child to.
      *                Must not be <code>null</code>.
      * @param child   Child object to store in parent.
      *                Should not be <code>null</code>.
      * @param tag     Name of element which generated the child.
      *                May be <code>null</code>, in which case
      *                the child is not stored.
      */
     public static void storeChild(Project project, Object parent, Object child, String tag) {
         IntrospectionHelper ih = IntrospectionHelper.getHelper(project, parent.getClass());
         ih.storeElement(project, parent, child, tag);
     }
 
     /**
      * Replaces <code>${xxx}</code> style constructions in the given value with
      * the string value of the corresponding properties.
      *
      * @param project The project containing the properties to replace.
      *                Must not be <code>null</code>.
      *
      * @param value The string to be scanned for property references.
      *              May be <code>null</code>.
      *
      * @exception BuildException if the string contains an opening
      *                           <code>${</code> without a closing
      *                           <code>}</code>
      * @return the original string with the properties replaced, or
      *         <code>null</code> if the original string is <code>null</code>.
      *
      * @deprecated since 1.6.x.
      *             Use project.replaceProperties().
      * @since 1.5
      */
      public static String replaceProperties(Project project, String value) throws BuildException {
         // needed since project properties are not accessible
          return project.replaceProperties(value);
      }
 
     /**
      * Replaces <code>${xxx}</code> style constructions in the given value
      * with the string value of the corresponding data types.
      *
      * @param project The container project. This is used solely for
      *                logging purposes. Must not be <code>null</code>.
      * @param value The string to be scanned for property references.
      *              May be <code>null</code>, in which case this
      *              method returns immediately with no effect.
      * @param keys  Mapping (String to String) of property names to their
      *              values. Must not be <code>null</code>.
      *
      * @exception BuildException if the string contains an opening
      *                           <code>${</code> without a closing
      *                           <code>}</code>
      * @return the original string with the properties replaced, or
      *         <code>null</code> if the original string is <code>null</code>.
      * @deprecated since 1.6.x.
      *             Use PropertyHelper.
      */
      public static String replaceProperties(Project project, String value, Hashtable keys)
              throws BuildException {
         PropertyHelper ph = PropertyHelper.getPropertyHelper(project);
         return ph.replaceProperties(null, value, keys);
     }
 
     /**
      * Parses a string containing <code>${xxx}</code> style property
      * references into two lists. The first list is a collection
      * of text fragments, while the other is a set of string property names.
      * <code>null</code> entries in the first list indicate a property
      * reference from the second list.
      *
      * <p>As of Ant 1.8.0 this method is never invoked by any code
      * inside of Ant itself.</p>
      *
      * @param value     Text to parse. Must not be <code>null</code>.
      * @param fragments List to add text fragments to.
      *                  Must not be <code>null</code>.
      * @param propertyRefs List to add property names to.
      *                     Must not be <code>null</code>.
      *
      * @deprecated since 1.6.x.
      *             Use PropertyHelper.
      * @exception BuildException if the string contains an opening
      *                           <code>${</code> without a closing <code>}</code>
      */
     public static void parsePropertyString(String value, Vector fragments, Vector propertyRefs)
             throws BuildException {
         PropertyHelper.parsePropertyStringDefault(value, fragments, propertyRefs);
     }
 
     /**
      * Map a namespaced {uri,name} to an internal string format.
      * For BC purposes the names from the ant core uri will be
      * mapped to "name", other names will be mapped to
      * uri + ":" + name.
      * @param uri   The namepace URI
      * @param name  The localname
      * @return      The stringified form of the ns name
      */
     public static String genComponentName(String uri, String name) {
         if (uri == null || uri.equals("") || uri.equals(ANT_CORE_URI)) {
             return name;
         }
         return uri + ":" + name;
     }
 
     /**
      * extract a uri from a component name
      *
      * @param componentName  The stringified form for {uri, name}
      * @return               The uri or "" if not present
      */
     public static String extractUriFromComponentName(String componentName) {
         if (componentName == null) {
             return "";
         }
         int index = componentName.lastIndexOf(':');
         if (index == -1) {
             return "";
         }
         return componentName.substring(0, index);
     }
 
     /**
      * extract the element name from a component name
      *
      * @param componentName  The stringified form for {uri, name}
      * @return               The element name of the component
      */
     public static String extractNameFromComponentName(String componentName) {
         int index = componentName.lastIndexOf(':');
         if (index == -1) {
             return componentName;
         }
         return componentName.substring(index + 1);
     }
 
     /**
      * Add location to build exception.
      * @param ex the build exception, if the build exception
      *           does not include
      * @param newLocation the location of the calling task (may be null)
      * @return a new build exception based in the build exception with
      *         location set to newLocation. If the original exception
      *         did not have a location, just return the build exception
      */
     public static BuildException addLocationToBuildException(
             BuildException ex, Location newLocation) {
         if (ex.getLocation() == null || ex.getMessage() == null) {
             return ex;
         }
         String errorMessage
             = "The following error occurred while executing this line:"
             + System.getProperty("line.separator")
             + ex.getLocation().toString()
             + ex.getMessage();
         if (newLocation == null) {
             return new BuildException(errorMessage, ex);
         }
         return new BuildException(errorMessage, ex, newLocation);
     }
 
     /**
      * Whether this instance of ProjectHelper can parse an Antlib
      * descriptor given by the URL and return its content as an
      * UnknownElement ready to be turned into an Antlib task.
      *
      * <p>This method should not try to parse the content of the
      * descriptor, the URL is only given as an argument to allow
      * subclasses to decide whether they can support a given URL
      * scheme or not.</p>
      *
      * <p>Subclasses that return true in this method must also
      * override {@link #parseAntlibDescriptor
      * parseAntlibDescriptor}.</p>
      *
      * <p>This implementation returns false.</p>
      *
      * @since Ant 1.8.0
      */
     public boolean canParseAntlibDescriptor(Resource r) {
         return false;
     }
 
     /**
      * Parse the given URL as an antlib descriptor and return the
      * content as something that can be turned into an Antlib task.
      *
      * @since ant 1.8.0
      */
     public UnknownElement parseAntlibDescriptor(Project containingProject,
                                                 Resource source) {
         throw new BuildException("can't parse antlib descriptors");
     }
 
     /**
      * Check if the helper supports the kind of file. Some basic check on the
      * extension's file should be done here.
      * 
      * @param buildFile
      *            the file expected to be parsed (never <code>null</code>)
      * @return true if the helper supports it
      * @since Ant 1.8.0
      */
     public boolean canParseBuildFile(Resource buildFile) {
         return true;
     }
 
     /**
      * The file name of the build script to be parsed if none specified on the command line
      * 
      * @return the name of the default file (never <code>null</code>)
      * @since Ant 1.8.0
      */
     public String getDefaultBuildFile() {
         return Main.DEFAULT_BUILD_FILENAME;
     }
 }
diff --git a/src/main/org/apache/tools/ant/helper/ProjectHelper2.java b/src/main/org/apache/tools/ant/helper/ProjectHelper2.java
index 1fa4a36bd..5f29e6aee 100644
--- a/src/main/org/apache/tools/ant/helper/ProjectHelper2.java
+++ b/src/main/org/apache/tools/ant/helper/ProjectHelper2.java
@@ -1,1221 +1,1238 @@
 /*
  *  Licensed to the Apache Software Foundation (ASF) under one or more
  *  contributor license agreements.  See the NOTICE file distributed with
  *  this work for additional information regarding copyright ownership.
  *  The ASF licenses this file to You under the Apache License, Version 2.0
  *  (the "License"); you may not use this file except in compliance with
  *  the License.  You may obtain a copy of the License at
  *
  *      http://www.apache.org/licenses/LICENSE-2.0
  *
  *  Unless required by applicable law or agreed to in writing, software
  *  distributed under the License is distributed on an "AS IS" BASIS,
  *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  *  See the License for the specific language governing permissions and
  *  limitations under the License.
  *
  */
 package org.apache.tools.ant.helper;
 
 import org.apache.tools.ant.BuildException;
 import org.apache.tools.ant.ExtensionPoint;
 import org.apache.tools.ant.Location;
 import org.apache.tools.ant.MagicNames;
 import org.apache.tools.ant.Project;
 import org.apache.tools.ant.ProjectHelper;
 import org.apache.tools.ant.RuntimeConfigurable;
 import org.apache.tools.ant.Target;
 import org.apache.tools.ant.Task;
 import org.apache.tools.ant.UnknownElement;
 import org.apache.tools.ant.types.Resource;
 import org.apache.tools.ant.types.resources.FileProvider;
 import org.apache.tools.ant.types.resources.URLProvider;
 import org.apache.tools.ant.util.FileUtils;
 import org.apache.tools.ant.util.JAXPUtils;
 import org.apache.tools.zip.ZipFile;
 import org.xml.sax.Attributes;
 import org.xml.sax.InputSource;
 import org.xml.sax.Locator;
 import org.xml.sax.SAXException;
 import org.xml.sax.SAXParseException;
 import org.xml.sax.XMLReader;
 import org.xml.sax.helpers.DefaultHandler;
 
 import java.io.File;
 import java.io.FileInputStream;
 import java.io.FileNotFoundException;
 import java.io.IOException;
 import java.io.InputStream;
 import java.io.UnsupportedEncodingException;
 import java.net.URL;
 import java.util.HashMap;
 import java.util.Hashtable;
 import java.util.Iterator;
 import java.util.Map;
 import java.util.Stack;
 
 /**
  * Sax2 based project reader
  *
  */
 public class ProjectHelper2 extends ProjectHelper {
     /** Reference holding the (ordered) target Vector */
     public static final String REFID_TARGETS = "ant.targets";
 
     /* Stateless */
 
     // singletons - since all state is in the context
     private static AntHandler elementHandler = new ElementHandler();
     private static AntHandler targetHandler = new TargetHandler();
     private static AntHandler mainHandler = new MainHandler();
     private static AntHandler projectHandler = new ProjectHandler();
 
     /** Specific to ProjectHelper2 so not a true Ant "magic name:" */
     private static final String REFID_CONTEXT = "ant.parsing.context";
 
     /**
      * helper for path -> URI and URI -> path conversions.
      */
     private static final FileUtils FILE_UTILS = FileUtils.getFileUtils();
 
     /**
      * Whether this instance of ProjectHelper can parse an Antlib
      * descriptor given by the URL and return its content as an
      * UnknownElement ready to be turned into an Antlib task.
      *
      * <p>This implementation returns true.</p>
      *
      * @since Ant 1.8.0
      */
     public boolean canParseAntlibDescriptor(Resource resource) {
         return true;
     }
 
     /**
      * Parse the given URL as an antlib descriptor an return the
      * content as something that can be turned into an Antlib task.
      *
      * <p>simply delegates to {@link #parseUnknownElement
      * parseUnknownElement} if the resource provides an URL and throws
      * an exceptipn otherwise.</p>
      *
      * @since Ant 1.8.0
      */
     public UnknownElement parseAntlibDescriptor(Project containingProject,
                                                 Resource resource) {
         URLProvider up = (URLProvider) resource.as(URLProvider.class);
         if (up == null) {
             throw new BuildException("Unsupported resource type: " + resource);
         }
         return parseUnknownElement(containingProject, up.getURL());
     }
 
     /**
      * Parse an unknown element from a url
      *
      * @param project the current project
      * @param source  the url containing the task
      * @return a configured task
      * @exception BuildException if an error occurs
      */
     public UnknownElement parseUnknownElement(Project project, URL source)
         throws BuildException {
         Target dummyTarget = new Target();
         dummyTarget.setProject(project);
 
         AntXMLContext context = new AntXMLContext(project);
         context.addTarget(dummyTarget);
         context.setImplicitTarget(dummyTarget);
 
         parse(context.getProject(), source, new RootHandler(context, elementHandler));
         Task[] tasks = dummyTarget.getTasks();
         if (tasks.length != 1) {
             throw new BuildException("No tasks defined");
         }
         return (UnknownElement) tasks[0];
     }
 
     /**
      * Parse a source xml input.
      *
      * @param project the current project
      * @param source  the xml source
      * @exception BuildException if an error occurs
      */
     public void parse(Project project, Object source) throws BuildException {
         getImportStack().addElement(source);
         AntXMLContext context = null;
         context = (AntXMLContext) project.getReference(REFID_CONTEXT);
         if (context == null) {
             context = new AntXMLContext(project);
             project.addReference(REFID_CONTEXT, context);
             project.addReference(REFID_TARGETS, context.getTargets());
         }
         if (getImportStack().size() > 1) {
             // we are in an imported file.
             context.setIgnoreProjectTag(true);
             Target currentTarget = context.getCurrentTarget();
             Target currentImplicit = context.getImplicitTarget();
             Map    currentTargets = context.getCurrentTargets();
             try {
                 Target newCurrent = new Target();
                 newCurrent.setProject(project);
                 newCurrent.setName("");
                 context.setCurrentTarget(newCurrent);
                 context.setCurrentTargets(new HashMap());
                 context.setImplicitTarget(newCurrent);
                 parse(project, source, new RootHandler(context, mainHandler));
                 newCurrent.execute();
             } finally {
                 context.setCurrentTarget(currentTarget);
                 context.setImplicitTarget(currentImplicit);
                 context.setCurrentTargets(currentTargets);
             }
         } else {
             // top level file
             context.setCurrentTargets(new HashMap());
             parse(project, source, new RootHandler(context, mainHandler));
             // Execute the top-level target
             context.getImplicitTarget().execute();
+
+            // resolve extensionOf attributes
+            for (Iterator i = getExtensionStack().iterator(); i.hasNext(); ) {
+                String[] extensionInfo = (String[]) i.next();
+                String tgName = extensionInfo[0];
+                String name = extensionInfo[1];
+                Hashtable projectTargets = project.getTargets();
+                if (!projectTargets.containsKey(tgName)) {
+                    throw new BuildException("can't add target "
+                                             + name + " to extension-point "
+                                             + tgName
+                                             + " because the extension-point"
+                                             + " is unknown.");
+                }
+                Target t = (Target) projectTargets.get(tgName);
+                if (!(t instanceof ExtensionPoint)) {
+                    throw new BuildException("referenced target "
+                                             + tgName
+                                             + " is not an extension-point");
+                }
+                t.addDependency(name);
+            }
         }
     }
 
     /**
      * Parses the project file, configuring the project as it goes.
      *
      * @param project the current project
      * @param source  the xml source
      * @param handler the root handler to use (contains the current context)
      * @exception BuildException if the configuration is invalid or cannot
      *                           be read
      */
     public void parse(Project project, Object source, RootHandler handler) throws BuildException {
 
         AntXMLContext context = handler.context;
 
         File buildFile = null;
         URL  url = null;
         String buildFileName = null;
 
         if (source instanceof File) {
             buildFile = (File) source;
         } else if (source instanceof URL) {
             url = (URL) source;
         } else if (source instanceof Resource) {
             FileProvider fp =
                 (FileProvider) ((Resource) source).as(FileProvider.class);
             if (fp != null) {
                 buildFile = fp.getFile();
             } else {
                 URLProvider up =
                     (URLProvider) ((Resource) source).as(URLProvider.class);
                 if (up != null) {
                     url = up.getURL();
                 }
             }
         }
         if (buildFile != null) {
             buildFile = FILE_UTILS.normalize(buildFile.getAbsolutePath());
             context.setBuildFile(buildFile);
             buildFileName = buildFile.toString();
         } else if (url != null) {
             try {
                 context.setBuildFile((File) null);
                 context.setBuildFile(url);
             } catch (java.net.MalformedURLException ex) {
                 throw new BuildException(ex);
             }
             buildFileName = url.toString();
         } else {
             throw new BuildException("Source " + source.getClass().getName()
                     + " not supported by this plugin");
         }
         InputStream inputStream = null;
         InputSource inputSource = null;
         ZipFile zf = null;
 
         try {
             /**
              * SAX 2 style parser used to parse the given file.
              */
             XMLReader parser = JAXPUtils.getNamespaceXMLReader();
 
             String uri = null;
             if (buildFile != null) {
                 uri = FILE_UTILS.toURI(buildFile.getAbsolutePath());
                 inputStream = new FileInputStream(buildFile);
             } else {
                 uri = url.toString();
                 int pling = -1;
                 if (uri.startsWith("jar:file")
                     && (pling = uri.indexOf("!")) > -1) {
                     zf = new ZipFile(org.apache.tools.ant.launch.Locator
                                      .fromJarURI(uri), "UTF-8");
                     inputStream =
                         zf.getInputStream(zf.getEntry(uri.substring(pling + 1)));
                 } else {
                     inputStream = url.openStream();
                 }
             }
 
             inputSource = new InputSource(inputStream);
             if (uri != null) {
                 inputSource.setSystemId(uri);
             }
             project.log("parsing buildfile " + buildFileName + " with URI = "
                         + uri + (zf != null ? " from a zip file" : ""),
                         Project.MSG_VERBOSE);
 
             DefaultHandler hb = handler;
 
             parser.setContentHandler(hb);
             parser.setEntityResolver(hb);
             parser.setErrorHandler(hb);
             parser.setDTDHandler(hb);
             parser.parse(inputSource);
         } catch (SAXParseException exc) {
             Location location = new Location(exc.getSystemId(), exc.getLineNumber(), exc
                     .getColumnNumber());
 
             Throwable t = exc.getException();
             if (t instanceof BuildException) {
                 BuildException be = (BuildException) t;
                 if (be.getLocation() == Location.UNKNOWN_LOCATION) {
                     be.setLocation(location);
                 }
                 throw be;
             }
             throw new BuildException(exc.getMessage(), t == null ? exc : t, location);
         } catch (SAXException exc) {
             Throwable t = exc.getException();
             if (t instanceof BuildException) {
                 throw (BuildException) t;
             }
             throw new BuildException(exc.getMessage(), t == null ? exc : t);
         } catch (FileNotFoundException exc) {
             throw new BuildException(exc);
         } catch (UnsupportedEncodingException exc) {
               throw new BuildException("Encoding of project file " + buildFileName + " is invalid.",
                     exc);
         } catch (IOException exc) {
             throw new BuildException("Error reading project file " + buildFileName + ": "
                     + exc.getMessage(), exc);
         } finally {
             FileUtils.close(inputStream);
             ZipFile.closeQuietly(zf);
         }
     }
 
     /**
      * Returns main handler
      * @return main handler
      */
     protected static AntHandler getMainHandler() {
         return mainHandler;
     }
 
     /**
      * Sets main handler
      * @param handler  new main handler
      */
     protected static void setMainHandler(AntHandler handler) {
         mainHandler = handler;
     }
 
     /**
      * Returns project handler
      * @return project handler
      */
     protected static AntHandler getProjectHandler() {
         return projectHandler;
     }
 
     /**
      * Sets project handler
      * @param handler  new project handler
      */
     protected static void setProjectHandler(AntHandler handler) {
         projectHandler = handler;
     }
 
     /**
      * Returns target handler
      * @return target handler
      */
     protected static AntHandler getTargetHandler() {
         return targetHandler;
     }
 
     /**
      * Sets target handler
      * @param handler  new target handler
      */
     protected static void setTargetHandler(AntHandler handler) {
         targetHandler = handler;
     }
 
     /**
      * Returns element handler
      * @return element handler
      */
     protected static AntHandler getElementHandler() {
         return elementHandler;
     }
 
     /**
      * Sets element handler
      * @param handler  new element handler
      */
     protected static void setElementHandler(AntHandler handler) {
         elementHandler = handler;
     }
 
     /**
      * The common superclass for all SAX event handlers used to parse
      * the configuration file.
      *
      * The context will hold all state information. At each time
      * there is one active handler for the current element. It can
      * use onStartChild() to set an alternate handler for the child.
      */
     public static class AntHandler  {
         /**
          * Handles the start of an element. This base implementation does
          * nothing.
          *
          * @param uri the namespace URI for the tag
          * @param tag The name of the element being started.
          *            Will not be <code>null</code>.
          * @param qname The qualified name of the element.
          * @param attrs Attributes of the element being started.
          *              Will not be <code>null</code>.
          * @param context The context that this element is in.
          *
          * @exception SAXParseException if this method is not overridden, or in
          *                              case of error in an overridden version
          */
         public void onStartElement(String uri, String tag, String qname, Attributes attrs,
                                    AntXMLContext context) throws SAXParseException {
         }
 
         /**
          * Handles the start of an element. This base implementation just
          * throws an exception - you must override this method if you expect
          * child elements.
          *
          * @param uri The namespace uri for this element.
          * @param tag The name of the element being started.
          *            Will not be <code>null</code>.
          * @param qname The qualified name for this element.
          * @param attrs Attributes of the element being started.
          *              Will not be <code>null</code>.
          * @param context The current context.
          * @return a handler (in the derived classes)
          *
          * @exception SAXParseException if this method is not overridden, or in
          *                              case of error in an overridden version
          */
         public AntHandler onStartChild(String uri, String tag, String qname, Attributes attrs,
                                        AntXMLContext context) throws SAXParseException {
             throw new SAXParseException("Unexpected element \"" + qname + " \"", context
                     .getLocator());
         }
 
         /**
          * Handle the end of a element.
          *
          * @param uri the namespace uri of the element
          * @param tag the tag of the element
          * @param qname the qualified name of the element
          * @param context the current context
          * @exception SAXParseException if an error occurs
          */
         public void onEndChild(String uri, String tag, String qname, AntXMLContext context)
                 throws SAXParseException {
         }
 
         /**
          * This method is called when this element and all elements nested into it have been
          * handled. I.e., this happens at the &lt;/end_tag_of_the_element&gt;.
          * @param uri the namespace uri for this element
          * @param tag the element name
          * @param context the current context
          */
         public void onEndElement(String uri, String tag, AntXMLContext context) {
         }
 
         /**
          * Handles text within an element. This base implementation just
          * throws an exception, you must override it if you expect content.
          *
          * @param buf A character array of the text within the element.
          *            Will not be <code>null</code>.
          * @param start The start element in the array.
          * @param count The number of characters to read from the array.
          * @param context The current context.
          *
          * @exception SAXParseException if this method is not overridden, or in
          *                              case of error in an overridden version
          */
         public void characters(char[] buf, int start, int count, AntXMLContext context)
                 throws SAXParseException {
             String s = new String(buf, start, count).trim();
 
             if (s.length() > 0) {
                 throw new SAXParseException("Unexpected text \"" + s + "\"", context.getLocator());
             }
         }
 
         /**
          * Will be called every time a namespace is reached.
          * It'll verify if the ns was processed, and if not load the task definitions.
          * @param uri The namespace uri.
          */
         protected void checkNamespace(String uri) {
         }
     }
 
     /**
      * Handler for ant processing. Uses a stack of AntHandlers to
      * implement each element ( the original parser used a recursive behavior,
      * with the implicit execution stack )
      */
     public static class RootHandler extends DefaultHandler {
         private Stack antHandlers = new Stack();
         private AntHandler currentHandler = null;
         private AntXMLContext context;
 
         /**
          * Creates a new RootHandler instance.
          *
          * @param context The context for the handler.
          * @param rootHandler The handler for the root element.
          */
         public RootHandler(AntXMLContext context, AntHandler rootHandler) {
             currentHandler = rootHandler;
             antHandlers.push(currentHandler);
             this.context = context;
         }
 
         /**
          * Returns the current ant handler object.
          * @return the current ant handler.
          */
         public AntHandler getCurrentAntHandler() {
             return currentHandler;
         }
 
         /**
          * Resolves file: URIs relative to the build file.
          *
          * @param publicId The public identifier, or <code>null</code>
          *                 if none is available. Ignored in this
          *                 implementation.
          * @param systemId The system identifier provided in the XML
          *                 document. Will not be <code>null</code>.
          * @return an inputsource for this identifier
          */
         public InputSource resolveEntity(String publicId, String systemId) {
 
             context.getProject().log("resolving systemId: " + systemId, Project.MSG_VERBOSE);
 
             if (systemId.startsWith("file:")) {
                 String path = FILE_UTILS.fromURI(systemId);
 
                 File file = new File(path);
                 if (!file.isAbsolute()) {
                     file = FILE_UTILS.resolveFile(context.getBuildFileParent(), path);
                     context.getProject().log(
                             "Warning: '" + systemId + "' in " + context.getBuildFile()
                                     + " should be expressed simply as '" + path.replace('\\', '/')
                                     + "' for compliance with other XML tools", Project.MSG_WARN);
                 }
                 context.getProject().log("file=" + file, Project.MSG_DEBUG);
                 try {
                     InputSource inputSource = new InputSource(new FileInputStream(file));
                     inputSource.setSystemId(FILE_UTILS.toURI(file.getAbsolutePath()));
                     return inputSource;
                 } catch (FileNotFoundException fne) {
                     context.getProject().log(file.getAbsolutePath() + " could not be found",
                             Project.MSG_WARN);
                 }
 
             }
             // use default if not file or file not found
             context.getProject().log("could not resolve systemId", Project.MSG_DEBUG);
             return null;
         }
 
         /**
          * Handles the start of a project element. A project handler is created
          * and initialised with the element name and attributes.
          *
          * @param uri The namespace uri for this element.
          * @param tag The name of the element being started.
          *            Will not be <code>null</code>.
          * @param qname The qualified name for this element.
          * @param attrs Attributes of the element being started.
          *              Will not be <code>null</code>.
          *
          * @exception org.xml.sax.SAXParseException if the tag given is not
          *                              <code>"project"</code>
          */
         public void startElement(String uri, String tag, String qname, Attributes attrs)
                 throws SAXParseException {
             AntHandler next = currentHandler.onStartChild(uri, tag, qname, attrs, context);
             antHandlers.push(currentHandler);
             currentHandler = next;
             currentHandler.onStartElement(uri, tag, qname, attrs, context);
         }
 
         /**
          * Sets the locator in the project helper for future reference.
          *
          * @param locator The locator used by the parser.
          *                Will not be <code>null</code>.
          */
         public void setDocumentLocator(Locator locator) {
             context.setLocator(locator);
         }
 
         /**
          * Handles the end of an element. Any required clean-up is performed
          * by the onEndElement() method and then the original handler is restored to the parser.
          *
          * @param uri  The namespace URI for this element.
          * @param name The name of the element which is ending.
          *             Will not be <code>null</code>.
          * @param qName The qualified name for this element.
          *
          * @exception SAXException in case of error (not thrown in this implementation)
          */
         public void endElement(String uri, String name, String qName) throws SAXException {
             currentHandler.onEndElement(uri, name, context);
             AntHandler prev = (AntHandler) antHandlers.pop();
             currentHandler = prev;
             if (currentHandler != null) {
                 currentHandler.onEndChild(uri, name, qName, context);
             }
         }
 
         /**
          * Handle text within an element, calls currentHandler.characters.
          *
          * @param buf  A character array of the test.
          * @param start The start offset in the array.
          * @param count The number of characters to read.
          * @exception SAXParseException if an error occurs
          */
         public void characters(char[] buf, int start, int count) throws SAXParseException {
             currentHandler.characters(buf, start, count, context);
         }
 
         /**
          * Start a namespace prefix to uri mapping
          *
          * @param prefix the namespace prefix
          * @param uri the namespace uri
          */
         public void startPrefixMapping(String prefix, String uri) {
             context.startPrefixMapping(prefix, uri);
         }
 
         /**
          * End a namepace prefix to uri mapping
          *
          * @param prefix the prefix that is not mapped anymore
          */
         public void endPrefixMapping(String prefix) {
             context.endPrefixMapping(prefix);
         }
     }
 
     /**
      * The main handler - it handles the &lt;project&gt; tag.
      *
      * @see org.apache.tools.ant.helper.ProjectHelper2.AntHandler
      */
     public static class MainHandler extends AntHandler {
 
         /**
          * Handle the project tag
          *
          * @param uri The namespace uri.
          * @param name The element tag.
          * @param qname The element qualified name.
          * @param attrs The attributes of the element.
          * @param context The current context.
          * @return The project handler that handles subelements of project
          * @exception SAXParseException if the qualified name is not "project".
          */
         public AntHandler onStartChild(String uri, String name, String qname, Attributes attrs,
                                        AntXMLContext context) throws SAXParseException {
             if (name.equals("project")
                 && (uri.equals("") || uri.equals(ANT_CORE_URI))) {
                 return ProjectHelper2.projectHandler;
             }
             if (name.equals(qname)) {
                 throw new SAXParseException("Unexpected element \"{" + uri
                     + "}" + name + "\" {" + ANT_CORE_URI + "}" + name, context.getLocator());
             }
             throw new SAXParseException("Unexpected element \"" + qname
                     + "\" " + name, context.getLocator());
         }
     }
 
     /**
      * Handler for the top level "project" element.
      */
     public static class ProjectHandler extends AntHandler {
 
         /**
          * Initialisation routine called after handler creation
          * with the element name and attributes. The attributes which
          * this handler can deal with are: <code>"default"</code>,
          * <code>"name"</code>, <code>"id"</code> and <code>"basedir"</code>.
          *
          * @param uri The namespace URI for this element.
          * @param tag Name of the element which caused this handler
          *            to be created. Should not be <code>null</code>.
          *            Ignored in this implementation.
          * @param qname The qualified name for this element.
          * @param attrs Attributes of the element which caused this
          *              handler to be created. Must not be <code>null</code>.
          * @param context The current context.
          *
          * @exception SAXParseException if an unexpected attribute is
          *            encountered or if the <code>"default"</code> attribute
          *            is missing.
          */
         public void onStartElement(String uri, String tag, String qname, Attributes attrs,
                                    AntXMLContext context) throws SAXParseException {
             String baseDir = null;
             boolean nameAttributeSet = false;
 
             Project project = context.getProject();
             // Set the location of the implicit target associated with the project tag
             context.getImplicitTarget().setLocation(new Location(context.getLocator()));
 
             /** XXX I really don't like this - the XML processor is still
              * too 'involved' in the processing. A better solution (IMO)
              * would be to create UE for Project and Target too, and
              * then process the tree and have Project/Target deal with
              * its attributes ( similar with Description ).
              *
              * If we eventually switch to ( or add support for ) DOM,
              * things will work smoothly - UE can be avoided almost completely
              * ( it could still be created on demand, for backward compatibility )
              */
 
             for (int i = 0; i < attrs.getLength(); i++) {
                 String attrUri = attrs.getURI(i);
                 if (attrUri != null && !attrUri.equals("") && !attrUri.equals(uri)) {
                     continue; // Ignore attributes from unknown uris
                 }
                 String key = attrs.getLocalName(i);
                 String value = attrs.getValue(i);
 
                 if (key.equals("default")) {
                     if (value != null && !value.equals("")) {
                         if (!context.isIgnoringProjectTag()) {
                             project.setDefault(value);
                         }
                     }
                 } else if (key.equals("name")) {
                     if (value != null) {
                         context.setCurrentProjectName(value);
                         nameAttributeSet = true;
                         if (!context.isIgnoringProjectTag()) {
                             project.setName(value);
                             project.addReference(value, project);
                         } else if (isInIncludeMode()) {
                             if (!"".equals(value)
                                 && (getCurrentTargetPrefix() == null
                                     || getCurrentTargetPrefix().length() == 0)
                                 ) {
                                 // help nested include tasks
                                 setCurrentTargetPrefix(value);
                             }
                         }
                     }
                 } else if (key.equals("id")) {
                     if (value != null) {
                         // What's the difference between id and name ?
                         if (!context.isIgnoringProjectTag()) {
                             project.addReference(value, project);
                         }
                     }
                 } else if (key.equals("basedir")) {
                     if (!context.isIgnoringProjectTag()) {
                         baseDir = value;
                     }
                 } else {
                     // XXX ignore attributes in a different NS ( maybe store them ? )
                     throw new SAXParseException("Unexpected attribute \"" + attrs.getQName(i)
                             + "\"", context.getLocator());
                 }
             }
 
             // XXX Move to Project ( so it is shared by all helpers )
             String antFileProp =
                 MagicNames.ANT_FILE + "." + context.getCurrentProjectName();
             String dup = project.getProperty(antFileProp);
             String typeProp =
                 MagicNames.ANT_FILE_TYPE + "." + context.getCurrentProjectName();
             String dupType = project.getProperty(typeProp);
             if (dup != null && nameAttributeSet) {
                 Object dupFile = null;
                 Object contextFile = null;
                 if (MagicNames.ANT_FILE_TYPE_URL.equals(dupType)) {
                     try {
                         dupFile = new URL(dup);
                     } catch (java.net.MalformedURLException mue) {
                         throw new BuildException("failed to parse "
                                                  + dup + " as URL while looking"
                                                  + " at a duplicate project"
                                                  + " name.", mue);
                     }
                     contextFile = context.getBuildFileURL();
                 } else {
                     dupFile = new File(dup);
                     contextFile = context.getBuildFile();
                 }
 
                 if (context.isIgnoringProjectTag() && !dupFile.equals(contextFile)) {
                     project.log("Duplicated project name in import. Project "
                             + context.getCurrentProjectName() + " defined first in " + dup
                             + " and again in " + contextFile, Project.MSG_WARN);
                 }
             }
             if (nameAttributeSet) {
                 if (context.getBuildFile() != null) {
                     project.setUserProperty(antFileProp,
                                             context.getBuildFile().toString());
                     project.setUserProperty(typeProp,
                                             MagicNames.ANT_FILE_TYPE_FILE);
                 } else if (context.getBuildFileURL() != null) {
                     project.setUserProperty(antFileProp,
                                             context.getBuildFileURL().toString());
                     project.setUserProperty(typeProp,
                                             MagicNames.ANT_FILE_TYPE_URL);
                 }
             }
             if (context.isIgnoringProjectTag()) {
                 // no further processing
                 return;
             }
             // set explicitly before starting ?
             if (project.getProperty("basedir") != null) {
                 project.setBasedir(project.getProperty("basedir"));
             } else {
                 // Default for baseDir is the location of the build file.
                 if (baseDir == null) {
                     project.setBasedir(context.getBuildFileParent().getAbsolutePath());
                 } else {
                     // check whether the user has specified an absolute path
                     if ((new File(baseDir)).isAbsolute()) {
                         project.setBasedir(baseDir);
                     } else {
                         project.setBaseDir(FILE_UTILS.resolveFile(context.getBuildFileParent(),
                                 baseDir));
                     }
                 }
             }
             project.addTarget("", context.getImplicitTarget());
             context.setCurrentTarget(context.getImplicitTarget());
         }
 
         /**
          * Handles the start of a top-level element within the project. An
          * appropriate handler is created and initialised with the details
          * of the element.
          *
          * @param uri The namespace URI for this element.
          * @param name The name of the element being started.
          *            Will not be <code>null</code>.
          * @param qname The qualified name for this element.
          * @param attrs Attributes of the element being started.
          *              Will not be <code>null</code>.
          * @param context The context for this element.
          * @return a target or an element handler.
          *
          * @exception org.xml.sax.SAXParseException if the tag given is not
          *            <code>"taskdef"</code>, <code>"typedef"</code>,
          *            <code>"property"</code>, <code>"target"</code>,
          *            <code>"extension-point"</code>
          *            or a data type definition
          */
         public AntHandler onStartChild(String uri, String name, String qname, Attributes attrs,
                                        AntXMLContext context) throws SAXParseException {
             return (name.equals("target") || name.equals("extension-point"))
                 && (uri.equals("") || uri.equals(ANT_CORE_URI))
                 ? ProjectHelper2.targetHandler : ProjectHelper2.elementHandler;
         }
     }
 
     /**
      * Handler for "target" and "extension-point" elements.
      */
     public static class TargetHandler extends AntHandler {
 
         /**
          * Initialisation routine called after handler creation
          * with the element name and attributes. The attributes which
          * this handler can deal with are: <code>"name"</code>,
          * <code>"depends"</code>, <code>"if"</code>,
          * <code>"unless"</code>, <code>"id"</code> and
          * <code>"description"</code>.
          *
          * @param uri The namespace URI for this element.
          * @param tag Name of the element which caused this handler
          *            to be created. Should not be <code>null</code>.
          *            Ignored in this implementation.
          * @param qname The qualified name for this element.
          * @param attrs Attributes of the element which caused this
          *              handler to be created. Must not be <code>null</code>.
          * @param context The current context.
          *
          * @exception SAXParseException if an unexpected attribute is encountered
          *            or if the <code>"name"</code> attribute is missing.
          */
         public void onStartElement(String uri, String tag, String qname, Attributes attrs,
                                    AntXMLContext context) throws SAXParseException {
             String name = null;
             String depends = "";
             String extensionPoint = null;
 
             Project project = context.getProject();
             Target target = "target".equals(tag)
                 ? new Target() : new ExtensionPoint();
             target.setProject(project);
             target.setLocation(new Location(context.getLocator()));
             context.addTarget(target);
 
             for (int i = 0; i < attrs.getLength(); i++) {
                 String attrUri = attrs.getURI(i);
                 if (attrUri != null && !attrUri.equals("") && !attrUri.equals(uri)) {
                     continue; // Ignore attributes from unknown uris
                 }
                 String key = attrs.getLocalName(i);
                 String value = attrs.getValue(i);
 
                 if (key.equals("name")) {
                     name = value;
                     if ("".equals(name)) {
                         throw new BuildException("name attribute must " + "not be empty");
                     }
                 } else if (key.equals("depends")) {
                     depends = value;
                 } else if (key.equals("if")) {
                     target.setIf(value);
                 } else if (key.equals("unless")) {
                     target.setUnless(value);
                 } else if (key.equals("id")) {
                     if (value != null && !value.equals("")) {
                         context.getProject().addReference(value, target);
                     }
                 } else if (key.equals("description")) {
                     target.setDescription(value);
                 } else if (key.equals("extensionOf")) {
                     extensionPoint = value;
                 } else {
                     throw new SAXParseException("Unexpected attribute \"" + key + "\"", context
                             .getLocator());
                 }
             }
 
             if (name == null) {
                 throw new SAXParseException("target element appears without a name attribute",
                         context.getLocator());
             }
 
             String prefix = null;
             boolean isInIncludeMode =
                 context.isIgnoringProjectTag() && isInIncludeMode();
             String sep = getCurrentPrefixSeparator();
 
             if (isInIncludeMode) {
                 prefix = getTargetPrefix(context);
                 if (prefix == null) {
                     throw new BuildException("can't include build file "
                                              + context.getBuildFileURL()
                                              + ", no as attribute has been given"
                                              + " and the project tag doesn't"
                                              + " specify a name attribute");
                 }
                 name = prefix + sep + name;
             }
 
             // Check if this target is in the current build file
             if (context.getCurrentTargets().get(name) != null) {
                 throw new BuildException("Duplicate target '" + name + "'",
                                          target.getLocation());
             }
             Hashtable projectTargets = project.getTargets();
             boolean   usedTarget = false;
             // If the name has not already been defined define it
             if (projectTargets.containsKey(name)) {
                 project.log("Already defined in main or a previous import, ignore " + name,
                         Project.MSG_VERBOSE);
             } else {
                 target.setName(name);
                 context.getCurrentTargets().put(name, target);
                 project.addOrReplaceTarget(name, target);
                 usedTarget = true;
             }
 
             if (depends.length() > 0) {
                 if (!isInIncludeMode) {
                     target.setDepends(depends);
                 } else {
                     for (Iterator iter =
                              Target.parseDepends(depends, name, "depends")
                              .iterator();
                          iter.hasNext(); ) {
                         target.addDependency(prefix + sep + iter.next());
                     }
                 }
             }
             if (!isInIncludeMode && context.isIgnoringProjectTag()
                 && (prefix = getTargetPrefix(context)) != null) {
                 // In an imported file (and not completely
                 // ignoring the project tag or having a preconfigured prefix)
                 String newName = prefix + sep + name;
                 Target newTarget = usedTarget ? new Target(target) : target;
                 newTarget.setName(newName);
                 context.getCurrentTargets().put(newName, newTarget);
                 project.addOrReplaceTarget(newName, newTarget);
             }
             if (extensionPoint != null) {
+                ProjectHelper helper =
+                    (ProjectHelper) context.getProject().
+                        getReference(ProjectHelper.PROJECTHELPER_REFERENCE);
                 for (Iterator iter =
                          Target.parseDepends(extensionPoint, name, "extensionOf")
                          .iterator();
                      iter.hasNext(); ) {
                     String tgName = (String) iter.next();
                     if (isInIncludeMode()) {
                         tgName = prefix + sep + tgName;
                     }
-                    if (!projectTargets.containsKey(tgName)) {
-                        throw new BuildException("can't add target "
-                                                 + name + " to extension-point "
-                                                 + tgName
-                                                 + " because the extension-point"
-                                                 + " is unknown.");
-                    }
-                    Target t = (Target) projectTargets.get(tgName);
-                    if (!(t instanceof ExtensionPoint)) {
-                        throw new BuildException("referenced target "
-                                                 + tgName
-                                                 + " is not an extension-point");
-                    }
-                    t.addDependency(name);
+
+                    // defer extensionpoint resolution until the full
+                    // import stack has been processed
+                    helper.getExtensionStack().add(new String[] {
+                            tgName, name
+                        });
                 }
             }
         }
 
         private String getTargetPrefix(AntXMLContext context) {
             String configuredValue = getCurrentTargetPrefix();
             if (configuredValue != null && configuredValue.length() == 0) {
                 configuredValue = null;
             }
             if (configuredValue != null) {
                 return configuredValue;
             }
 
             String projectName = context.getCurrentProjectName();
             if ("".equals(projectName)) {
                 projectName = null;
             }
 
             return projectName;
         }
 
         /**
          * Handles the start of an element within a target.
          *
          * @param uri The namespace URI for this element.
          * @param name The name of the element being started.
          *            Will not be <code>null</code>.
          * @param qname The qualified name for this element.
          * @param attrs Attributes of the element being started.
          *              Will not be <code>null</code>.
          * @param context The current context.
          * @return an element handler.
          *
          * @exception SAXParseException if an error occurs when initialising
          *                              the appropriate child handler
          */
         public AntHandler onStartChild(String uri, String name, String qname, Attributes attrs,
                                        AntXMLContext context) throws SAXParseException {
             return ProjectHelper2.elementHandler;
         }
 
         /**
          * Handle the end of the project, sets the current target of the
          * context to be the implicit target.
          *
          * @param uri The namespace URI of the element.
          * @param tag The name of the element.
          * @param context The current context.
          */
         public void onEndElement(String uri, String tag, AntXMLContext context) {
             context.setCurrentTarget(context.getImplicitTarget());
         }
     }
 
     /**
      * Handler for all project elements ( tasks, data types )
      */
     public static class ElementHandler extends AntHandler {
 
         /**
          * Constructor.
          */
         public ElementHandler() {
         }
 
         /**
          * Initialisation routine called after handler creation
          * with the element name and attributes. This configures
          * the element with its attributes and sets it up with
          * its parent container (if any). Nested elements are then
          * added later as the parser encounters them.
          *
          * @param uri The namespace URI for this element.
          * @param tag Name of the element which caused this handler
          *            to be created. Must not be <code>null</code>.
          * @param qname The qualified name for this element.
          * @param attrs Attributes of the element which caused this
          *              handler to be created. Must not be <code>null</code>.
          * @param context The current context.
          *
          * @exception SAXParseException in case of error (not thrown in
          *                              this implementation)
          */
         public void onStartElement(String uri, String tag, String qname, Attributes attrs,
                                    AntXMLContext context) throws SAXParseException {
             RuntimeConfigurable parentWrapper = context.currentWrapper();
             Object parent = null;
 
             if (parentWrapper != null) {
                 parent = parentWrapper.getProxy();
             }
 
             /* UnknownElement is used for tasks and data types - with
                delayed eval */
             UnknownElement task = new UnknownElement(tag);
             task.setProject(context.getProject());
             task.setNamespace(uri);
             task.setQName(qname);
             task.setTaskType(ProjectHelper.genComponentName(task.getNamespace(), tag));
             task.setTaskName(qname);
 
             Location location = new Location(context.getLocator().getSystemId(), context
                     .getLocator().getLineNumber(), context.getLocator().getColumnNumber());
             task.setLocation(location);
             task.setOwningTarget(context.getCurrentTarget());
 
             if (parent != null) {
                 // Nested element
                 ((UnknownElement) parent).addChild(task);
             }  else {
                 // Task included in a target ( including the default one ).
                 context.getCurrentTarget().addTask(task);
             }
 
             context.configureId(task, attrs);
 
             // container.addTask(task);
             // This is a nop in UE: task.init();
 
             RuntimeConfigurable wrapper = new RuntimeConfigurable(task, task.getTaskName());
 
             for (int i = 0; i < attrs.getLength(); i++) {
                 String name = attrs.getLocalName(i);
                 String attrUri = attrs.getURI(i);
                 if (attrUri != null && !attrUri.equals("") && !attrUri.equals(uri)) {
                     name = attrUri + ":" + attrs.getQName(i);
                 }
                 String value = attrs.getValue(i);
                 // PR: Hack for ant-type value
                 //  an ant-type is a component name which can
                 // be namespaced, need to extract the name
                 // and convert from qualified name to uri/name
                 if (ANT_TYPE.equals(name)
                         || (ANT_CORE_URI.equals(attrUri)
                             && ANT_TYPE.equals(attrs.getLocalName(i)))) {
                     name = ANT_TYPE;
                     int index = value.indexOf(":");
                     if (index >= 0) {
                         String prefix = value.substring(0, index);
                         String mappedUri = context.getPrefixMapping(prefix);
                         if (mappedUri == null) {
                             throw new BuildException("Unable to find XML NS prefix \"" + prefix
                                     + "\"");
                         }
                         value = ProjectHelper.genComponentName(mappedUri, value
                                 .substring(index + 1));
                     }
                 }
                 wrapper.setAttribute(name, value);
             }
             if (parentWrapper != null) {
                 parentWrapper.addChild(wrapper);
             }
             context.pushWrapper(wrapper);
         }
 
         /**
          * Adds text to the task, using the wrapper
          *
          * @param buf A character array of the text within the element.
          *            Will not be <code>null</code>.
          * @param start The start element in the array.
          * @param count The number of characters to read from the array.
          * @param context The current context.
          *
          * @exception SAXParseException if the element doesn't support text
          *
          * @see ProjectHelper#addText(Project,java.lang.Object,char[],int,int)
          */
         public void characters(char[] buf, int start, int count,
                                AntXMLContext context) throws SAXParseException {
             RuntimeConfigurable wrapper = context.currentWrapper();
             wrapper.addText(buf, start, count);
         }
 
         /**
          * Handles the start of an element within a target. Task containers
          * will always use another task handler, and all other tasks
          * will always use a nested element handler.
          *
          * @param uri The namespace URI for this element.
          * @param tag The name of the element being started.
          *            Will not be <code>null</code>.
          * @param qname The qualified name for this element.
          * @param attrs Attributes of the element being started.
          *              Will not be <code>null</code>.
          * @param context The current context.
          * @return The handler for elements.
          *
          * @exception SAXParseException if an error occurs when initialising
          *                              the appropriate child handler
          */
         public AntHandler onStartChild(String uri, String tag, String qname, Attributes attrs,
                                        AntXMLContext context) throws SAXParseException {
             return ProjectHelper2.elementHandler;
         }
 
         /**
          * Handles the end of the element. This pops the wrapper from
          * the context.
          *
          * @param uri The namespace URI for the element.
          * @param tag The name of the element.
          * @param context The current context.
          */
         public void onEndElement(String uri, String tag, AntXMLContext context) {
             context.popWrapper();
         }
     }
 }
diff --git a/src/tests/antunit/core/extension-point-test.xml b/src/tests/antunit/core/extension-point-test.xml
index 012375c09..810ad33aa 100644
--- a/src/tests/antunit/core/extension-point-test.xml
+++ b/src/tests/antunit/core/extension-point-test.xml
@@ -1,86 +1,91 @@
 <?xml version="1.0"?>
 <!--
   Licensed to the Apache Software Foundation (ASF) under one or more
   contributor license agreements.  See the NOTICE file distributed with
   this work for additional information regarding copyright ownership.
   The ASF licenses this file to You under the Apache License, Version 2.0
   (the "License"); you may not use this file except in compliance with
   the License.  You may obtain a copy of the License at
 
       http://www.apache.org/licenses/LICENSE-2.0
 
   Unless required by applicable law or agreed to in writing, software
   distributed under the License is distributed on an "AS IS" BASIS,
   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   See the License for the specific language governing permissions and
   limitations under the License.
 -->
 <project xmlns:au="antlib:org.apache.ant.antunit" default="antunit">
 
   <import file="../antunit-base.xml"/>
 
   <extension-point name="testExtensionPointWorksLikeTarget"
                 depends="setProperty, assertProperty"/>
 
   <target name="setProperty">
     <property name="foo" value="bar"/>
   </target>
 
   <target name="assertProperty">
     <au:assertPropertyEquals name="foo" value="bar"/>
   </target>
 
   <target name="testExtensionPointMustBeEmpty">
     <mkdir dir="${output}"/>
     <echo file="${output}/build.xml"><![CDATA[
 <project>
   <extension-point name="foo">
     <echo>bar</echo>
   </extension-point>
 </project>]]></echo>
     <au:expectfailure
        expectedMessage="you must not nest child elements into an extension-point">
       <ant dir="${output}"/>
     </au:expectfailure>
   </target>
 
   <target name="testAddToExtensionPoint">
     <mkdir dir="${output}"/>
     <echo file="${output}/build.xml"><![CDATA[
 <project default="foo">
   <extension-point name="foo"/>
   <target name="bar" extensionOf="foo">
     <echo>In target bar</echo>
   </target>
 </project>]]></echo>
     <ant dir="${output}"/>
     <au:assertLogContains text="In target bar"/>
   </target>
 
-  <target name="testExtensionPointMustBeKnown">
+  <target name="testCantAddToPlainTarget">
     <mkdir dir="${output}"/>
     <echo file="${output}/build.xml"><![CDATA[
 <project default="foo">
-  <extension-point name="bar" extensionOf="foo"/>
-  <extension-point name="foo"/>
+  <target name="foo"/>
+  <target name="bar" extensionOf="foo"/>
 </project>]]></echo>
     <au:expectfailure
-       expectedMessage="can't add target bar to extension-point foo because the extension-point is unknown">
+       expectedMessage="referenced target foo is not an extension-point">
       <ant dir="${output}"/>
     </au:expectfailure>
   </target>
 
-  <target name="testCantAddToPlainTarget">
+  <target name="testExtensionPointInImportedBuildfile" description="Bug 48804">
     <mkdir dir="${output}"/>
+    <echo file="${output}/master.xml"><![CDATA[
+<project default="bar">
+  <extension-point name="foo"/>
+  <target name="bar" depends="foo"/>
+</project>]]></echo>
     <echo file="${output}/build.xml"><![CDATA[
-<project default="foo">
-  <target name="foo"/>
-  <target name="bar" extensionOf="foo"/>
+<project>
+  <import file="master.xml"/>
+  <target name="prepare" extensionOf="foo">
+    <echo>in target prepare</echo>
+  </target>
 </project>]]></echo>
-    <au:expectfailure
-       expectedMessage="referenced target foo is not an extension-point">
-      <ant dir="${output}"/>
-    </au:expectfailure>
+    <ant dir="${output}" target="bar"/>
+    <au:assertLogContains text="in target prepare"/>
   </target>
 
 </project>
diff --git a/xdocs/faq.xml b/xdocs/faq.xml
index 090ab8f41..7a598cf7b 100644
--- a/xdocs/faq.xml
+++ b/xdocs/faq.xml
@@ -915,1003 +915,1051 @@ shell-prompt> m4 foo.m4 > foo
     </faq>
 
     <faq id="include-order">
       <question>In my <code>&lt;fileset&gt;</code>, I&apos;ve put in an
       <code>&lt;exclude&gt;</code> of all files followed by an
       <code>&lt;include&gt;</code> of just the files I want, but it
       isn&apos;t giving me any files at all. What&apos;s wrong?
       </question>
 
       <answer>
         <p>The order of the <code>&lt;include&gt;</code> and
         <code>&lt;exclude&gt;</code> tags within a <code>&lt;fileset&gt;</code>
         is ignored when the FileSet is created. Instead, all of the
         <code>&lt;include&gt;</code> elements are processed together,
         followed by all of the <code>&lt;exclude&gt;</code>
         elements. This means that the <code>&lt;exclude&gt;</code>
         elements only apply to the file list produced by the
         <code>&lt;include&gt;</code> elements.</p>
 
         <p>To get the files you want, focus on just the
         <code>&lt;include&gt;</code> patterns that would be necessary
         to get them. If you find you need to trim the list that the
         <code>&lt;include&gt;</code> elements produce, then use
         <code>&lt;exclude&gt;</code> elements.</p>
       </answer>
     </faq>
 
     <faq id="properties-not-trimmed">
       <question><code>ant</code> failed to build my program via javac
       even when I put the needed jars in an external
       <code>build.properties</code> file and reference them by
       <code>pathelement</code> or <code>classpath refid</code>.</question>
 
       <answer>
 
         <p>When <code>ant</code> loads properties from an external
         file it doesn&apos;t touch the value of properties, trailing blanks
         will not be trimmed for example.</p>
 
         <p>If the value represents a file path, like a jar needed to
         compile, the task which requires the value, javac for example
         would fail to compile since it can&apos;t find the file due to
         trailing spaces.</p>
       </answer>
     </faq>
 
     <faq id="winzip-lies">
       <question>Ant creates WAR files with a lower-case
         <code>web-inf</code> or JAR files with a lower-case
         <code>meta-inf</code> directory.</question>
 
       <answer>
         <p>No it doesn&apos;t.</p>
 
         <p>You may have seen these lower-case directory names in
         WinZIP, but WinZIP is trying to be helpful (and fails).  If
         WinZIP encounters a filename that is all upper-case, it
         assumes it has come from an old DOS box and changes the case to
         all lower-case for you.</p>
 
         <p>If you extract (or just check) the archive with jar, you
         will see that the names have the correct case.</p>
 
         <p>With WinZIP (version 8.1 at least), this can be corrected in the
         configuration.  In the Options/Configuration menu, in the View tab, General
         section, check the "Allow all upper case files names" box.  The META-INF and
         WEB-INF will look correct.</p>
       </answer>
     </faq>
 
     <faq id="NoClassDefFoundError">
       <question>I installed Ant 1.6.x and now get
         <code>Exception in thread "main" java.lang.NoClassDefFoundError:
         </code>
       </question>
       <answer>
         <p>
           The cause of this is that there is an old version of ant somewhere in the
           class path or configuration.
         </p>
         <p>
           A version of this problem happens with jars that are in the classpath
           that include an embedded copy of ant classes.
           An example of this is some copies of weblogic.jar.
         </p>
         <p>
         One can check if this is the case by doing (on unix/sh):
         <code><pre>
         unset CLASSPATH
         ant -version
         </pre>
         </code>
         </p>
       </answer>
     </faq>
 
     <faq id="InstantiationException">
       <question>I installed Ant 1.6.x and now get
         <code>java.lang.InstantiationException: org.apache.tools.ant.Main</code>
       </question>
       <answer>
         <p>
           The cause of this is that there is an old version of ant somewhere in the
           class path or configuration.
         </p>
         <p>
           A version of this problem may be seen on some linux systems.
           Some linux systems (Fedora Core 2 for example), comes with a version
           of ant pre-installed. There is a configuration file called
           <code>/etc/ant.conf</code> which if present, the ant shell
           script will 'dot' include. On Fedora Core 2, the /etc/ant.conf
           file resets the <code>ANT_HOME</code> environment variable to
           <code>/usr/share/ant</code>. This causes the problem that
           an old version of ant (1.5.x in this cause) will be used
           with a new version of the ant script file.
         </p>
         <p>
           One can check if this is the case by doing
           <code>ant --noconfig -version</code>.
         </p>
       </answer>
     </faq>
     <faq id="mangled-manifest">
       <question>
         Whenever I use the Ant jar or manifest related tasks, long lines in
         my manifest are wrapped at 70 characters and the resulting jar does
         not work in my application server. Why does Ant do this?
       </question>
 
       <answer>
         <p>
           Ant implements the Java
           <a href="http://java.sun.com/j2se/1.4.2/docs/guide/jar/jar.html">Jar
           file specification</a>. Please refer to the notes section where it
           discusses the maximum allowable length of a line and the concept of
           continuation characters.
         </p>
 
         <p>
           If a jar file produced by Ant does not work in your appserver, and
           that failure is due to the wrapped manifest, then you need
           to consult your appserver provider, as it is a bug in their
           appserver. Far more likely, however, is a problem in your
           specification of your classpath. It is not Ant's wrapping of your
           classpath that is the problem.
         </p>
 
         <p>
           Do not raise a bug about this issue until you have checked to ensure
           that the problem is not due to your classpath specification.
         </p>
       </answer>
     </faq>
 
     <faq id="CreateProcess_error_2">
       <question><code>&lt;exec&gt;</code> fails with <code>"Cannot run
           program "...":CreateProcess error=2"</code> on
         Windows.</question>
       <answer>
 
         <p>A common problem is not having the executable on the
           PATH. In case you get an error message <code>Cannot run
           program "...":CreateProcess error=2. The system cannot find
             the path specified.</code> have a look at your PATH
           variable.</p>
 
         <p>Just type the command directly on the command line and if
           Windows finds it, Ant should do it too. (Otherwise ask on
           the user mailinglist for help.) If Windows can not execute
           the program add the directory of the programm to the PATH
           (<code>set PATH=%PATH%;dirOfProgram</code>) or specify the
           absolute path in the <code>executable</code> attribute in
           your buildfile.</p>
       </answer>
     </faq>
   </faqsection>
 
   <faqsection title="Ant and IDEs/Editors">
     <faq id="integration">
       <question>Is Ant supported by my IDE/Editor?</question>
       <answer>
         <p>See the <a href="external.html#IDE and Editor Integration">section
         on IDE integration</a> on our External Tools and Tasks page.</p>
       </answer>
     </faq>
 
     <faq id="emacs-mode">
       <question>Why doesn&apos;t (X)Emacs/vi/MacOS X&apos;s project builder
       correctly parse the error messages generated by Ant?</question>
       <answer>
 
         <p>Ant adds a &quot;banner&quot; with the name of the current
         task in front of all logging messages - and there are no built-in
         regular expressions in your editor that would account for
         this.</p>
 
         <p>You can disable this banner by invoking Ant with the
         <code>-emacs</code> switch.  To make Ant autodetect
         Emacs&apos; compile mode, put this into your
         <code>.antrc</code> (contributed by Ville Skytt&#228;).</p>
 
         <source><![CDATA[
 # Detect (X)Emacs compile mode
 if [ "$EMACS" = "t" ] ; then
   ANT_ARGS="$ANT_ARGS -emacs"
   ANT_OPTS="$ANT_OPTS -Dbuild.compiler.emacs=true"
 fi
 ]]></source>
 
         <p>Alternatively, you can add the following snippet to your
         <code>.emacs</code> to make Emacs understand Ant&apos;s
         output.</p>
 
         <source><![CDATA[
 (require 'compile)
 (setq compilation-error-regexp-alist
   (append (list
      ;; works for jikes
      '("^\\s-*\\[[^]]*\\]\\s-*\\(.+\\):\\([0-9]+\\):\\([0-9]+\\):[0-9]+:[0-9]+:" 1 2 3)
      ;; works for javac
      '("^\\s-*\\[[^]]*\\]\\s-*\\(.+\\):\\([0-9]+\\):" 1 2))
   compilation-error-regexp-alist))
 ]]></source>
 
         <p>Yet another alternative that preserves most of Ant&apos;s
         formatting is to pipe Ant&apos;s output through the following Perl
         script by Dirk-Willem van Gulik:</p>
 
         <source><![CDATA[
 #!/usr/bin/perl
 #
 # May 2001 dirkx@apache.org - remove any
 # [foo] lines from the output; keeping
 # spacing more or less there.
 #
 $|=1;
 while(<STDIN>) {
         if (s/^(\s+)\[(\w+)\]//) {
                 if ($2 ne $last) {
                         print "$1\[$2\]";
                         $s = ' ' x length($2);
                 } else {
                         print "$1 $s ";
                 };
                 $last = $2;
         };
         print;
 };
 ]]></source>
 
       </answer>
     </faq>
   </faqsection>
 
   <faqsection title="Advanced Issues">
     <faq id="dtd">
       <question>Is there a DTD that I can use to validate my build
       files?</question>
 
       <answer>
 
         <p>An incomplete DTD can be created by the
           <code>&lt;antstructure&gt;</code> task - but this one
           has a few problems:</p>
 
           <ul>
             <li>It doesn&apos;t know about required attributes.  Only
             manual tweaking of this file can help here.</li>
 
             <li>It is not complete - if you add new tasks via
             <code>&lt;taskdef&gt;</code> it won&apos;t know about it.  See
             <a href="http://www.sdv.fr/pages/casa/html/ant-dtd.en.html">this
             page</a> by Michel Casabianca for a solution to this
             problem.  Note that the DTD you can download at this page
             is based on Ant 0.3.1.</li>
 
             <li>It may even be an invalid DTD.  As Ant allows tasks
             writers to define arbitrary elements, name collisions will
             happen quite frequently - if your version of Ant contains
             the optional <code>&lt;test&gt;</code> and
             <code>&lt;junit&gt;</code> tasks, there are two XML
             elements named <code>test</code> (the task and the nested child
             element of <code>&lt;junit&gt;</code>) with different attribute
             lists.  This problem cannot be solved; DTDs don&apos;t give a
             syntax rich enough to support this.</li>
           </ul>
       </answer>
     </faq>
 
     <faq id="xml-entity-include">
       <question>How do I include an XML snippet in my build file?</question>
       <answer>
         <p>You can use XML&apos;s way of including external files and let
         the parser do the job for Ant:</p>
 
         <source><![CDATA[
 <?xml version="1.0"?>
 
 <!DOCTYPE project [
        <!ENTITY common SYSTEM "common.xml">
 ]>
 
 <project name="test" default="test" basedir=".">
 
   <target name="setup">
     ...
   </target>
 
   &common;
 
   ...
 
 </project>
 ]]></source>
 
         <p>will literally include the contents of <code>common.xml</code> where
         you&apos;ve placed the <code>&amp;common;</code> entity.</p>
 
         <p>(The filename <code>common.xml</code> in this example is resolved
         relative to the containing XML file by the XML parser. You may also use
         an absolute <code>file:</code> protocol URI.)</p>
 
         <p>In combination with a DTD, this would look like this:</p>
 
         <source><![CDATA[
 <!DOCTYPE project PUBLIC "-//ANT//DTD project//EN" "ant.dtd" [
    <!ENTITY include SYSTEM "header.xml">
 ]>
 ]]></source>
 
         <p>Starting with Ant 1.6, there is a new
         <code>&lt;import&gt;</code> task that can (also) be used to
         include build file fragments.  Unlike the snippets used with
         entity includes, the referenced files have to be complete Ant
         build files, though.</p>
 
         <p>The example above would become:</p>
         <source><![CDATA[
 <?xml version="1.0"?>
 <project name="test" default="test" basedir=".">
 
   <target name="setup">
     ...
   </target>
 
   <import file="./common.xml"/>
 
   ...
 
 </project>
 ]]></source>
 
         <p>Unlike entity includes, <code>&lt;import&gt;</code> will
         let you use Ant properties in the file name.</p>
       </answer>
     </faq>
 
     <faq id="mail-logger">
       <question>How do I send an email with the result of my build
         process?</question>
 
       <answer>
 
         <p>If you are using a nightly build of Ant 1.5 after
         2001-12-14, you can use the built-in MailLogger:</p>
 
         <source><![CDATA[
          ant -logger org.apache.tools.ant.listener.MailLogger
 ]]></source>
 
         <p>See the <a href="http://svn.apache.org/repos/asf/ant/core/trunk/docs/manual/listeners.html">Listeners
         &amp; Loggers</a> documentation for details on the properties
         required.</p>
 
         <p>For older versions of Ant, you can use a custom
         BuildListener that sends out an email
         in the buildFinished() method.  Will Glozer
         &lt;will.glozer@jda.com&gt; has written such a listener based
         on <a href="http://java.sun.com/products/javamail/">JavaMail</a>.
         The source is:</p>
 
         <source><![CDATA[
 import java.io.*;
 import java.util.*;
 import javax.mail.*;
 import javax.mail.internet.*;
 import org.apache.tools.ant.*;
 
 /**
  * A simple listener that waits for a build to finish and sends an email
  * of the results.  The settings are stored in "monitor.properties" and
  * are fairly self explanatory.
  *
  * @author      Will Glozer
  * @version     1.05a 09/06/2000
  */
 public class BuildMonitor implements BuildListener {
     protected Properties props;
 
     /**
      * Create a new BuildMonitor.
      */
     public BuildMonitor() throws Exception {
         props = new Properties();
         InputStream is = getClass().getResourceAsStream("monitor.properties");
         props.load(is);
         is.close();
     }
 
     public void buildStarted(BuildEvent e) {
     }
 
     /**
      * Determine the status of the build and the actions to follow, now that
      * the build has completed.
      *
      * @param       e       Event describing the build status.
      */
     public void buildFinished(BuildEvent e) {
         Throwable th = e.getException();
         String status = (th != null) ? "failed" : "succeeded";
 
         try {
             String key = "build." + status;
             if (props.getProperty(key + ".notify").equalsIgnoreCase("false")) {
                     return;
             }
 
             Session session = Session.getDefaultInstance(props, null);
 
             MimeMessage message = new MimeMessage(session);
             message.addRecipients(Message.RecipientType.TO, parseAddresses(
                 props.getProperty(key + ".email.to")));
             message.setSubject(props.getProperty(key + ".email.subject"));
 
             BufferedReader br = new BufferedReader(new FileReader(
                 props.getProperty("build.log")));
             StringWriter sw = new StringWriter();
 
             String line = br.readLine();
             while (line != null) {
                 sw.write(line);
                 sw.write("\n");
                 line = br.readLine();
             }
             br.close();
 
             message.setText(sw.toString(), "UTF-8");
             sw.close();
 
             Transport transport = session.getTransport();
             transport.connect();
             transport.send(message);
             transport.close();
         } catch (Exception ex) {
             System.out.println("BuildMonitor failed to send email!");
             ex.printStackTrace();
         }
     }
 
     /**
      * Parse a comma separated list of internet email addresses.
      *
      * @param       s       The list of addresses.
      * @return      Array of Addresses.
      */
     protected Address[] parseAddresses(String s) throws Exception {
         StringTokenizer st = new StringTokenizer(s, ",");
         Address[] addrs = new Address[st.countTokens()];
 
         for (int i = 0; i < addrs.length; i++) {
             addrs[i] = new InternetAddress(st.nextToken());
         }
         return addrs;
     }
 
     public void messageLogged(BuildEvent e) {
     }
 
     public void targetStarted(BuildEvent e) {
     }
 
     public void targetFinished(BuildEvent e) {
     }
 
     public void taskStarted(BuildEvent e) {
     }
 
     public void taskFinished(BuildEvent e) {
     }
 }
 ]]></source>
 
       <p>With a <code>monitor.properties</code> like this:</p>
 
         <source><![CDATA[
 # configuration for build monitor
 
 mail.transport.protocol=smtp
 mail.smtp.host=<host>
 mail.from=Will Glozer <will.glozer@jda.com>
 
 build.log=build.log
 
 build.failed.notify=true
 build.failed.email.to=will.glozer@jda.com
 build.failed.email.subject=Nightly build failed!
 
 build.succeeded.notify=true
 build.succeeded.email.to=will.glozer@jda.com
 build.succeeded.email.subject=Nightly build succeeded!
 ]]></source>
 
         <p><code>monitor.properties</code> should be placed right next
         to your compiled <code>BuildMonitor.class</code>.  To use it,
         invoke Ant like:</p>
 
         <source><![CDATA[
 ant -listener BuildMonitor -logfile build.log
 ]]></source>
 
         <p>Make sure that <code>mail.jar</code> from JavaMail and
         <code>activation.jar</code> from the
         <a href="http://java.sun.com/products/javabeans/glasgow/jaf.html">Java
         Beans Activation Framework</a> are in your <code>CLASSPATH</code>.</p>
 
       </answer>
     </faq>
 
     <faq id="listener-properties">
       <question>How do I get at the properties that Ant was running
       with from inside BuildListener?</question>
 
       <answer>
         <p>You can get at a hashtable with all the properties that Ant
         has been using through the BuildEvent parameter. For
         example:</p>
 
         <source><![CDATA[
 public void buildFinished(BuildEvent e) {
     Hashtable table = e.getProject().getProperties();
     String buildpath = (String)table.get("build.path");
     ...
 }
 ]]></source>
 
         <p>This is more accurate than just reading the same property
         files that your project does, since it will give the correct
         results for properties that were specified on the Ant command line.</p>
       </answer>
     </faq>
 
   </faqsection>
 
   <faqsection title="Known Problems">
     <faq id="input-makes-exec-hang">
       <question><code>&lt;exec&gt;</code> causes other tasks to hang
         or leads to strange behaviour of <code>&lt;input&gt;</code>
         tasks.</question>
 
       <answer>
 
         <p>When Ant forks a new process for example by using the
           <code>&lt;exec&gt;</code>, <code>&lt;apply&gt;</code>
           or <code>&lt;java&gt;</code> tasks, it will also start a
           new thread reading from standard input and sending
           everything that it has read to that process.</p>
 
         <p>Unfortunately Ant has no way to know whether the forked
           process is ever going to read any input, so it will start such
           a thread even if the process doesn't need one.</p>
 
         <p>This behaviour leads to strange side effects like the Ant
           process
           being <a href="https://issues.apache.org/bugzilla/show_bug.cgi?id=34461">suspended
           when a build forking new process is run as a background
           process</a> on Unix-like systems or
           <code>&lt;input&gt;</code>
           tasks <a href="https://issues.apache.org/bugzilla/show_bug.cgi?id=41024">requiring
           additional inputs</a> if they come after
           an <code>&lt;exec&gt;</code> task.</p>
 
         <p>Fortunately there is a workaround for this, always specify
           <code>inputstring=""</code> for
           any <code>&lt;exec&gt;</code> task (or one of its sibblings)
           if you know the forked process doesn't consume any
           input.</p>
       </answer>
     </faq>
 
     <faq id="javac-stackoverflow">
       <question><code>&lt;javac&gt;</code> causes a
         StackOverflowError</question>
 
       <answer>
 
         <p>For some Java source files it is possible
           that <a href="https://issues.apache.org/bugzilla/show_bug.cgi?id=45370">causes
           a StackOverlowError</a> is thrown inside Sun's javac
           compiler.  As far as we can tell this is not triggered by a
           bug in Ant.</p>
 
         <p>It is possible to work around this problem by setting 
           <code>&lt;javac&gt;</code>'s fork attribute to true.</p>
       </answer>
     </faq>
 
     <faq id="170-requires-junit">
       <question>Ant 1.7.0 doesn't build from sources without
         JUnit</question>
 
       <answer>
 
         <p>When building Ant 1.7.0 from the source release without
         junit.jar the build fails with the message "We cannot build
         the test jar unless JUnit is present".</p>
 
         <p>With Ant 1.7.0 we've started to add ant-testutil.jar as
         part of the distribution and this causes a hard dependency on
         JUnit - at least in version 1.7.0.  Unfortunately the
         installation docs don't say so.</p>
 
         <p>There are two workarounds:</p>
 
         <ol>
 
           <li>Add junit.jar to your CLASSPATH when building Ant.</li>
 
           <li>Change Ant's buildfile and remove test-jar from the
           depends list of the dist-lite target.</li>
 
         </ol>
 
       </answer>
     </faq>
 
     <faq id="remove-cr">
       <question>&lt;chmod&gt; or &lt;exec&gt; doesn&apos;t work in Ant
         1.3 on Unix</question>
       <answer>
 
         <p>The <code>antRun</code> script in <code>ANT_HOME/bin</code>
         has DOS instead of Unix line endings; you must remove the
         carriage-return characters from this file.  This can be done by
         using Ant&apos;s <code>&lt;fixcrlf&gt;</code> task
         or something like:</p>
 
         <source><![CDATA[
 tr -d '\r' < $ANT_HOME/bin/antRun > /tmp/foo
 mv /tmp/foo $ANT_HOME/bin/antRun
 ]]></source>
       </answer>
     </faq>
 
     <faq id="delegating-classloader">
       <question>&lt;style&gt; or &lt;junit&gt; ignores my
       &lt;classpath&gt;</question>
 
       <answer>
         <p>Starting with Ant 1.7.0, &lt;junit&gt; will honor your
         nested &lt;classpath&gt;.</p>
 
         <p>These tasks don&apos;t ignore your classpath setting, you
         are facing a common problem with delegating classloaders.</p>
 
         <p>This question collects a common type of problem: A task
         needs an external library and it has a nested classpath
         element so that you can point it to this external library, but
         that doesn&apos;t work unless you put the external library
         into the <code>CLASSPATH</code> or place it in
         <code>ANT_HOME/lib</code>.</p>
 
         <p>Some background is necessary before we can discuss
         solutions for <a href="#delegating-classloader-1.5">Ant
         1.5.x</a> and <a href="#delegating-classloader-1.6">Ant
         1.6.x</a>.</p>
 
         <p>When you specify a nested <code>&lt;classpath&gt;</code> in
         Ant, Ant creates a new class loader that uses the path you
         have specified.  It then tries to load additional classes from
         this classloader.</p>
 
         <p>In most cases - for example using &lt;style&gt; or
         &lt;junit&gt; - Ant doesn&apos;t load the external library
         directly, it is the loaded class that does so.</p>
 
         <p>In the case of <code>&lt;junit&gt;</code> it is the task
         implementation itself and in the case of
         <code>&lt;style&gt;</code> it is the implementation of the
         <code>org.apache.tools.ant.taskdefs.XSLTLiaison</code>
         class.</p>
 
         <p><em>As of Ant 1.7</em> <code>&lt;junit&gt;</code> no longer
         requires you to have <code>junit.jar</code> in Ant's startup
         classpath even if <code>ant-junit.jar</code> is present there.</p>
 
         <p>Ant&apos;s class loader implementation uses Java&apos;s
         delegation model, see <a
         href="http://java.sun.com/products/jdk/1.2/docs/api/java/lang/ClassLoader.html">http://java.sun.com/products/jdk/1.2/docs/api/java/lang/ClassLoader.html</a>
         the paragraph</p>
 
         <blockquote>The <code>ClassLoader</code> class uses a
         delegation model to search for classes and resources. Each
         instance of <code>ClassLoader</code> has an associated parent
         class loader.  When called upon to find a class or resource, a
         <code>ClassLoader</code> instance will delegate the search for
         the class or resource to its parent class loader before
         attempting to find the class or resource itself. The virtual
         machine&apos;s built-in class loader, called the bootstrap
         class loader, does not itself have a parent but may serve as
         the parent of a <code>ClassLoader</code>
         instance.</blockquote>
 
         <p>The possible solutions depend on the version of Ant you
         use, see the next sections.</p>
       </answer>
     </faq>
 
     <faq id="delegating-classloader-1.5">
       <question>&lt;style&gt; or &lt;junit&gt; ignores my
       &lt;classpath&gt; - Ant 1.5.x version</question>
 
       <answer>
 
         <p>Please read <a href="#delegating-classloader">the previous
         entry</a> before you go ahead.</p>
 
         <p>First of all let&apos;s state that Ant's wrapper script
         (<code>ant</code> or <code>ant.bat</code>) adds all
         <code>.jar</code> files from <code>ANT_HOME/lib</code> to
         <code>CLASSPATH</code>, therefore &quot;in
         <code>CLASSPATH</code>&quot; shall mean &quot;either in your
         <code>CLASSPATH</code> environment variable or
         <code>ANT_HOME/lib</code>&quot; for the rest of this
         answer.</p>
 
         <p>The root of the problem is that the class that needs the
         external library is on the <code>CLASSPATH</code>.</p>
 
         <p>Let's see what happens when you load the &lt;junit&gt;
         task.  Ant&apos;s class loader will consult the
         bootstrap class loader first, which tries to load classes from
         <code>CLASSPATH</code>.  The bootstrap class loader
         doesn&apos;t know anything about Ant&apos;s class loader or
         even the path you have specified.</p>
 
         <p>If the bootstrap class loader can load the class Ant has
         asked it to load (which it can if <code>optional.jar</code> is
         part of <code>CLASSPATH</code>), this class will try to load
         the external library from <code>CLASSPATH</code> as well - it
         doesn&apos;t know anything else - and will not find it unless
         the library is in <code>CLASSPATH</code> as well.</p>
 
         <p>To solve this, you have two major options:</p>
 
         <ol>
           <li>put all external libraries you need in
           <code>CLASSPATH</code> as well this is not what you want,
           otherwise you wouldn&apos;t have found this FAQ entry.</li>
 
           <li>remove the class that loads the external library from
           the <code>CLASSPATH</code>.</li>
         </ol>
 
         <p>The easiest way to do this is to remove
         <code>optional.jar</code> from <code>ANT_HOME/lib</code>.  If
         you do so, you will have to <code>&lt;taskdef&gt;</code> all
         optional tasks and use nested <code>&lt;classpath&gt;</code>
         elements in the <code>&lt;taskdef&gt;</code> tasks that point
         to the new location of <code>optional.jar</code>.  Also,
         don&apos;t forget to add the new location of
         <code>optional.jar</code> to the
         <code>&lt;classpath&gt;</code> of your
         <code>&lt;style&gt;</code> or <code>&lt;junit&gt;</code>
         task.</p>
 
         <p>If you want to avoid to <code>&lt;taskdef&gt;</code> all
         optional tasks you need, the only other option is to remove
         the classes that should not be loaded via the bootstrap class
         loader from <code>optional.jar</code> and put them into a
         separate archive. Add this separate archive to the
         <code>&lt;classpath&gt;</code> of your
         <code>&lt;style&gt;</code> or <code>&lt;junit&gt;</code> task
         - and make sure the separate archive is not in
         <code>CLASSPATH</code>.</p>
 
         <p>In the case of <code>&lt;junit&gt;</code> you&apos;d have
         to remove all classes that are in the
         <code>org/apache/tools/ant/taskdefs/optional/junit</code>
         directory, in the <code>&lt;style&gt;</code> case it is one of
         the <code>*Liaison</code> classes in
         <code>org/apache/tools/ant/taskdefs/optional</code>.</p>
 
         <p>If you use the option to break up <code>optional.jar</code>
         for <code>&lt;junit&gt;</code> or remove
         <code>ant-junit.jar</code>, you still have to use a
         <code>&lt;taskdef&gt;</code> with a nested
         <code>&lt;classpath&gt;</code> to define the junit task.</p>
       </answer>
     </faq>
 
     <faq id="delegating-classloader-1.6">
       <question>&lt;style&gt; or &lt;junit&gt; ignores my
       &lt;classpath&gt; - Ant 1.6.x version</question>
 
       <answer>
         <p>Please read <a href="#delegating-classloader">the general
         entry</a> before you go ahead.</p>
 
         <p>The wrapper script of Ant 1.6.x no longer adds the contents
         of <code>ANT_HOME/lib</code> to <code>CLASSPATH</code>,
         instead Ant will create a classloader on top of the bootstrap
         classloader - let's call it the coreloader for the rest of
         this answer - which holds the contents of
         <code>ANT_HOME/lib</code>.  Ant's core and its tasks will be
         loaded through this classloader and not the bootstrap
         classloader.</p>
 
         <p>This causes some small but notable differences between Ant
         1.5.x and 1.6.x.  Most importantly, a third-party task that is
         part of <code>CLASSPATH</code> will no longer work in Ant
         1.6.x since the task now can't find Ant's classes.  In a sense
         this is the same problem this entry is about, only
         <code>ant.jar</code> has become the external library in
         question now.</p>
 
         <p>This coreloader also holds the contents of
         <code>~/.ant/lib</code> and any file or directory that has
         been specified using Ant's <code>-lib</code> command line
         argument.</p>
 
         <p>Let's see what happens when you load the &lt;junit&gt;
         task.  Ant&apos;s class loader will consult the bootstrap
         class loader first, which tries to load classes from
         <code>CLASSPATH</code>.  The bootstrap class loader
         doesn&apos;t know anything about Ant&apos;s class loader or
         even the path you have specified.  If it fails to find the
         class using the bootstrap classloader it will try the
         coreloader next.  Again, the coreloader doesn't know anything
         about your path.</p>
 
         <p>If the coreloader can load the class Ant has asked it to
         load (which it can if <code>ant-junit.jar</code> is in
         <code>ANT_HOME/lib</code>), this class will try to load the
         external library from coreloader as well - it doesn&apos;t
         know anything else - and will not find it unless the library
         is in <code>CLASSPATH</code> or the coreloader as well.</p>
 
         <p>To solve this, you have the following major options:</p>
 
         <ol>
           <li>put all external libraries you need in
           <code>CLASSPATH</code> as well this is not what you want,
           otherwise you wouldn&apos;t have found this FAQ entry.</li>
 
           <li>put all external libraries you need in
           <code>ANT_HOME/lib</code> or <code>.ant/lib</code>.  This
           probably still isn't what you want, but you might reconsider
           the <code>.ant/lib</code> option.</li>
 
           <li>Always start Ant with the <code>-lib</code> command line
           switch and point to your external libraries (or the
           directories holding them).</li>
 
           <li>remove the class that loads the external library from
           the coreloader.</li>
         </ol>
 
         <p>In Ant 1.6 <code>optional.jar</code> has been split into
         multiple jars, each one containing classes with the same
         dependencies on external libraries.  You can move the
         "offending" jar out of <code>ANT_HOME/lib</code>.  For the
         <code>&lt;junit&gt;</code> task it would be
         <code>ant-junit.jar</code>.</p>
 
         <p>If you do so, you will have to <code>&lt;taskdef&gt;</code>
         all optional tasks that need the external library and use
         nested <code>&lt;classpath&gt;</code> elements in the
         <code>&lt;taskdef&gt;</code> tasks that point to the new
         location of <code>ant-*.jar</code>.  Also, don&apos;t forget
         to add the new location of <code>ant-*.jar</code> to the
         <code>&lt;classpath&gt;</code> of your
         <code>&lt;style&gt;</code> or <code>&lt;junit&gt;</code>
         task.</p>
 
         <p>For example</p>
         <source><![CDATA[
     <taskdef name="junit"
             class="org.apache.tools.ant.taskdefs.optional.junit.JUnitTask">
       <classpath>
         <pathelement location="HOME-OF/junit.jar"/>
         <pathelement location="NEW-HOME-OF/ant-junit.jar"/>
       </classpath>
     </taskdef>
 ]]></source>
       </answer>
     </faq>
 
     <faq id="unknownelement.taskcontainer">
       <question>
         Why do my custom task containers see Unknown Elements in Ant 1.6
         - they worked in Ant 1.5?
       </question>
       <answer>
         <p>
           The objects added in TaskContainer.addTask(Task task)
           have changed from  Tasks to UnknownElements.
         </p>
         <p>
           There was a number of valid reasons for this change. But the backward
           compatibility problems were not noticed until after Ant 1.6.0 was
           released.
         </p>
         <p>
           Your container class will need to be modified to check if the Task
           is an UnknownElement and call perform on it to
           convert it to a Task and to execute it.
           (see apache.tools.ant.taskdefs.Sequential)
         </p>
         <p>
           If you want to do more processing on the task,
           you need to use the techniques in apache.tools.ant.taskdefs.Antlib#execute()
           This does make use of one 1.6 method call (UE#getRealObject()),
           you need to use UE#getTask() instead - this will
           return null for non tasks (types like fileset id=x).
         </p>
         <p>
           So.. iterate over the tasks, if they are UEs, convert them to
           tasks, using UE#maybeConfigure and UE#getTask()
         </p>
         <source><![CDATA[
         for (Iterator i = tasks.iterator(); i.hasNext();) {
            Task t = (Task) i.next();
            if (t instanceof UnknownElement) {
               ((UnknownElement) t).maybeConfigure();
               t = ((UnknownElement) t).getTask();
               if (t == null) {
                   continue;
               }
            }
            // .... original Custom code
         }
         ]]></source>
         <p>
           This approach should work for ant1.5 and ant1.6.
         </p>
       </answer>
     </faq>
 
     <faq id="oom-on-mac">
       <question>
         Ant runs into an infinite loop/throws an OutOfMemoryError
         when I compile my project under Mac OS X.
       </question>
 
       <answer>
         <p>Apple's Java VMs reside
         in <code>/System/Library/Frameworks/JavaVM.framework/Versions/X.Y.Z</code>
           and <code>JAVA_HOME</code> will usually be something
         like <code>/System/Library/Frameworks/JavaVM.framework/Versions/X.Y.Z/Home</code>.</p>
 
         <p>Inside this home directory there is a symbolic link
         named <code>shared_bundle</code> that links three levels up,
         i.e. to <code>/System/Library/Frameworks/JavaVM.framework</code>.</p>
 
         <p>If your build file contains a <code>fileset</code> like</p>
         <source><![CDATA[
 <fileset dir="${java.home}" includes="**/*.jar"/>
 ]]></source>
         <p>Ant is going to follow the <code>shared_bundle</code>
         symlink and ends up recursing into all your installed VMs.
         Even worse, it will
         enter <code>/System/Library/Frameworks/JavaVM.framework/Versions/X.Y.Z/Home</code>
           and will once again follow the same symlink.</p>
 
         <p>Ant versions after Ant 1.7.1 will detect the infinite loop
         they are in, but the resulting fileset may still be too big to
         deal with, in particular if you have many different VM
         versions installed.  The problem is amplified by the fact that
         each installed version has a <code>shared_bundle</code>
         symlink in it.</p>
 
         <p>One solution is to not allow the fileset to follow symbolic
           links at all, like in</p>
         <source><![CDATA[
 <fileset dir="${java.home}" includes="**/*.jar" followsymlinks="false"/>
 ]]></source>
         <p>another one excludes the <code>shared_bundle</code>
         directories:</p>
         <source><![CDATA[
 <fileset dir="${java.home}" includes="**/*.jar" excludes="**/shared_bundle/**"/>
 ]]></source>
 
         <p>For Ant 1.7.1 and earlier
         excluding <code>shared_bundle</code> may not be enough since
         there is another symlink <code>bundle</code> that points to
         the <code>Home</code> directory and will cause infite
         recursions as well.</p>
       </answer>
     </faq>
+
+    <faq id="extension-point-and-import">
+      <question><code>extension-point</code> doesn't work
+        with <code>import</code> like the documentation
+        states.</question>
+
+      <answer>
+        <p>Yes, there is
+          a <a href="https://issues.apache.org/bugzilla/show_bug.cgi?id=48804">bug
+          in Ant 1.8.0</a>.</p>
+
+        <p>When using two build files like</p>
+        <source><![CDATA[
+importing.xml:
+<project>
+   ...
+   <import file="imported.xml"/>
+   <target name="bar" extensionOf="foo"/>
+</project>
+imported.xml:
+<project>
+   <extension-point name="foo"/>
+</project>
+]]></source>
+        <p>Ant 1.8.0 will fail, claiming there was no extension point
+          named "foo".</p>
+
+        <p>This bug has been fixed for Ant 1.8.1.  For Ant 1.8.0 there
+          is
+          a <a href="https://issues.apache.org/bugzilla/show_bug.cgi?id=48804#c9">work-around</a>:
+          add an additional layer of importing like in</p>
+        <source><![CDATA[
+importing.xml:
+<project>
+   <target name="bar" extensionOf="foo"/>
+</project>
+imported.xml:
+<project>
+   <extension-point name="foo"/>
+</project>
+build.xml:
+<project>
+   <import file="imported.xml"/>
+   <import file="importing.xml"/>
+</project>
+]]></source>
+      </answer>
+    </faq>
   </faqsection>
 
 </document>
